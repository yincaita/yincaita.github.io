<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Springæºç ç¼–è¯‘</title>
      <link href="/spring-source-core-compile/"/>
      <url>/spring-source-core-compile/</url>
      
        <content type="html"><![CDATA[<h1 id="æºç åŒ…ä¸‹è½½"><a href="#æºç åŒ…ä¸‹è½½" class="headerlink" title="æºç åŒ…ä¸‹è½½"></a>æºç åŒ…ä¸‹è½½</h1><p>åŸºäºSpring v5.2.0RELEASE, è®¿é—®ä¸‹è¿°åœ°å€å°±èƒ½ä¸‹è½½åˆ°æºç åŒ…, è§£å‹å(è§£å‹è·¯å¾„æœ€å¥½åˆ«åŒ…å«<u>ç©ºæ ¼å’Œä¸­æ–‡</u>), æŸ¥çœ‹gradleç›®å½•ä¸‹çš„ç›¸å…³ä¿¡æ¯, èƒ½æŸ¥åˆ°<code>Spring5.2.0</code>ç‰ˆæœ¬æ˜¯ç”¨<code>gradle 5.6.2</code>è¿›è¡Œæ‰“åŒ…çš„ã€‚</p><p><img src="https://img.lsycai.top/spring-compile/source.png" alt="Springæºç ä¸‹è½½"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">https://github.com/spring-projects/spring-framework/archive/refs/tags/v5.2.0.RELEASE.zip<br></code></pre></td></tr></table></figure><h1 id="gradleå®‰è£…"><a href="#gradleå®‰è£…" class="headerlink" title="gradleå®‰è£…"></a>gradleå®‰è£…</h1><p>å®é™…ä¸Šæ›´ä¸ºæ–¹æ³•çš„åšæ³•æ˜¯ä½¿ç”¨<code>gradlew(gradle wrapper)</code>å‘½ä»¤, è¿™æ ·å¯ä»¥ä¸ç”¨è‡ªå·±æœ¬åœ°å®‰è£…gradle, è€Œå¯ä»¥æ ¹æ®é¡¹ç›®çš„wrapper.propertiesé…ç½®æ–‡ä»¶æŒ‡å®šgradle.zipæ¥è‡ªè¡Œä¸‹è½½è¿™ä¸ªé¡¹ç›®éœ€è¦çš„å¯¹åº”ç‰ˆæœ¬çš„gradle, ç›¸å…³ä¾èµ–ä¼šè¢«ä¿å­˜åœ¨<code>cç›˜/ç”¨æˆ·/.gradle</code>ä¸‹ã€‚è€Œæˆ‘è¿™é‡Œçš„åšæ³•æ˜¯é…ç½®ä¸€ä¸ªæœ¬åœ°gradleå¹¶åœ¨ideaä¸­è‡ªå®šä¹‰gradleé…ç½®ã€‚</p><p>è®¿é—®ä»¥ä¸‹åœ°å€è¿›è¡Œä¸‹è½½</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">https://services.gradle.org/distributions/gradle-5.6.2-bin.zip<br></code></pre></td></tr></table></figure><p>è§£å‹å¹¶é…ç½®ç¯å¢ƒå˜é‡</p><p><img src="https://img.lsycai.top/spring-compile/gradle-config.png" alt="gradleé…ç½®"></p><p><img src="https://img.lsycai.top/spring-compile/gradle-install-valid.png" alt="éªŒè¯é…ç½®gradleå®‰è£…æˆåŠŸ"></p><hr><p><strong>é…ç½®é•œåƒæº(æœ¬åœ°ä»“åº“æ²¡æœ‰ä¾èµ–æ—¶çš„é‡è¦é…ç½®):</strong> åœ¨<code>gradle-5.6.2/init.d/</code> ç›®å½•ä¸‹, åˆ›å»º<code>init.gradle</code>, å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">allprojects</span>&#123;<br>    <span class="hljs-keyword">repositories</span> &#123;<br>        <span class="hljs-keyword">def</span> REPOSITORY_URL = <span class="hljs-string">&#x27;http://maven.aliyun.com/nexus/content/groups/public/&#x27;</span><br>        all &#123; ArtifactRepository repo -&gt;<br>            <span class="hljs-keyword">def</span> url = repo.url.toString()<br>            <span class="hljs-keyword">if</span> ((repo <span class="hljs-keyword">instanceof</span> MavenArtifactRepository) &amp;&amp; (url.startsWith(<span class="hljs-string">&#x27;https://repo1.maven.org/maven2&#x27;</span>) || url.startsWith(<span class="hljs-string">&#x27;https://jcenter.bintray.com&#x27;</span>))) &#123;<br>                <span class="hljs-keyword">project</span>.logger.lifecycle <span class="hljs-string">&#x27;Repository $&#123;repo.url&#125; replaced by $REPOSITORY_URL .&#x27;</span><br>                remove repo<br>            &#125;<br>        &#125;<br>        maven &#123;<br>            url REPOSITORY_URL<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Springæºç çš„gradleé…ç½®"><a href="#Springæºç çš„gradleé…ç½®" class="headerlink" title="Springæºç çš„gradleé…ç½®"></a>Springæºç çš„gradleé…ç½®</h1><p>é¦–å…ˆæ›¿æ¢æºç æ ¹è·¯å¾„ä¸‹çš„<code>build.gradleæ–‡ä»¶</code>ä¸­respositoriesä¸ºé˜¿é‡Œçš„, éœ€è¦é…ç½®ä»¥ä¸‹<code>2ä¸ª</code>åœ°æ–¹ã€‚</p><div class="tabs" id="springæºç ä¸­æ ¹è·¯å¾„build.gradleæ–‡ä»¶çš„ç¼–è¯‘å‰é…ç½®"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#springæºç ä¸­æ ¹è·¯å¾„build.gradleæ–‡ä»¶çš„ç¼–è¯‘å‰é…ç½®-1">é…ç½®1</button></li><li class="tab"><button type="button" data-href="#springæºç ä¸­æ ¹è·¯å¾„build.gradleæ–‡ä»¶çš„ç¼–è¯‘å‰é…ç½®-2">é…ç½®2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="springæºç ä¸­æ ¹è·¯å¾„build.gradleæ–‡ä»¶çš„ç¼–è¯‘å‰é…ç½®-1"><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">buildscript</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-comment">// æ·»åŠ è¿™ä¸€å—å†…å®¹...</span><br>    <span class="hljs-keyword">repositories</span>&#123;<br>        maven&#123; url <span class="hljs-string">&#x27;https://maven.aliyun.com/nexus/content/groups/public/&#x27;</span>&#125;<br>        maven&#123; url <span class="hljs-string">&#x27;https://maven.aliyun.com/nexus/content/repositories/jcenter&#x27;</span>&#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="springæºç ä¸­æ ¹è·¯å¾„build.gradleæ–‡ä»¶çš„ç¼–è¯‘å‰é…ç½®-2"><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs gradle">dependencyManagement &#123;<br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-comment">// ä¿®æ”¹è¿™ä¸€å—</span><br>    <span class="hljs-keyword">repositories</span> &#123;<br>        maven&#123; url <span class="hljs-string">&#x27;https://maven.aliyun.com/nexus/content/groups/public/&#x27;</span>&#125;<br>        maven&#123; url <span class="hljs-string">&#x27;https://maven.aliyun.com/nexus/content/repositories/jcenter&#x27;</span>&#125;<br>        mavenCentral()<br>        maven &#123; url <span class="hljs-string">&quot;https://repo.spring.io/libs-spring-framework-build&quot;</span> &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="å¯¼å…¥idea"><a href="#å¯¼å…¥idea" class="headerlink" title="å¯¼å…¥idea"></a>å¯¼å…¥idea</h1><p>å‚è€ƒ: <a href="https://github.com/spring-projects/spring-framework/blob/main/import-into-idea.md">https://github.com/spring-projects/spring-framework/blob/main/import-into-idea.md</a></p><p>é¢„ç¼–è¯‘!!!</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">gradle :spring-oxm:compileTestJava<br></code></pre></td></tr></table></figure><p><img src="https://img.lsycai.top/spring-compile/precompile-success.png" alt="é¢„ç¼–è¯‘æˆåŠŸ"></p><p>é¢„ç¼–è¯‘å®Œæˆå, ç›´æ¥open Springæºç æ–‡ä»¶å¤¹å³å¯, ç„¶ååœ¨å³ä¸‹è§’æŠŠæ­£åœ¨åŠ è½½çš„è¿‡ç¨‹ç»™cancel, ç„¶åå»Settingsä¸­é…ç½®gradleã€‚</p><p><img src="https://img.lsycai.top/spring-compile/idea-config-gradle.png" alt="ideaé…ç½®æœ¬åœ°gradle"></p><p>ç„¶åé‡æ–°ç‚¹å‡»<code>Reload All Gradle Project</code>å³å¯å¼€å§‹ä¸‹è½½ä¾èµ–åˆ°ideaé…ç½®çš„<code>gradle user home</code>æ–‡ä»¶å¤¹ä¸‹</p><p><img src="https://img.lsycai.top/spring-compile/idea-reload-spring-src.png" alt="ideaé‡æ–°åŠ è½½é¡¹ç›®"></p><p>é‡æ–°åŠ è½½å®Œæˆå, å³ä¾§<code>Gradleæ ç›®</code>å°±ä¼šæ˜¾ç¤ºSpringæºç çš„å„ä¸ªæ¨¡å—äº†, ideaä¹Ÿå¼€å§‹Updating Indices.</p><p><img src="https://img.lsycai.top/spring-compile/reload-success.png" alt="é¡¹ç›®gradleèµ„æºreloadæˆåŠŸ"></p><p>æœ€åè¿›è¡Œé¡¹ç›®build</p><p><img src="https://img.lsycai.top/spring-compile/build-success.png" alt="Springæºç buildæˆåŠŸ"></p><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>æˆ‘ä»¬å¯ä»¥åœ¨spring-coreç­‰æ¨¡å—çš„åŒçº§, åˆ›å»ºä¸€ä¸ªmy-spring-testçš„æ¨¡å—(æ³¨æ„æ˜¯gradleé¡¹ç›®), å¹¶å¼•å…¥spring-coreè¿›è¡Œæµ‹è¯•.</p><p>å¼•å…¥å†…éƒ¨æ¨¡å—ä¾èµ–</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">dependencies</span> &#123;<br>    testCompile <span class="hljs-keyword">group</span>: <span class="hljs-string">&#x27;junit&#x27;</span>, name: <span class="hljs-string">&#x27;junit&#x27;</span>, version: <span class="hljs-string">&#x27;4.12&#x27;</span><br><br>    <span class="hljs-keyword">compile</span>(<span class="hljs-keyword">project</span>(<span class="hljs-string">&quot;:spring-core&quot;</span>))<br>    <span class="hljs-keyword">compile</span>(<span class="hljs-keyword">project</span>(<span class="hljs-string">&quot;:spring-context&quot;</span>))<br>    <span class="hljs-keyword">compile</span>(<span class="hljs-keyword">project</span>(<span class="hljs-string">&quot;:spring-beans&quot;</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿›è¡Œæµ‹è¯•(è¿‡ç¨‹ä¸­å¦‚æœä¹±ç , å¯ä»¥åŠ ä¸Šå¯åŠ¨å‚æ•°<code>-Dfile.encoding=utf-8</code>)</p><p><img src="https://img.lsycai.top/spring-compile/test-success.png" alt="æµ‹è¯•æˆåŠŸ"></p><h1 id="Springæºç å®‰è£…åˆ°mavenæœ¬åœ°ä»“åº“"><a href="#Springæºç å®‰è£…åˆ°mavenæœ¬åœ°ä»“åº“" class="headerlink" title="Springæºç å®‰è£…åˆ°mavenæœ¬åœ°ä»“åº“"></a>Springæºç å®‰è£…åˆ°mavenæœ¬åœ°ä»“åº“</h1><p>å°†æœ¬åœ°å®‰è£…çš„mavençš„settings.xmlå¤åˆ¶åˆ°<code>cç›˜/ç”¨æˆ·/.m2</code>æ–‡ä»¶å¤¹ä¸‹, é‡Œé¢é…ç½®æœ‰mavenæœ¬åœ°ä»“åº“çš„ä½ç½®, ä¸ç„¶gradleé¡¹ç›®publishçš„jarä¼šæ”¾åˆ°mavenä»“åº“é»˜è®¤è·¯å¾„ä¸‹é¢ã€‚</p><p>ç„¶ååœ¨publishToMavenLocalä¹‹å‰æŠŠä¹‹å‰åŠ çš„<code>-Dfile.encoding=utf-8</code>å‚æ•°å»æ‰, ä¸ç„¶ä¼šæŠ¥å¦‚ä¸‹é”™(åœ¨æºç ä¸ŠåŠ æ³¨é‡Šå†publish, ä¹Ÿä¼šå¯¼è‡´æŠ¥åˆ«çš„ä¸€äº›é”™â€¦, è¿™ä¸ªæ²¡è§£å†³å¾—äº†)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ERROR">Execution failed for task &#x27;:spring-beans:javadoc&#x27;. &gt; Javadoc generation fail<br></code></pre></td></tr></table></figure><p>ç›´æ¥spring &gt; Tasks -&gt; publishing &gt; publishToMavenLocalä¼šæŠ¥ä¸€ä¸ª<code>&gt; Task :asciidoctor FAILED</code>çš„é”™, ä½†æ˜¯springçš„å­æ¨¡å—éƒ½èƒ½é€šè¿‡publishToMavenLocalç›´æ¥å®‰è£…åˆ°mavençš„æœ¬åœ°ä»“åº“.</p><p><img src="https://img.lsycai.top/spring-compile/gradle-project-install-mavenlocal.png" alt="gradleé¡¹ç›®installåˆ°mavenæœ¬åœ°ä»“åº“"></p><h1 id="Springæ·»åŠ æ³¨é‡Šå¹¶æ”¯æŒè°ƒè¯•"><a href="#Springæ·»åŠ æ³¨é‡Šå¹¶æ”¯æŒè°ƒè¯•" class="headerlink" title="Springæ·»åŠ æ³¨é‡Šå¹¶æ”¯æŒè°ƒè¯•"></a>Springæ·»åŠ æ³¨é‡Šå¹¶æ”¯æŒè°ƒè¯•</h1><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠmavenæœ¬åœ°ä»“åº“çš„<code>spring-context-5.2.0.RELEASE-sources.jar</code>è§£å‹, ç„¶åæŒ‰ç…§å¦‚ä¸‹æ–¹å¼åœ¨ideaä¸­é…ç½®ã€‚</p><p>æˆ‘ä»¬å¯¹äºä¸€ä¸ªå¼•å…¥äº†spring-contextæ¨¡å—çš„mavené¡¹ç›®è¿›è¡Œå¦‚ä¸‹æ“ä½œè¿›è¡Œæ›¿æ¢æºç åŒ…</p><p><img src="https://img.lsycai.top/spring-compile/replace-source.png" alt="é¡¹ç›®ä¸­æ›¿æ¢æºç åŒ…"></p><p>ä¸‹é¢è¿›è¡Œè°ƒè¯•æµ‹è¯•</p><p><img src="https://img.lsycai.top/spring-compile/add-notes-debug.png" alt="æ›¿æ¢æºç åŒ…å°è¯•ä¿®æ”¹æ³¨é‡Š"></p><p>å¦å¤–å¯ä»¥é€‰æ‹©å°†å†™å¥½æ³¨é‡Šçš„æ–‡ä»¶ç›´æ¥æŠŠ<code>spring-context-5.2.0.RELEASE-sources.jar</code>ä¸­çš„æ–‡ä»¶ç»™æ›¿æ¢æ‰çš„æ–¹å¼, è¿™æ ·å°±ä¸ç”¨æ¯ä¸ªé¡¹ç›®éƒ½é…ç½®ä¸€éæºç åŒ…äº†ã€‚</p><p>å®é™…ä¸Šå…¶ä»–jdkæºç ç­‰éƒ½èƒ½é€šè¿‡è¿™ç§æ–¹å¼è¿›è¡Œæ·»åŠ æ³¨é‡Š, è¿™ç§æ–¹å¼æ›¿æ¢æºç ä¹Ÿæ˜¯æœ€æ–¹ä¾¿çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>butterflyä¸»é¢˜é…ç½®</title>
      <link href="/butterfly-theme-config/"/>
      <url>/butterfly-theme-config/</url>
      
        <content type="html"><![CDATA[<h1 id="é…ç½®Butterflyçš„å‡†å¤‡"><a href="#é…ç½®Butterflyçš„å‡†å¤‡" class="headerlink" title="é…ç½®Butterflyçš„å‡†å¤‡"></a>é…ç½®Butterflyçš„å‡†å¤‡</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">ç¨³å®šç‰ˆ, æƒ³å®‰è£…è¾ƒæ–°ç‰ˆæœ¬å¯ä»¥ <span class="hljs-built_in">clone</span> dev</span><br>git clone -b master https://gitee.com/immyw/hexo-theme-butterfly.git themes/butterfly<br></code></pre></td></tr></table></figure><p>åœ¨hexoçš„<code>_config.yml</code>é…ç½®æ–‡ä»¶ä¸­, é…ç½®ä¸»é¢˜ä¸ºbutterfly</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">theme:</span> <span class="hljs-string">butterfly</span>  <span class="hljs-comment"># themesæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å¤¹åç§°</span><br></code></pre></td></tr></table></figure><p>ä¸‹è½½ pug ä»¥åŠ stylus çš„æ¸²æŸ“å™¨ï¼ˆé»˜è®¤æ˜¯æ²¡æœ‰çš„, ç¬¬ä¸€æ¬¡éƒ½å¾—å®‰è£…ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install hexo-renderer-pug hexo-renderer-stylus --save<br></code></pre></td></tr></table></figure><p>é‡æ–°generateå¹¶server</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo clean  # æ¸…ç†æ—§çš„ä¸»é¢˜ç”Ÿæˆçš„æ–‡ä»¶<br>hexo g<br>hexo s<br></code></pre></td></tr></table></figure><h1 id="Butterflyä¸»é¢˜é…ç½®"><a href="#Butterflyä¸»é¢˜é…ç½®" class="headerlink" title="Butterflyä¸»é¢˜é…ç½®"></a>Butterflyä¸»é¢˜é…ç½®</h1><p>ä¸»é¢˜é…ç½®æ–‡ä»¶, ä¿®æ”¹<code>themes/Butterfly/_config.yml</code>æˆ–è€…<code>themes/source/_data/_config.butterfly.yml</code></p><h2 id="å›¾ç‰‡å¼•ç”¨"><a href="#å›¾ç‰‡å¼•ç”¨" class="headerlink" title="å›¾ç‰‡å¼•ç”¨"></a>å›¾ç‰‡å¼•ç”¨</h2><p>å›¾ç‰‡ä½¿ç”¨OSSå¤–éƒ¨å¼•ç”¨ã€å€ŸåŠ©Githubå®ç°æœ¬åœ°å¼•ç”¨éƒ½å¯</p><p>ä¿®æ”¹å‡ ä¸ªåœ°æ–¹å›¾ç‰‡çš„å¼•ç”¨, è¿™é‡Œä»¥æœ¬åœ°å›¾ç‰‡ä¸ºä¾‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># The banner image of home page  ä¸»é¡µçš„top_img</span><br><span class="hljs-attr">index_img:</span> <span class="hljs-string">/self/images/index_img.jpg</span><br><span class="hljs-comment"># Website Background (ç½‘ç«™èƒŒæ™¯)</span><br><span class="hljs-attr">background:</span> <span class="hljs-string">url(/self/images/bk.png)</span><br><span class="hljs-comment"># Avatar (å¤´åƒ)</span><br><span class="hljs-attr">avatar:</span><br>  <span class="hljs-attr">img:</span> <span class="hljs-string">/self/images/author_avatar.png</span><br>  <span class="hljs-attr">effect:</span> <span class="hljs-literal">false</span><br><span class="hljs-comment"># Favicon(ç½‘ç«™å›¾æ ‡)</span><br><span class="hljs-attr">favicon:</span> <span class="hljs-string">/img/favicon.png</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°±èƒ½butterflyçš„imgç›®å½•åˆ äº†</p><h2 id="å¯¼èˆªèœå•"><a href="#å¯¼èˆªèœå•" class="headerlink" title="å¯¼èˆªèœå•"></a>å¯¼èˆªèœå•</h2><p>æŠŠæ³¨é‡Šå»æ‰è¯•å°±è¡Œäº†(åªåˆ—ä¸¾äº†éƒ¨åˆ†)</p><div class="note primary modern"><p>debugæ¨¡å¼å¯åŠ¨hexo, ä¿®æ”¹é…ç½®ååˆ·æ–°å³ç”Ÿæ•ˆ(éƒ¨åˆ†)</p></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">menu:</span><br>  <span class="hljs-attr">Home:</span> <span class="hljs-string">/</span> <span class="hljs-string">||</span> <span class="hljs-string">fas</span> <span class="hljs-string">fa-home</span><br>  <span class="hljs-comment"># List||fas fa-list:</span><br>  <span class="hljs-comment">#   Music: /music/ || fas fa-music</span><br>  <span class="hljs-comment">#   Movie: /movies/ || fas fa-video</span><br></code></pre></td></tr></table></figure><p>è¯´æ˜: </p><ul><li>æ˜¾ç¤º: è®¿é—®è·¯å¾„ || icon</li><li>å¯ä»¥ç”¨yamlçš„è¯­æ³•, åƒä¸Šé¢çš„List, èƒ½é…ç½®æ‚¬æµ®ä¸‹æ‹‰</li><li>è¿™é‡Œé…ç½®çš„<code>è®¿é—®è·¯å¾„</code>, å°±èƒ½å’Œä¸Šé¢è¯´åˆ°çš„<code>hexo new page</code>ç»“åˆèµ·æ¥, è®©äººç‚¹å‡»åå°±èƒ½è¿›å…¥æˆ‘ä»¬è‡ªå®šä¹‰çš„<code>page/index.html</code></li></ul><p>å¦‚æœç‚¹å‡»åˆ†ç±»å‡ºç°æ²¡æ‰¾åˆ°é¡µé¢çš„æƒ…å†µ, æ£€æŸ¥ä¸‹æ˜¯ä¸æ˜¯public&#x2F;ä¸‹æ²¡æœ‰categoriesæ–‡ä»¶å¤¹æˆ–è€…categoriesæ–‡ä»¶å¤¹ä¸‹æ²¡æœ‰index.html, é‚£ä¹ˆå°±<code>hexo new page categories</code>, é‡æ–°<code>hexo g</code></p><h2 id="ä»£ç å—"><a href="#ä»£ç å—" class="headerlink" title="ä»£ç å—"></a>ä»£ç å—</h2><h3 id="ä»£ç å—æ ·å¼"><a href="#ä»£ç å—æ ·å¼" class="headerlink" title="ä»£ç å—æ ·å¼"></a>ä»£ç å—æ ·å¼</h3><p>ä»¥highlightä¸ºä¾‹(hexoé…ç½®æ–‡ä»¶)</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">highlight:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å¼€å¯</span><br>  <span class="hljs-attr">line_number:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># æ˜¾ç¤ºè¡Œå·</span><br>  <span class="hljs-attr">auto_detect:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># è‡ªåŠ¨æ¢è¡Œ</span><br>  <span class="hljs-attr">tab_replace:</span> <span class="hljs-string">&#x27;    &#x27;</span>  <span class="hljs-comment"># tabæ›¿æ¢ä¸º4ä¸ªç©ºæ ¼</span><br>  <span class="hljs-attr">wrap:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">hljs:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å¼€å¯åæ–¹å¯è¿›è¡Œè‡ªå®šä¹‰é…ç½®</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æ‰¾ä¸€ä¸ªç°æˆçš„ä»£ç å—cssæ–‡ä»¶è¿›è¡Œå¼•å…¥: <a href="https://github.com/highlightjs/highlight.js/tree/main/src/styles">https://github.com/highlightjs/highlight.js/tree/main/src/styles</a>, è¿™ä¸Šé¢çš„csséƒ½èƒ½ä½¿ç”¨, æ ·å¼å¯ä»¥å‚è€ƒ <a href="https://highlightjs.org/static/demo/">https://highlightjs.org/static/demo/</a>, é€‰ä¸€ä¸ªå–œæ¬¢çš„é¢œè‰²ä¸‹è½½å¯¹åº”çš„csså³å¯, æˆ‘æ˜¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ä¸‹è½½åˆ° <mark class="hl-label purple">source/self/</mark>  ç›®å½•ä¸‹é¢, ç„¶ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¼•å…¥, ä¹‹åæ¯æ¬¡generateåéƒ½ä¼šåœ¨ <mark class="hl-label default">public/self/</mark>  ä¸‹, </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Inject</span><br><span class="hljs-comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span><br><span class="hljs-comment"># æ’å…¥ä»£ç åˆ°å¤´éƒ¨ &lt;/head&gt; ä¹‹å‰ å’Œ åº•éƒ¨ &lt;/body&gt; ä¹‹å‰</span><br><span class="hljs-attr">inject:</span><br>  <span class="hljs-attr">head:</span><br>    <span class="hljs-comment"># ä»£ç å—, å¯ä»¥å¼•å…¥å¤šä¸ªcss</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">&lt;link</span> <span class="hljs-string">rel=&quot;stylesheet&quot;</span> <span class="hljs-string">href=&quot;/self/css/atom-one-light.css&quot;&gt;</span><br></code></pre></td></tr></table></figure><h3 id="ä»£ç è‡ªåŠ¨æ¢è¡Œ"><a href="#ä»£ç è‡ªåŠ¨æ¢è¡Œ" class="headerlink" title="ä»£ç è‡ªåŠ¨æ¢è¡Œ"></a>ä»£ç è‡ªåŠ¨æ¢è¡Œ</h3><p>å³ä¸æ˜¾å¼æ¨ªå‘æ»šåŠ¨æ¡</p><p>butterflyé…ç½®<code>code_word_wrap: true</code>å, è¿˜å¾—é…ç½®hexoçš„<code>highlight.line_number: false</code>æˆ–è€…æ˜¯<code>prismjs.line_number: false</code></p><h3 id="å…¶ä»–å°æ”¹åŠ¨"><a href="#å…¶ä»–å°æ”¹åŠ¨" class="headerlink" title="å…¶ä»–å°æ”¹åŠ¨"></a>å…¶ä»–å°æ”¹åŠ¨</h3><ul><li>ä»£ç æ‹·è´æŒ‰é’®</li><li>åœ¨ä»£ç å—å·¦ä¸Šè§’å±•ç¤ºä»£ç çš„è¯­è¨€</li><li>ä»£ç å±•å¼€æ”¶ç¼©</li><li>é«˜åº¦é™åˆ¶(ä»£ç è¿‡é•¿ä¼šæ˜¾ç¤ºå±•å¼€æŒ‰é’®)</li></ul><p>é…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">highlight_copy:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># copy button</span><br><span class="hljs-attr">highlight_lang:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># show the code language</span><br><span class="hljs-attr">highlight_shrink:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># true: shrink the code blocks / false: expand the code blocks | none: expand code blocks and hide the button</span><br><span class="hljs-attr">highlight_height_limit:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># unit: px</span><br></code></pre></td></tr></table></figure><h2 id="é¦–é¡µæ–‡ç« èŠ‚é€‰"><a href="#é¦–é¡µæ–‡ç« èŠ‚é€‰" class="headerlink" title="é¦–é¡µæ–‡ç« èŠ‚é€‰"></a>é¦–é¡µæ–‡ç« èŠ‚é€‰</h2><ol><li><p>description: åªæ˜¾ç¤ºdescription</p><p> descriptionåœ¨æ¯ä¸ªmdæ–‡ä»¶çš„å¤´ä¸ŠåŠ (front-matter)</p></li><li><p>bothï¼š ä¼˜å…ˆé€‰æ‹©descriptionï¼Œå¦‚æœæ²¡æœ‰é…ç½®descriptionï¼Œåˆ™æ˜¾ç¤ºè‡ªåŠ¨èŠ‚é€‰çš„å†…å®¹</p></li><li><p>auto_excerptï¼šåªæ˜¾ç¤ºè‡ªåŠ¨èŠ‚é€‰</p></li><li><p>falseï¼š ä¸æ˜¾ç¤ºæ–‡ç« å†…å®¹</p></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">index_post_content:</span><br>  <span class="hljs-attr">method:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">length:</span> <span class="hljs-number">500</span> <span class="hljs-comment"># if you set method to 2 or 3, the length need to config</span><br></code></pre></td></tr></table></figure><h2 id="æ–‡ç« ç‰ˆæƒ"><a href="#æ–‡ç« ç‰ˆæƒ" class="headerlink" title="æ–‡ç« ç‰ˆæƒ"></a>æ–‡ç« ç‰ˆæƒ</h2><p><code>post_copyright.enable: true</code></p><p>å¦‚æœæ–‡ç« é“¾æ¥è¢«ç¼–ç äº†, å¯ä»¥æŠŠ<code>post_copyright.decode</code>è®¾ç½®ä¸ºtrue</p><p><img src="https://img.lsycai.top/butterfly-config/url-encode.png" alt="æ–‡ç« åº•éƒ¨æ–‡ç« é“¾æ¥çš„URLç¼–ç "></p><h2 id="æœ¬åœ°æœç´¢"><a href="#æœ¬åœ°æœç´¢" class="headerlink" title="æœ¬åœ°æœç´¢"></a>æœ¬åœ°æœç´¢</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">local_search:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ç„¶åå®‰è£…<code>hexo-generator-search</code>ã€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install hexo-generator-search --save<br></code></pre></td></tr></table></figure><p>åœ¨hexoæ ¹ç›®å½•ä¸‹çš„_config.ymlä¸­æ·»åŠ é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># hexo-generator-search çš„é…ç½®, https://github.com/wzpan/hexo-generator-search</span><br><span class="hljs-attr">search:</span><br>  <span class="hljs-attr">path:</span> <span class="hljs-string">search.xml</span><br>  <span class="hljs-attr">field:</span> <span class="hljs-string">post</span>  <span class="hljs-comment"># åªæœ‰postsä¸‹çš„mdä¼šè¢«çº³å…¥, å¹¶åœ¨ hexo g çš„æ—¶å€™è¯»å…¥æ–‡ç« ç”Ÿæˆ search.xml çš„æœ¬åœ°æœç´¢æ•°æ®, æ”¾åœ¨public/ç›®å½•ä¸‹</span><br>  <span class="hljs-attr">content:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å°†æ–‡ç« å…¨éƒ¨æ•°æ®è¿›è¡Œçº³å…¥</span><br></code></pre></td></tr></table></figure><p>clean-g, çœ‹æ˜¯å¦æœ‰search.xmlæ–‡ä»¶åœ¨hexoæ ¹ç›®å½•ä¸‹</p><p>hexo såè¿›ç½‘ç«™éªŒè¯æœç´¢åŠŸèƒ½</p><h2 id="é¦–é¡µæ‰“å­—æ•ˆæœåŠ¨æ€"><a href="#é¦–é¡µæ‰“å­—æ•ˆæœåŠ¨æ€" class="headerlink" title="é¦–é¡µæ‰“å­—æ•ˆæœåŠ¨æ€"></a>é¦–é¡µæ‰“å­—æ•ˆæœåŠ¨æ€</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># the subtitle on homepage (ä¸»é¡µsubtitle)</span><br><span class="hljs-attr">subtitle:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-comment"># Typewriter Effect (æ‰“å­—æ•ˆæœ)</span><br>  <span class="hljs-attr">effect:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-comment"># loop (å¾ªç¯æ‰“å­—)</span><br>  <span class="hljs-attr">loop:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-comment"># sourceè°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡</span><br>  <span class="hljs-comment"># source: false å…³é—­è°ƒç”¨</span><br>  <span class="hljs-comment"># source: 1  è°ƒç”¨åšå¤©apiçš„éšå³è¯­å½•(ç®€ä½“)</span><br>  <span class="hljs-comment"># source: 2  è°ƒç”¨ä¸€è¨€ç½‘çš„ä¸€å¥è¯(ç®€ä½“)</span><br>  <span class="hljs-comment"># source: 3  è°ƒç”¨ä¸€å¥ç½‘(ç®€ä½“)</span><br>  <span class="hljs-comment"># source: 4  è°ƒç”¨ä»Šæ—¥è¯—è¯(ç®€ä½“)</span><br>  <span class="hljs-comment"># subtitle ä¼šå…ˆæ˜¾ç¤º source , å†æ˜¾ç¤º sub çš„å…§å®¹</span><br>  <span class="hljs-attr">source:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-comment"># å¦‚æœæœ‰è‹±æ–‡é€—å·&#x27;,&#x27;,ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ &#x27;&amp;#44;&#x27; ä»£æ›¿ </span><br>  <span class="hljs-comment"># å¦‚æœæœ‰è‹±æ–‡åŒå¼•å· &#x27;&quot;&#x27;,ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ &#x27;&amp;quot;&#x27; ä»£æ›¿</span><br>  <span class="hljs-comment"># å¼€å¤´ä¸å…è®¸è½¬ä¹‰å­—ç¬¦, å¦‚éœ€è¦, è¯·æŠŠæ•´ä¸ªå¥å­ç”¨åŒå¼•å·åŒ…ä½</span><br>  <span class="hljs-comment"># å¦‚æœå…³é—­æ‰“å­—æ•ˆæœ, subtitleåªä¼šæ˜¾ç¤ºsubçš„ç¬¬ä¸€è¡Œæ–‡å­—</span><br>  <span class="hljs-attr">sub:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·&amp;#44;</span> <span class="hljs-string">å‹¿åœ¨æµ®æ²™ç­‘é«˜å°.</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">æ‰ä¸‹çœ‰å¤´&amp;#44;</span> <span class="hljs-string">å´ä¸Šå¿ƒå¤´.</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">åƒè¡Œä»£ç &amp;#44;</span> <span class="hljs-string">bugä½•å¤„è—.</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">NullPointerException</span><br></code></pre></td></tr></table></figure><h2 id="å›¾ç‰‡æ‡’åŠ è½½"><a href="#å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="å›¾ç‰‡æ‡’åŠ è½½"></a>å›¾ç‰‡æ‡’åŠ è½½</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install hexo-lazyload-image --save<br></code></pre></td></tr></table></figure><p>hexoé…ç½®æ–‡ä»¶<code>_config.yml</code>ä¸­å¢åŠ ä»¥ä¸‹å†…å®¹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">lazyload:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">loadingImg:</span> <span class="hljs-string">/self/images/loading.gif</span>  <span class="hljs-comment"># åŠ¨å›¾çš„è·¯å¾„</span><br></code></pre></td></tr></table></figure><h1 id="SEOä¼˜åŒ–"><a href="#SEOä¼˜åŒ–" class="headerlink" title="SEOä¼˜åŒ–"></a>SEOä¼˜åŒ–</h1><div class="note info flat"><p>SEOæ˜¯ç”±è‹±æ–‡Search Engine Optimizationç¼©å†™è€Œæ¥ï¼Œ ä¸­æ–‡æ„è¯‘ä¸ºâ€œæœç´¢å¼•æ“ä¼˜åŒ–â€ã€‚SEOæ˜¯æŒ‡é€šè¿‡ç«™å†…ä¼˜åŒ–æ¯”å¦‚ç½‘ç«™ç»“æ„è°ƒæ•´ã€ç½‘ç«™å†…å®¹å»ºè®¾ã€ç½‘ç«™ä»£ç ä¼˜åŒ–ç­‰ä»¥åŠç«™å¤–ä¼˜åŒ–ã€‚</p></div><p>é¦–å…ˆæŠŠhexoé…ç½®æ–‡ä»¶ä¸­ <code>å¹´/æœˆ/æ—¥/æ–‡ç« å/</code>çš„è®¿é—®æ–¹å¼ç›´æ¥ä¿®æ”¹ä¸º<code>æ–‡ç« å</code>, å¹¶ä¸”æ–‡ç« åä¸å»ºè®®ä¸­æ–‡.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">permalink:</span> <span class="hljs-string">:title/</span><br></code></pre></td></tr></table></figure><h2 id="ç™¾åº¦æ”¶å½•"><a href="#ç™¾åº¦æ”¶å½•" class="headerlink" title="ç™¾åº¦æ”¶å½•"></a>ç™¾åº¦æ”¶å½•</h2><p><img src="https://img.lsycai.top/butterfly-config/zhanzhang-baidu.png" alt="ç™¾åº¦æ™®é€šæ”¶å½•"></p><p>é€‰ç”¨å…¶ä¸­ä¸€ç§æˆ–è€…æ··ç”¨éƒ½å¯ã€‚</p><h3 id="sitemapæ–¹å¼"><a href="#sitemapæ–¹å¼" class="headerlink" title="sitemapæ–¹å¼"></a>sitemapæ–¹å¼</h3><p>æˆ‘ä»¬å¯ä»¥å®šæœŸå°†ç½‘ç«™é“¾æ¥æ”¾åˆ°sitemapä¸­, ç„¶åå°†sitemapæäº¤ç»™ç™¾åº¦ã€‚ç™¾åº¦ä¼šå‘¨æœŸæ€§çš„æŠ“å–æ£€æŸ¥æ‚¨æäº¤çš„sitemap, å¯¹å…¶ä¸­çš„é“¾æ¥è¿›è¡Œå¤„ç†, ä½†æ”¶å½•é€Ÿåº¦æ…¢äºAPIæ¨é€ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install hexo-generator-sitemap --save<br>npm install hexo-generator-baidu-sitemap --save<br></code></pre></td></tr></table></figure><p>å¸®åŠ©ç½‘ç«™ç”Ÿæˆç«™å†…åœ°å›¾æ–‡ä»¶, å®‰è£…å, è¿è¡Œ<code>hexo g</code>åå°±èƒ½åœ¨<code>public/</code>ç›®å½•ä¸‹çœ‹åˆ°æœ‰sitemap.xml, è¯¥æ–‡ä»¶ç»´æŠ¤äº†ç«™å†…æ¯ä¸ªé¡µé¢çš„é“¾æ¥ç­‰ä¿¡æ¯ã€‚</p><p>ç„¶åå…³è”ç™¾åº¦å’Œè‡ªå·±ç½‘ç«™sitemap.xmlå³å¯(å¦‚å›¾æ‰€ç¤º), æœ€åç‚¹å‡»æäº¤å³å¯ã€‚</p><p><img src="https://img.lsycai.top/butterfly-config/commit-sitemap.png" alt="ç™¾åº¦æäº¤sitemap"></p><h3 id="APIæäº¤çš„æ–¹å¼"><a href="#APIæäº¤çš„æ–¹å¼" class="headerlink" title="APIæäº¤çš„æ–¹å¼"></a>APIæäº¤çš„æ–¹å¼</h3><p>å…ˆä½¿ç”¨postmanæµ‹è¯•ä¸‹å¯è¡Œæ€§</p><p><img src="https://img.lsycai.top/butterfly-config/api-conmmit.png" alt="APIæäº¤æ–¹å¼"></p><div class="note info flat"><p>æ¥ä¸‹æ¥åœ¨hexoä¸­è¿›è¡Œé…ç½®</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install hexo-baidu-url-submit --save<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨hexoçš„é…ç½®æ–‡ä»¶ä¸­æ–°å¢é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">baidu_url_submit:</span><br>  <span class="hljs-attr">count:</span> <span class="hljs-number">20</span> <span class="hljs-comment"># æäº¤æœ€æ–°çš„20ä¸ªé“¾æ¥</span><br>  <span class="hljs-attr">host:</span> <span class="hljs-string">lsycai.top</span> <span class="hljs-comment"># åœ¨ç™¾åº¦ç«™é•¿å¹³å°ä¸­æ³¨å†Œçš„åŸŸå</span><br>  <span class="hljs-attr">token:</span> <span class="hljs-string">XXXXX</span> <span class="hljs-comment"># è¯·æ³¨æ„è¿™æ˜¯æ‚¨çš„ç§˜é’¥, æ‰€ä»¥è¯·ä¸è¦æŠŠåšå®¢æºä»£ç å‘å¸ƒåœ¨å…¬ä¼—ä»“åº“é‡Œ!</span><br>  <span class="hljs-attr">path:</span> <span class="hljs-string">baidu_urls.txt</span> <span class="hljs-comment"># æ–‡æœ¬æ–‡æ¡£çš„åœ°å€, æ–°é“¾æ¥ä¼šä¿å­˜åœ¨æ­¤æ–‡æœ¬æ–‡æ¡£é‡Œ</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ–°å¢deploy</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">deploy:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">&#x27;git&#x27;</span><br>  <span class="hljs-attr">repository:</span> <br>    <span class="hljs-attr">github:</span> <span class="hljs-string">git@github.com:yincaita/yincaita.github.io.git,master</span>  <span class="hljs-comment"># æœ€åæ˜¯ä»“åº“å.git, åˆ†æ”¯å</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">baidu_url_submitter</span>  <span class="hljs-comment"># æ–°å¢è¿™ä¸€æ¡</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·æ‰§è¡Œ<code>hexo g</code>, å°±ä¼šå°†é“¾æ¥æ”¾åˆ°æˆ‘ä»¬åˆ¶å®špathçš„æ–‡ä»¶ä¸­ï¼›<code>hexo deploy</code>çš„æ—¶å€™ï¼Œè¿™äº›é“¾æ¥å°±ä¼šè¢«æ¨é€äº†è‡³ç™¾åº¦ã€‚</p><p><img src="https://img.lsycai.top/butterfly-config/urls-generate.png" alt="hexo gæ–‡ç« é“¾æ¥ä¿å­˜"></p><p><img src="https://img.lsycai.top/butterfly-config/urls-push.png" alt="hexo dæ–‡ç« é“¾æ¥æ¨é€ç™¾åº¦"></p><div class="note success flat"><p>è¢«ç™¾åº¦æ”¶å½•åçš„æ•ˆæœå›¾</p></div><p><img src="https://img.lsycai.top/butterfly-config/baidu-accumulate.png" alt="ç™¾åº¦æ”¶å½•åçš„æ•ˆæœå›¾"></p><hr><p>è¯¥éƒ¨åˆ†å‚è€ƒï¼š</p><ul><li>ç™¾åº¦æ”¶å½•å‚è€ƒ: <a href="https://blog.csdn.net/sunshine940326/article/details/70936988">https://blog.csdn.net/sunshine940326/article/details/70936988</a></li><li>hexoé…ç½®æ–‡ä»¶æ–°å¢deployçš„æ ¼å¼: <a href="https://www.jianshu.com/p/f37452d4978e">https://www.jianshu.com/p/f37452d4978e</a></li></ul><h1 id="æ–¹ä¾¿å‡çº§butterfly"><a href="#æ–¹ä¾¿å‡çº§butterfly" class="headerlink" title="æ–¹ä¾¿å‡çº§butterfly"></a>æ–¹ä¾¿å‡çº§butterfly</h1><p>å‚è€ƒ: </p><ul><li><a href="https://butterfly.js.org/posts/21cfbf15#%E5%8D%87%E7%B4%9A%E5%BB%BA%E8%AD%B0">https://butterfly.js.org/posts/21cfbf15#%E5%8D%87%E7%B4%9A%E5%BB%BA%E8%AD%B0</a></li><li><a href="https://blog.csdn.net/u012208219/article/details/106883001/">https://blog.csdn.net/u012208219/article/details/106883001/</a></li></ul><p>ä¸ºäº†å‡å°‘å‡çº§ä¸»é¢˜åå¸¦æ¥çš„ä¸ä¾¿ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•<code>themes/butterfly/_config.yml</code>å¤åˆ¶åˆ°hexoæ ¹ç›®å½•ä¸‹çš„<code>_config.butterfly.yml</code>ã€‚å¦‚æœåˆ›å»ºäº†_config.butterfly.yml, å®ƒå°†ä¼šæ›¿æ¢ä¸»é¢˜é»˜è®¤é…ç½®æ–‡ä»¶themes&#x2F;Butterfly&#x2F;_config.ymlé‡Œçš„é…ç½®é¡¹ (ä¸æ˜¯åˆå¹¶è€Œæ˜¯<mark class="hl-label orange">æ›¿æ¢æ‰åŒåé…ç½®</mark> ), ä¹‹åå°±åªéœ€è¦é€šè¿‡git pullçš„æ–¹å¼å¹³æ»‘åœ°å‡çº§theme-butterflyäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoçš„åŸºæœ¬ä½¿ç”¨</title>
      <link href="/hexo-basics/"/>
      <url>/hexo-basics/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆè¯†hexo"><a href="#åˆè¯†hexo" class="headerlink" title="åˆè¯†hexo"></a>åˆè¯†hexo</h1><p>hexoæ˜¯ä¸€æ¬¾åŸºäºnode.jsçš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶, å®˜ç½‘ï¼š<a href="https://hexo.io/zh-cn/">https://hexo.io/zh-cn/</a></p><p>ä½¿ç”¨å‰æ: ç”µè„‘ä¸Šå¾—æœ‰gitå’Œnode.jsçš„ç¯å¢ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">PS E:\hexo&gt; git --version<br>git version 2.31.1.windows.1<br>PS E:\hexo&gt; node --version<br>v12.16.1<br></code></pre></td></tr></table></figure><p>å·²ç»å®‰è£…å¥½gitå’Œnode.jså</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">å…¨å±€å®‰è£…hexo</span><br>npm install hexo-cli -g<br><span class="hljs-meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹hexoç‰ˆæœ¬</span><br>hexo -v <br><span class="hljs-meta prompt_"># </span><span class="language-bash">å®‰è£…æˆåŠŸä¼šå‡ºç°å¦‚ä¸‹æ˜¾ç¤º</span><br>os: Windows_NT 10.0.18363 win32 x64<br>node: 12.19.1<br>v8: 7.8.279.23-node.44<br>uv: 1.39.0<br>......<br></code></pre></td></tr></table></figure><h1 id="hexoä½¿ç”¨"><a href="#hexoä½¿ç”¨" class="headerlink" title="hexoä½¿ç”¨"></a>hexoä½¿ç”¨</h1><p>åˆå§‹åŒ–æœ¬åœ°hexoçš„æ–‡ä»¶</p><p><img src="https://img.lsycai.top/hexo-basic/hexo-init.png" alt="åœ¨æŸä¸ªç›®å½•åˆå§‹åŒ–hexoåšå®¢"></p><p>å¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">ä¸¤ç§å¯åŠ¨å‘½ä»¤</span><br>hexo server<br>hexo s [--draft][--debug]  # å¯ä»¥é€‰æ‹©æ€§å°†_draftç›®å½•ä¸‹çš„æºæ–‡ä»¶ä¸€åŒå±•ç¤º; è°ƒè¯•æ¨¡å¼å¯åŠ¨, å¯¹æ–‡ä»¶çš„æ›´æ”¹æ— éœ€åœæ­¢ç½‘ç«™åªéœ€åˆ·æ–°å³å¯çœ‹åˆ°æ•ˆæœ<br></code></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸåå°±å¯ä»¥è®¿é—®<code>localhost:4000</code>æŸ¥çœ‹hexoåšå®¢é»˜è®¤é¦–é¡µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">å…¶ä»–çš„å‘½ä»¤</span><br>hexo new &quot;mdæ–‡ä»¶å&quot;  # hexo n<br>hexo clean  # æ¸…ç†ç”Ÿæˆçš„é™æ€é¡µé¢(publicæ–‡ä»¶å¤¹å’Œdb.jsonè¢«åˆ é™¤)<br>hexo g  # ç­‰åŒäº hexo generate, å°†mdç­‰æ‰“åŒ…ç”Ÿæˆé™æ€é¡µé¢(åˆ°publicç›®å½•ä¸‹)<br>hexo d    # ç­‰åŒäº hexo deploy, å‘å¸ƒ, éœ€è¦è¿›è¡Œç›¸å…³é…ç½®<br></code></pre></td></tr></table></figure><p>æ ¹è·¯å¾„ä¸‹çš„ç›®å½•</p><ul><li><p>public: mdæ–‡ä»¶ã€æ ·å¼æ–‡ä»¶ç­‰æ‰“åŒ…æˆçš„é™æ€èµ„æºéƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹, é»˜è®¤<code>localhost:4000</code>å®é™…ä¸Šå°±æ˜¯è®¿é—®çš„<code>public/</code></p></li><li><p>source: æºæ–‡ä»¶(mdæ–‡ä»¶), generateåå°±æ˜¯public&#x2F;ä¸‹çš„å‰ç«¯é™æ€æ–‡ä»¶</p></li><li><p>themes: ä¸»é¢˜æ–‡ä»¶, å¯ä»¥ä¸‹è½½å¹¶é…ç½®hexoä¸»é¢˜æ’ä»¶</p></li><li><p>scaffolds:</p><ul><li><p>æ§åˆ¶æ–°åˆ›å»ºçš„mdæ–‡ä»¶çš„æ¨¡æ¿(å¯ä»¥æå‰é…ç½®å¥½æ–‡ä»¶æ ‡é¢˜ã€åˆ›å»ºæ—¶é—´ç­‰)</p></li><li><p>æˆ‘ä»¬ä½¿ç”¨<code>hexo new</code>å¯ä»¥åœ¨<code>source/_post</code>æˆ–è€…<code>source/_draft</code>ç›®å½•ä¸‹ç”Ÿæˆmdæ–‡ä»¶, ä¸€èˆ¬_postä¸‹éƒ½æ˜¯æ”¾æ­£å¼çš„è¦å‘å¸ƒçš„æ–‡ç« , è€Œ_draftä¸‹æ”¾çš„æ–‡ç« é»˜è®¤generateåéƒ½ä¸ä¼šç”Ÿæˆé™æ€é¡µé¢æ–‡ä»¶åˆ°publicç›®å½•ä¸‹</p></li><li><p><code>hexo new page</code>ä¼šæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹, æ–‡ä»¶å¤¹ä¸‹é»˜è®¤æœ‰ä¸€ä¸ªindex.mdçš„æ–‡ç« æ–‡ä»¶, ç”¨çš„å°±æ˜¯<code>scaffolds/page.md</code>ä½œä¸ºæ¨¡ç‰ˆæ–‡ä»¶åˆ›å»ºçš„, <code>hexo g</code>åpublic&#x2F;ä¸‹å°±ä¼šæœ‰ç›¸åº”çš„page</p>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo new post/draft &quot;mdæ–‡ä»¶åç§°&quot;<br>hexo new page &quot;æ–‡ä»¶å¤¹åç§°&quot;<br>hexo new &quot;mdæ–‡ä»¶åç§°&quot;  # åŒ hexo new post &quot;&quot;<br></code></pre></td></tr></table></figure></li></ul></li></ul><h1 id="hexoçš„é…ç½®æ–‡ä»¶"><a href="#hexoçš„é…ç½®æ–‡ä»¶" class="headerlink" title="hexoçš„é…ç½®æ–‡ä»¶"></a>hexoçš„é…ç½®æ–‡ä»¶</h1><p>ä»¥ä¸‹åªåˆ—ä¸¾ä¸€äº›æˆ‘ç¼–è¾‘è¿‡çš„ä¸»è¦é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Hexo Configuration</span><br><span class="hljs-comment">## Docs: https://hexo.io/docs/configuration.html</span><br><span class="hljs-comment">## Source: https://github.com/hexojs/hexo/</span><br><br><span class="hljs-comment"># Site</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">yincaiTA&#x27;</span> <span class="hljs-string">Blog</span><br><span class="hljs-attr">subtitle:</span> <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-attr">description:</span> <span class="hljs-string">&#x27;å°å–„çš„å­¦ä¹ ç¬”è®° ğŸŸ&#x27;</span><br><span class="hljs-attr">keywords:</span> <span class="hljs-string">yincaiTA,Java,æ„”æ‰</span><br><span class="hljs-attr">author:</span> <span class="hljs-string">yincaiTA</span><br><span class="hljs-comment"># è¯­è¨€: [en, zh-CN, zh-TW]</span><br><span class="hljs-attr">language:</span> <span class="hljs-string">zh-CN</span><br><span class="hljs-comment"># æ—¶åŒº(ç”¨ä¸Šæµ·å°±è¡Œ): https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</span><br><span class="hljs-attr">timezone:</span> <span class="hljs-string">PRC</span><br><br><span class="hljs-comment"># URL</span><br><span class="hljs-comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span><br><span class="hljs-attr">url:</span> <span class="hljs-string">https://lsycai.top</span><br><span class="hljs-attr">permalink:</span> <span class="hljs-string">:year/:i_month/:i_day/:title/</span><br><br><span class="hljs-comment"># Writing</span><br><span class="hljs-attr">new_post_name:</span> <span class="hljs-string">:title.md</span> <span class="hljs-comment"># File name of new posts</span><br><span class="hljs-attr">default_layout:</span> <span class="hljs-string">post</span><br><span class="hljs-attr">titlecase:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># Transform title into titlecase</span><br><span class="hljs-attr">external_link:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># ç‚¹å‡»é“¾æ¥æ–°äº§ç”Ÿä¸€ä¸ªtab</span><br>  <span class="hljs-attr">field:</span> <span class="hljs-string">site</span>  <span class="hljs-comment"># ç½‘ç«™å†…ç”Ÿæ•ˆ</span><br>  <span class="hljs-attr">exclude:</span> <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-attr">filename_case:</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># Transform filenames to 1 lower case; 2 upper case</span><br><span class="hljs-attr">render_drafts:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># Display drafts?</span><br><span class="hljs-attr">post_asset_folder:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># ç”Ÿæˆmdæ—¶ä¼šåŒæ—¶ç”ŸæˆåŒåæ–‡ä»¶å¤¹; ç”Ÿæˆhtmlæ—¶,æ–‡ä»¶å¤¹å†…çš„å›¾ç‰‡ä¼šè¢«å¤åˆ¶åˆ°è¿™ä¸ªhtmlå­˜åœ¨çš„ç›®å½•</span><br><span class="hljs-attr">relative_link:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># é“¾æ¥ç›¸å¯¹äºæ ¹æ–‡ä»¶å¤¹, è®¾ç½®ä¸ºtrueå butterfly çš„å¾ˆå¤šæ ·å¼ä¼šå‡ºé”™, åƒiconæ˜¾ç¤ºã€ä»£ç å—å±•å¼€/å¤åˆ¶ç­‰</span><br><span class="hljs-attr">future:</span> <span class="hljs-literal">true</span><br><span class="hljs-comment"># è¿™ä¸ªhighlightå¯ä»¥ä¸ä¸»é¢˜è¿›è¡Œæ­é…</span><br><span class="hljs-attr">highlight:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">line_number:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">auto_detect:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">tab_replace:</span> <span class="hljs-string">&#x27;    &#x27;</span>  <span class="hljs-comment"># tabæ›¿æ¢ä¸º4ä¸ªç©ºæ ¼</span><br>  <span class="hljs-attr">wrap:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">hljs:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-comment"># Extensions</span><br><span class="hljs-comment">## Plugins: https://hexo.io/plugins/</span><br><span class="hljs-comment">## Themes: https://hexo.io/themes/</span><br><span class="hljs-attr">theme:</span> <span class="hljs-string">butterfly</span><br><br><span class="hljs-comment"># Deployment</span><br><span class="hljs-comment">## Docs: https://hexo.io/docs/one-command-deployment</span><br><span class="hljs-attr">deploy:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">&#x27;git&#x27;</span><br>  <span class="hljs-attr">branch:</span> <span class="hljs-string">master</span>  <span class="hljs-comment"># åˆ†æ”¯</span><br>  <span class="hljs-attr">repository:</span> <span class="hljs-string">git@github.com:yincaita/yincaita.github.io.git</span>  <span class="hljs-comment"># æœ€åæ˜¯ä»“åº“å.git</span><br><br><span class="hljs-comment"># æœ¬åœ°æœç´¢æ’ä»¶, hexo-generator-search çš„é…ç½®, https://github.com/wzpan/hexo-generator-search</span><br><span class="hljs-attr">search:</span><br>  <span class="hljs-attr">path:</span> <span class="hljs-string">search.xml</span><br>  <span class="hljs-attr">field:</span> <span class="hljs-string">post</span>  <span class="hljs-comment"># åªæœ‰postsçš„mdä¼šè¢«çº³å…¥, å¹¶åœ¨ hexo g çš„æ—¶å€™è¯»å…¥æ–‡ç« ç”Ÿæˆ search.xml çš„æœ¬åœ°æœç´¢æ•°æ®, æ”¾åœ¨public/ç›®å½•ä¸‹</span><br>  <span class="hljs-attr">content:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å°†æ–‡ç« å…¨éƒ¨æ•°æ®è¿›è¡Œçº³å…¥</span><br></code></pre></td></tr></table></figure><h1 id="å‘å¸ƒåˆ°Github-Pages"><a href="#å‘å¸ƒåˆ°Github-Pages" class="headerlink" title="å‘å¸ƒåˆ°Github Pages"></a>å‘å¸ƒåˆ°Github Pages</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install hexo-deployer-git --save<br><br>hexo d<br></code></pre></td></tr></table></figure><p>å°±èƒ½ä½¿ç”¨ <a href="https://yincaita.github.io/">https://yincaita.github.io/</a> è¿›è¡Œè®¿é—®äº†</p><h1 id="åŸŸåæ˜ å°„é…ç½®"><a href="#åŸŸåæ˜ å°„é…ç½®" class="headerlink" title="åŸŸåæ˜ å°„é…ç½®"></a>åŸŸåæ˜ å°„é…ç½®</h1><p>åœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œé…ç½®, ä»¥é˜¿é‡Œäº‘ä¸ºä¾‹</p><ol><li>åŸŸåæ˜ å°„ github.io é¡µé¢çš„é…ç½®</li><li>é…ç½®Github Pages çš„domainè®°å½•: <mark class="hl-label green">github -> settings -> Pages -> add a domain</mark> </li></ol><p><img src="https://img.lsycai.top/hexo-basic/ali-config-domain-access.png" alt="é˜¿é‡Œäº‘åŸŸåè§£æ"></p><p>æœ€ååœ¨hexoç”Ÿæˆçš„public&#x2F;ä¸‹é…ç½®ä¸ªCNAMEæ–‡ä»¶<code>(ç›´æ¥æŠŠCNAMEæ–‡ä»¶æ”¾åˆ°sourceç›®å½•ä¸‹å³å¯, å› ä¸ºsourceç›®å½•ä¸‹çš„å†…å®¹ä¼šåœ¨ hexo g åè‡ªåŠ¨æ”¾åˆ°publicç›®å½•ä¸‹)</code>, æ–‡ä»¶å†…å®¹å°±æ˜¯åŸŸå, é™æ€åšå®¢å°±èƒ½ä»¥åŸŸåçš„å½¢å¼è®¿é—®.</p><p><img src="https://img.lsycai.top/hexo-basic/config-domain.png" alt="Github Pagesé…ç½®domain"></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>glidedskyç½‘ç«™çˆ¬è™«ç»ƒä¹ </title>
      <link href="/glidedsky/"/>
      <url>/glidedsky/</url>
      
        <content type="html"><![CDATA[<h1 id="çˆ¬è™«åŸºç¡€-1"><a href="#çˆ¬è™«åŸºç¡€-1" class="headerlink" title="çˆ¬è™«åŸºç¡€-1"></a>çˆ¬è™«åŸºç¡€-1</h1><p><img src="https://img.lsycai.top/glidedsky/basic-1.1.png" alt="çˆ¬è™«åŸºç¡€-1.1"></p><p>å…¶æ¬¡ï¼Œå…³äº<code>_token</code>ï¼Œæ–°å¼€æµè§ˆå™¨(æ— ç—•)ä¼šå‘ç°è¿™ä¸ªå€¼æ˜¯ä¼šå˜åŒ–çš„</p><p><img src="https://img.lsycai.top/glidedsky/basic-1.2.png" alt="çˆ¬è™«åŸºç¡€-1.2"></p><p><img src="https://img.lsycai.top/glidedsky/basic-1.3.png" alt="çˆ¬è™«åŸºç¡€-1.3"></p><p>æ€è·¯ï¼šæ¯æ¬¡è¯·æ±‚å‰å…ˆè®¿é—®ç™»é™†ç•Œé¢è·å¾—tokenï¼Œå†å’Œemailã€passwordä¸€èµ·è¯·æ±‚ã€‚è¿™æ˜¯ä¸€ä¸ªå…¬å…±çš„è¿‡ç¨‹ï¼Œå°è£…æˆ env.pyã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">ç¯å¢ƒè®¾ç½®</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Env</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-comment"># æ¯ç§’è·å–ä¸ªæ•° æœ€å¤š200 ä½†æ˜¯é åçš„å› ä¸ºæ—¶é—´å…³ç³» å¤šå°‘ä¼šé€Ÿåº¦å·®äº›</span><br>    ip_each = <span class="hljs-number">30</span><br>    <span class="hljs-comment"># è¯·æ±‚æ•°æ®</span><br>    login_data = &#123;<br>        <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;é‚®ç®±&quot;</span>,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;å¯†ç &quot;</span>,<br>        <span class="hljs-string">&quot;_token&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>    &#125;<br>    <span class="hljs-comment"># apiçš„url</span><br>    proxy_api_url = <span class="hljs-string">&quot;api_url xxx &amp;getnum=&quot;</span> + <span class="hljs-built_in">str</span>(ip_each)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># è¯·æ±‚å¤´</span><br>        self.headers = &#123;<br>            <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) &quot;</span><br>                          <span class="hljs-string">&quot;Chrome/89.0.4389.90 Safari/537.36 &quot;</span><br>        &#125;<br>        <span class="hljs-comment"># login_url</span><br>        self.login_url = <span class="hljs-string">&quot;http://www.glidedsky.com/login&quot;</span><br>        <span class="hljs-comment"># ä½¿ç”¨session, è‡ªåŠ¨ä¿å­˜ç™»é™†åè·å–çš„cookie</span><br>        self.session = requests.session()<br><br>    <span class="hljs-comment"># ç™»é™†è·å– _tokenå€¼</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">self</span>):<br>        response = self.session.get(self.login_url, headers=self.headers)<br>        <span class="hljs-comment"># æ­£åˆ™è§£æ, å°†_tokenå€¼è¿”å›</span><br>        self.login_data[<span class="hljs-string">&quot;_token&quot;</span>] = re.search(<span class="hljs-string">&#x27;name=&quot;_token&quot; value=&quot;(.*?)&quot;&#x27;</span>, response.text).group(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># ç™»é™†æ•°æ®é½å¤‡, æ­£å¼ç™»é™†</span><br>        self.session.post(self.login_url, data=self.login_data, headers=self.headers)<br>        <span class="hljs-comment"># print(self.login_data[&quot;_token&quot;])</span><br>        <span class="hljs-keyword">return</span> self.session<br><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        å®æ—¶è·å–ä»£ç†ip: æŸå®æ‰¾çš„1å—æµ‹è¯•, 1sæœ€å¤šè·å–200æ¬¡api è¿™é‡Œè·å–60 æ„Ÿè§‰å‰é¢çš„é€Ÿåº¦å¿«äº›</span><br><span class="hljs-string">        [&#x27;ip1:port1&#x27;, &#x27;ip2:port2&#x27;]</span><br><span class="hljs-string">        è¿‡æœŸåç”¨çš„åç›Šäº‘ ipæ•°é‡è®¡è´¹</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_proxy</span>(<span class="hljs-params">self</span>):<br>        response = requests.get(self.proxy_api_url, self.headers)<br>        <span class="hljs-keyword">return</span> response.text.split(<span class="hljs-string">&quot;\r\n&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    env = Env()<br>    <span class="hljs-comment"># env.login()</span><br><br>    <span class="hljs-built_in">print</span>(env.get_proxy())<br></code></pre></td></tr></table></figure><h2 id="ç¬¬ä¸€é¢˜"><a href="#ç¬¬ä¸€é¢˜" class="headerlink" title="ç¬¬ä¸€é¢˜"></a>ç¬¬ä¸€é¢˜</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">çˆ¬è™«åŸºç¡€1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><br><span class="hljs-comment"># è°ƒç”¨å°è£…çš„ç™»é™†ç¯å¢ƒ</span><br>env = Env()<br>session = env.login()<br><br><span class="hljs-comment"># æœ‰äº†token, cookieç­‰ä¿¡æ¯, å°±èƒ½è®¿é—®çˆ¬è™«ä¸€é¡µé¢äº†</span><br>url = <span class="hljs-string">&quot;http://www.glidedsky.com/level/web/crawler-basic-1&quot;</span><br>response = session.get(url, headers=env.headers)<br><span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>html = etree.HTML(response.text)<br>div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><span class="hljs-comment"># å®šä¹‰ å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>    total += <span class="hljs-built_in">int</span>(div.xpath(<span class="hljs-string">&#x27;normalize-space(./text())&#x27;</span>))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç»“æœæ˜¯: <span class="hljs-subst">&#123;total&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="çˆ¬è™«åŸºç¡€-2"><a href="#çˆ¬è™«åŸºç¡€-2" class="headerlink" title="çˆ¬è™«åŸºç¡€-2"></a>çˆ¬è™«åŸºç¡€-2</h1><p>ç™»é™†åŒä¸Šï¼Œè¿™æ¬¡éœ€è¦ç¿»é¡µï¼Œè¿™å°±éœ€è¦å¾ªç¯è·å–ä¸‹ä¸€é¡µçš„é“¾æ¥ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/basic-2.1.png" alt="çˆ¬è™«åŸºç¡€-2.1"></p><p>æ¯ä¸€é¡µè·å–æ•°æ®æ–¹å¼åŒ<code>çˆ¬è™«åŸºç¡€1</code>ï¼Œåªæ˜¯xpathè¯­æ³•æœ‰å·®åˆ«ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">çˆ¬è™«åŸºç¡€2</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># è°ƒç”¨å°è£…çš„ç™»é™†ç¯å¢ƒ</span><br>env = Env()<br>session = env.login()<br><br><span class="hljs-comment"># å®šä¹‰ å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># è¿™æ¬¡éœ€è¦å¾ªç¯éå†æ¯ä¸€é¡µ</span><br>curr_page_url = <span class="hljs-string">&quot;http://www.glidedsky.com/level/web/crawler-basic-2?page=1&quot;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    response = session.get(curr_page_url, headers=env.headers)<br>    <span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>    html = etree.HTML(response.text)<br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>    <span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>        total += <span class="hljs-built_in">int</span>(div.xpath(<span class="hljs-string">&#x27;normalize-space(./text())&#x27;</span>))<br><br>    cur_page_num = re.search(<span class="hljs-string">&#x27;page=(\\d+)&#x27;</span>, curr_page_url).group(<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å‰<span class="hljs-subst">&#123;cur_page_num&#125;</span>é¡µæ•°å­—å’Œä¸º: <span class="hljs-subst">&#123;total&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é¡µ</span><br>    next_page_btn = html.xpath(<span class="hljs-string">&#x27;//ul[@class=&quot;pagination&quot;]/li[last()]&#x27;</span>)[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment"># å¦‚æœä¸‹ä¸€é¡µæŒ‰é’®æœ‰disabledæ ·å¼, å°±æ²¡æœ‰ä¸‹ä¸€é¡µ</span><br>    <span class="hljs-keyword">if</span> next_page_btn.xpath(<span class="hljs-string">&#x27;contains(@class, &quot;disabled&quot;)&#x27;</span>):<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># æœ‰ä¸‹ä¸€é¡µ, ç»™ä¸‹ä¸€é¡µurlèµ‹å€¼</span><br>        curr_page_url = next_page_btn.xpath(<span class="hljs-string">&#x27;./a/@href&#x27;</span>)[<span class="hljs-number">0</span>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç»“æœæ˜¯: <span class="hljs-subst">&#123;total&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="IPå±è”½-1"><a href="#IPå±è”½-1" class="headerlink" title="IPå±è”½-1"></a>IPå±è”½-1</h1><p>å…ˆç”¨å¥‡æ€ªçš„æ–¹æ³•è¾¾åˆ°ä¿®æ”¹ipçš„ç›®çš„ï¼Œå†è¿›å»æŸ¥çœ‹ä¸‹ç½‘é¡µç»“æ„ï¼ŒæŠŠxpathå…ˆè¡Œè®°å½•ä¸€éï¼Œåç»­æœ‰é”™å†æ”¹ã€‚ï¼ˆä»£ç†è·å–ç½‘é¡µå†…å®¹ä¹Ÿå¯ï¼‰</p><p>ç»“æœæ˜¯ï¼šé¡µé¢ç»“æ„å’Œçˆ¬è™«åŸºç¡€2ç›¸åŒã€‚</p><p><img src="https://img.lsycai.top/glidedsky/ip-mask-3.1.png" alt="IPå±è”½-3.1"></p><p>ç°åœ¨æœ€é‡è¦çš„å°±æ˜¯å¦‚ä½•è·å–1000å¤šä¸ªå¯ç”¨çš„ä»£ç†ipäº†ï¼Œæˆ‘ä»¬å»æŸå®éšä¾¿æ‰¾ä¸€ä¸ªä¾¿å®œçš„<code>é«˜åŒ¿ip</code>ã€‚</p><p>åœ¨env.pyçš„Envç±»ä¸­æ·»åŠ å¦‚ä¸‹æˆå‘˜æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ¯ç§’è·å–ä¸ªæ•° æœ€å¤š200 ä½†æ˜¯é åçš„å› ä¸ºæ—¶é—´å…³ç³» å¤šå°‘ä¼šé€Ÿåº¦å·®äº›</span><br>   ip_each = <span class="hljs-number">30</span><br>   <br>   <span class="hljs-comment"># apiçš„url</span><br>   proxy_api_url = <span class="hljs-string">&quot;api_url&quot;</span> + <span class="hljs-built_in">str</span>(ip_each)<br>       <br>   <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">       å®æ—¶è·å–ä»£ç†ip: æŸå®æ‰¾çš„1å—æµ‹è¯•, 1sæœ€å¤šè·å–200æ¬¡api è¿™é‡Œè·å–60 æ„Ÿè§‰å‰é¢çš„é€Ÿåº¦å¿«äº›</span><br><span class="hljs-string">       [&#x27;ip1:port1&#x27;, &#x27;ip2:port2&#x27;]</span><br><span class="hljs-string">       è¿‡æœŸåç”¨çš„åç›Šäº‘ ipæ•°é‡è®¡è´¹</span><br><span class="hljs-string">   &quot;&quot;&quot;</span><br>   <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_proxy</span>(<span class="hljs-params">self</span>):<br>       response = requests.get(self.proxy_api_url, self.headers)<br>       <span class="hljs-keyword">return</span> response.text.split(<span class="hljs-string">&quot;\r\n&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç°åœ¨å°†ä¸Šä¸ª<code>çˆ¬è™«åŸºç¡€2</code>çš„ä»£ç è¿›è¡Œæ”¹é€ ï¼Œæ·»åŠ æ¯æ¬¡æ›´æ¢ä¸€ä¸ªä»£ç†è¿›è¡Œè¯·æ±‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">ipåçˆ¬1</span><br><span class="hljs-string">    ç»“æ„å’Œçˆ¬è™«åŸºç¡€ç›¸åŒ</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># è°ƒç”¨å°è£…çš„ç™»é™†ç¯å¢ƒ</span><br>env = Env()<br>session = env.login()<br><br><span class="hljs-comment"># å®šä¹‰ å’Œ</span><br>total = <span class="hljs-number">0</span><br><br><span class="hljs-comment"># å½“å‰é¡µ</span><br>curr_page = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># ä»£ç†ipçš„ç´¢å¼•, å› ä¸ºæ¯1ç§’åªèƒ½è·å–æœ€å¤š200ä¸ªip</span><br>proxy_index = <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 200ä¸ªä»£ç†ipåˆ—è¡¨</span><br>proxy_list = env.get_proxy()<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-comment"># è¿™é‡Œé‡‡ç”¨ä»£ç† è¶…æ—¶è®¾ç½®ä¸º0.6s è®¾ç½®å°ä¸€ç‚¹ é‚£ä¹ˆæ…¢çš„ä»£ç†ipå°±è‡ªåŠ¨è·³è¿‡äº† ä½†æ˜¯åˆä¸èƒ½å¤ªå° æ¯•ç«Ÿä»£ç†æ¯”æ­£å¸¸è®¿é—®æ…¢ è·‘å®Œä¼°è®¡ä¹Ÿå¾—5-8åˆ†é’Ÿå·¦å³</span><br>    <span class="hljs-comment"># å¦‚æœæŠ¥é”™/è¿”å›403é¡µé¢å°±ç”¨ä¸‹ä¸€ä¸ªä»£ç† æ³¨æ„ä»£ç†çš„ é”®æ˜¯http å†™æˆå¤§å†™ä»£ç†æ— æ•ˆ</span><br>    <span class="hljs-keyword">try</span>:<br>        response = session.get(<span class="hljs-string">f&quot;http://www.glidedsky.com/level/web/crawler-ip-block-1?page=<span class="hljs-subst">&#123;curr_page&#125;</span>&quot;</span>,<br>                               headers=env.headers, timeout=<span class="hljs-number">0.3</span>, proxies=&#123;<span class="hljs-string">&quot;http&quot;</span>: proxy_list[proxy_index]&#125;)<br>        <span class="hljs-comment"># é¡µé¢å“åº”403 åˆ™ä¹Ÿåº”ç®—é”™è¯¯</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-number">403</span> == response.status_code:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">f&quot;è¯¥ä»£ç†å·²ç»ç”¨è¿‡: <span class="hljs-subst">&#123;proxy_list[proxy_index]&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-comment"># ç›´æ¥ä½¿ç”¨ä¸‹ä¸€ä¸ªçš„proxy</span><br>        proxy_index += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> proxy_index &gt;= env.ip_each:<br>            proxy_list = env.get_proxy()<br>            <span class="hljs-comment"># *****</span><br>            proxy_index = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>    html = etree.HTML(response.text)<br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span>*<span class="hljs-number">40</span>)<br>    <span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>        total += <span class="hljs-built_in">int</span>(div.xpath(<span class="hljs-string">&#x27;normalize-space(./text())&#x27;</span>))<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å‰<span class="hljs-subst">&#123;curr_page&#125;</span>é¡µæ•°å­—å’Œä¸º: <span class="hljs-subst">&#123;total&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">if</span> curr_page &gt;= <span class="hljs-number">1000</span>:<br>        <span class="hljs-keyword">break</span><br>    curr_page += <span class="hljs-number">1</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç»“æœæ˜¯: <span class="hljs-subst">&#123;total&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="IPå±è”½-2"><a href="#IPå±è”½-2" class="headerlink" title="IPå±è”½-2"></a>IPå±è”½-2</h1><p>å› ä¸ºæ¯æ¬¡è¯·æ±‚éƒ½æ˜¯ç”¨çš„æ–°ä»£ç†ipï¼Œä»£ç åŒ <code>ipå±è”½1</code>é¢˜ã€‚</p><p>ç»“æœï¼ˆå¤šå¾ªç¯äº†ä¸€æ¬¡ï¼Œcurr_page &gt;1000 ä¹‹å‰æ²¡åŠ ä¸Š &gt;&#x3D;ï¼Œå¯¹ç»“æœæ²¡å½±å“ï¼‰ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/ip-mask-4.1.png" alt="IPå±è”½-4.1"></p><h1 id="å­—ä½“åçˆ¬-1"><a href="#å­—ä½“åçˆ¬-1" class="headerlink" title="å­—ä½“åçˆ¬-1"></a>å­—ä½“åçˆ¬-1</h1><p>çœ‹è¿‡é¢˜å¹¶åˆ†æè¿‡htmlä»£ç çš„åº”è¯¥éƒ½æ¸…é™¤ï¼Œæ¯æ¬¡åˆ·æ–°æºç ä¸­çš„æ•°å­—éƒ½æ˜¯å˜åŒ–çš„ï¼Œè€Œå®é™…æ˜¾ç¤ºå‡ºçš„æ•°å­—éƒ½æ²¡å˜åŒ–ã€‚<br>æœ‰å¿ƒçš„åŒå­¦åº”è¯¥æ¯”è¾ƒè¿‡æ¯æ¬¡åˆ·æ–°ç½‘é¡µåçš„base64ä¸²çš„å€¼ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸åŒçš„ï¼Œè¯´æ˜base64ä¸²åœ¨è¿™é‡Œæ‰¿è½½äº†å­—ä½“è½¬åŒ–çš„åŠŸèƒ½ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.1.png" alt="åˆ·æ–°ç½‘é¡µåçš„base64ä¸²æ¯”è¾ƒ"><br>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹æ¯æ¬¡çš„base64ä¸²è¿›è¡Œåˆ†æï¼Œåœ¨è¿™é‡Œäº†è§£åˆ°äº†èƒ½å°†base64è½¬åŒ–ä¸º<code>ttf</code>æ–‡ä»¶ï¼Œå†åˆ©ç”¨ä»£ç è½¬ä¸º<code>xml</code>æ–‡ä»¶åšåˆ†æã€‚</p><p>æˆ‘ä»¬åœ¨<code>æµè§ˆå™¨</code>å†…(æ–¹ä¾¿åæœŸå¯¹æ¯”ç¡®è®¤ç»“æœ)ï¼Œè·å–base64ä¸²ï¼Œç”¨ä»£ç å°†å…¶è½¬ä¸º ttf å’Œ xml æ–‡ä»¶ã€‚</p><blockquote><p><strong>æ•°æ®é‡‡é›†è¿‡ç¨‹</strong></p></blockquote><p><img src="https://img.lsycai.top/glidedsky/font-non-5.2.png" alt="æ‰“å¼€æ— ç—•çª—å£"><br>è¿›å…¥é¡µé¢åF12ï¼Œæœç´¢<code>base64</code>ï¼Œè¿›å…¥ç•Œé¢å¤åˆ¶å€¼ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.3.png" alt="æœç´¢"></p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.4.png" alt="å¤åˆ¶base64ä¸²"></p><blockquote><p>ä»£ç éªŒè¯base64çš„ä¸å”¯ä¸€æ€§  å¹¶  è½¬åŒ–ttfã€xml<br><strong>ttf_test.py</strong></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">å…³äºè½¬ç </span><br><span class="hljs-string">    https://blog.csdn.net/yishengzhiai005/article/details/80045042</span><br><span class="hljs-string">    python2ä¸­è¿›è¡ŒBase64ç¼–ç å’Œè§£ç </span><br><span class="hljs-string">    python3ä¸å¤ªä¸€æ ·ï¼šå› ä¸º3.xä¸­å­—ç¬¦éƒ½ä¸ºunicodeç¼–ç ï¼Œè€Œb64encodeå‡½æ•°çš„å‚æ•°ä¸ºbyteç±»å‹ï¼Œæ‰€ä»¥å¿…é¡»å…ˆè½¬ç ã€‚</span><br><span class="hljs-string">    </span><br><span class="hljs-string">æµ‹è¯•base64è½¬ttfã€åˆ†ættfã€xmlæ–‡ä»¶</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> fontTools.ttLib <span class="hljs-keyword">import</span> TTFont<br><br>env = Env()<br>env.login()<br>session = env.session<br><br>url = <span class="hljs-string">&quot;http://www.glidedsky.com/level/web/crawler-font-puzzle-1&quot;</span><br><br>response = session.get(url, headers=env.headers)<br><br><span class="hljs-comment"># base64_str = re.search(&#x27;base64,(.*?)[)]&#x27;, response.text).group(1)</span><br><br><span class="hljs-comment"># æ‰“å°base64 è¯´æ˜æ¯æ¬¡çš„base64éƒ½æœ‰ä¸åŒä¹‹å¤„</span><br><span class="hljs-comment"># print(base64_str)</span><br><span class="hljs-comment"># è§£ç (base64å‚æ•°éƒ½æ˜¯unicodeç¼–ç åçš„ä¸², æ‰€ä»¥strå…ˆå¾—encode), è§£ç é’ˆå¯¹çš„æ˜¯base64_strç¼–ç æˆunicodeåçš„bytes</span><br><br><span class="hljs-comment"># ç›´æ¥ç”¨æˆ‘ä»¬æ— ç—•æµè§ˆå™¨å¤åˆ¶ä¸‹æ¥çš„base64ä¸²</span><br>base64_str = <span class="hljs-string">&quot;è‡ªå·±è¡¥å…¨&quot;</span><br>data = base64.b64decode(base64_str.encode())<br><span class="hljs-comment"># ç°åœ¨çš„dataä¾æ—§æ˜¯unicodeç¼–ç çš„bytesç±»å‹</span><br><br><span class="hljs-comment"># å†™å‡ºä¸º .ttf</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;font-puzzle-1.ttf&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(data)<br><br><span class="hljs-comment"># å°†font-puzzle-1.ttfè½¬ä¸ºxmlæ–‡ä»¶</span><br>font = TTFont(<span class="hljs-string">&#x27;font-puzzle-1.ttf&#x27;</span>)<br>font.saveXML(<span class="hljs-string">&#x27;font-puzzle-1.xml&#x27;</span>)<br></code></pre></td></tr></table></figure><blockquote><p><strong>ç¬¬ä¸€æ¬¡è·å–base64ä¸²</strong></p></blockquote><p>å°†base64ä¸²èµ‹å€¼åˆ°ä»£ç ä¸­å˜é‡ <code>base64_str</code>ï¼Œè¿è¡Œç”Ÿæˆ ttf å’Œ xmlã€‚<br>å°†ttfç”¨fontstore<a href="http://font.qqe2.com/index.html">é“¾æ¥</a>ï¼ˆæˆ–fontcreatorï¼‰æ‰“å¼€ï¼Œ</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.5.png" alt="å­—ä½“åçˆ¬-5.5"></p><p>fontstoreæ‰“å¼€å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.6.png" alt="fontstoreæ‰“å¼€"><br>fontcreatoræ‰“å¼€å¦‚ä¸‹ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.7.png" alt="å­—ä½“åçˆ¬-5.7"><br>æˆ‘ä»¬å†æ‰“å¼€ xml è¿›è¡Œåˆ†æï¼Œæœç´¢<code>code</code>ç›¸å…³å†…å®¹ï¼Œå‘ç°å°±åªæœ‰ä»¥ä¸‹2å¤„æœ‰æ•ˆæ•°æ®(å’Œæ•°å­—ç›¸å…³çš„æ•°æ®)ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.8.png" alt="å­—ä½“åçˆ¬-5.8"></p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.9.png" alt="å­—ä½“åçˆ¬-5.9"></p><p>ç»“åˆ<code>xmlä¸­ä¸Šé¢2å›¾çš„æ˜ å°„å…³ç³»</code>å’Œ<code>fontstoreä¸­çš„</code>å°†æ•°æ®æ•´ç†æˆè¡¨æ ¼ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.10.png" alt="å­—ä½“åçˆ¬-5.10"><br>çº¸é¢åˆ†æå®Œäº†ï¼Œè¿›è¡Œæµè§ˆå™¨å†…å®¹æ¯”è¾ƒï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.11.png" alt="å­—ä½“åçˆ¬-5.11"></p><p>æ¯”è¾ƒæµè§ˆå™¨æ˜¾ç¤ºï¼šè¯´æ˜å­—ä½“æ–‡ä»¶ï¼ˆttf&#x2F;xmlï¼‰ä¸­çš„cmapä¸­çš„<font color=red>nameå€¼</font>å”¯ä¸€å¯¹åº”ä¸€ä¸ª<font color=red>å®é™…æ˜¾ç¤º</font>ã€‚å› ä¸ºè¡¨æ ¼ä¸­ï¼Œâ€zeroâ€ â€“&gt; 8ï¼Œâ€oneâ€  â€“&gt; 5 â€¦â€¦ï¼Œåªæ˜¯æˆ‘åœ¨å›¾ä¸­ç”¨äº†æ•°å­—è¡¨ç¤ºã€‚</p><blockquote><p><strong>ç¬¬äºŒæ¬¡è·å–base64ä¸²</strong></p></blockquote><p>é‡å¼€ä¸€ä¸ªæ— ç—•æµè§ˆå™¨ï¼Œè¿›è¡ŒåŒæ ·è®¿é—®ï¼Œè·å¾—ä¸€ä¸ªæ–°base64ä¸²ï¼Œç”¨ä»£ç ï¼ˆttf_test.pyï¼‰é‡æ–°ç”Ÿæˆttfå’Œxmlæ–‡ä»¶ï¼Œfontstore<font color=red>é‡æ–°</font>æ‰“å¼€ttfæ–‡ä»¶ã€‚</p><p>ç°åœ¨å…ˆå°±å¯ä»¥ä¸ç”¨å†åˆ†æxmlæ–‡ä»¶å†…å®¹äº†ï¼Œç»è¿‡ç¬¬ä¸€æ¬¡è§‚å¯Ÿï¼Œç›´æ¥çœ‹<code>fontstoreç»“æœ</code>å³å¯ï¼Œç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.12.png" alt="å­—ä½“åçˆ¬-5.12"><br>é‡è¦ç»“è®ºï¼š<font color=red>nameå¯¹åº”codeä¸€ç›´éƒ½æ²¡æœ‰æ”¹å˜çš„ã€‚</font>æ‰€ä»¥ï¼Œæºç æ”¹å˜ï¼Œä½†æ˜¯å®é™…æ˜¾ç¤ºå†…å®¹ä¸å˜ï¼Œè‚¯å®šæ˜¯ <code>code --&gt; å®é™…æ˜¾ç¤º</code>  è¿™ä¸€è¿‡ç¨‹çš„æ˜ å°„å‘ç”Ÿäº†å˜åŒ–ã€‚æ­£å¥½GlyphOrderæ˜ å°„æœ‰æ‰€æ”¹å˜ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.13.png" alt="å­—ä½“åçˆ¬-5.13"><br>ä¸‹é¢æ˜¯æ–°ä¸€è½®ç»Ÿè®¡çš„è¡¨æ ¼ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.14.png" alt="å­—ä½“åçˆ¬-5.14"></p><p>â€œ7â€ï¼Œâ€¦..ã€‚</p><p>ç°åœ¨é ç¬¬äºŒæ¬¡çº¸é¢åˆ†æçš„ç»“æœï¼Œæˆ‘ä»¬æ¨æµ‹ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.15.png" alt="å­—ä½“åçˆ¬-5.15"></p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.16.png" alt="å­—ä½“åçˆ¬-5.16"></p><p>æ¨æµ‹<font color=red>æ­£ç¡®</font>ã€‚</p><blockquote><p><strong>æ€è€ƒ</strong></p></blockquote><p>ç°åœ¨æˆ‘ä»¬èƒ½ä»xmlä¸­è·å–<code>name --&gt; code</code> çš„æ˜ å°„ï¼ˆè¿™æ˜¯ä¸å˜çš„ï¼‰ï¼Œé‚£ä¹ˆ ä» <code>name --&gt; å®é™…æ˜¾ç¤º</code> çš„æ˜ å°„æ€ä¹ˆåŠå‘¢?</p><p>ä»ç¬¬äºŒæ¬¡æµ‹è¯•ä¸­èƒ½å¾—å‡ºï¼šå®é™…æ˜¾ç¤ºçš„æ”¹å˜å°±å’Œ<code>GlyphOrder</code>çš„å˜åŒ–æœ‰å…³ï¼ˆå³IDå’Œnameçš„æ˜ å°„çš„æ”¹å˜ï¼‰ã€‚</p><p>å†åŠ ä¸Šå®é™…æ˜¾ç¤ºçš„ç»“æœï¼Œæˆ‘ä»¬æ¯”è¾ƒ2æ¬¡æµ‹è¯•ï¼Œè¡¨æ ¼ç»“æœçš„åŒºåˆ«ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-5.17.png" alt="å­—ä½“åçˆ¬-5.17"><br>ä»xmlæ–‡ä»¶ä¸­å’Œ<code>&quot;code&quot;</code>æœ‰å…³çš„éƒ¨åˆ†å°±åªæœ‰<code>GlyphOrder</code>å’Œ<code>cmap</code>ï¼Œcmaçš„nameã€codeæˆ‘ä»¬å·²ç»ç”¨äº†ï¼Œä¹Ÿç”¨äº†GlyphOrderä¸­çš„nameï¼Œè¿˜æœ‰GlyphOrderä¸­çš„IDè§„å¾‹æˆ‘ä»¬æ²¡è€ƒè™‘åˆ°ã€‚</p><p>æˆ‘ä»¬è§‚å¯Ÿä¸Šé¢2å›¾ï¼Œå¾ˆè½»æ¾å°±èƒ½å‘ç°<mark class="hl-label å°±ç­‰äº">ID-1</mark> </p><blockquote><p><strong>å®ç°</strong></p></blockquote><p>æ‰€ä»¥ä»£ç é€»è¾‘ä¹Ÿæœ‰äº†ï¼šè¯·æ±‚è·å–base64ï¼Œè½¬ä¸ºtffå†è½¬ä¸ºxmlï¼Œlxmlè§£æï¼Œï¼ˆèƒ½æ„å»ºcmapä¸­ <code>name --&gt; code</code>ï¼Œä½†æˆ‘ä»¬åªå…³å¿ƒ<code>name--&gt;ID</code>ï¼‰ï¼Œå†æ„å»ºGlyphOrderä¸­  <code>name --&gt; ID</code>çš„æ˜ å°„ã€‚å¾—åˆ°äº†nameï¼Œ<strong>nameå…¶å®å°±æ˜¯æµè§ˆå™¨æºç ä¸­æèµ·å‡ºæ¥çš„æ•°å­—ï¼Œè½¬åŒ–ä¸ºIDï¼Œå†å‡ä¸€ï¼Œå°±æˆäº†çœŸå®æ•°æ®äº†</strong>ã€‚ä½†æ˜¯nameä¸­ <code>&#39;zero&#39;</code>éœ€è¦å˜ä¸º<code>0</code>ï¼Œæ–¹ä¾¿åæœŸç›´æ¥è¿›è¡Œé¡µé¢å†…å®¹è½¬åŒ–ä¸ºçœŸå®ç»“æœã€‚</p><blockquote><p>ä»£ç å¦‚ä¸‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> fontTools.ttLib <span class="hljs-keyword">import</span> TTFont<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> io<br><br><span class="hljs-comment"># æ•°å­—-è‹±è¯­ æ˜ å°„</span><br>english_map = &#123;<br>    <span class="hljs-string">&#x27;0&#x27;</span>: <span class="hljs-string">&#x27;zero&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>: <span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-string">&#x27;two&#x27;</span>,<br>    <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-string">&#x27;four&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>: <span class="hljs-string">&#x27;five&#x27;</span>,<br>    <span class="hljs-string">&#x27;6&#x27;</span>: <span class="hljs-string">&#x27;six&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>: <span class="hljs-string">&#x27;seven&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>: <span class="hljs-string">&#x27;eight&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>: <span class="hljs-string">&#x27;nine&#x27;</span><br>&#125;<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">å°†æºç ä¸­çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºçœŸå®çš„æ•°å­—</span><br><span class="hljs-string">    src_str: å¦‚&#x27;231&#x27; --&gt; 567  &#x27;23&#x27; --&gt; 56  &#x27;1&#x27; --&gt; 7</span><br><span class="hljs-string">    digit_map: æºç æ•°å­— --&gt; çœŸå®æ•°å­— çš„æ˜ å°„ &#123;&quot;zero&quot;: see_num1, &quot;one&quot;: see_num2, ...&#125;</span><br><span class="hljs-string">    è¿”å›: çœŸå®æ•°å­—</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_srcstr_realnum</span>(<span class="hljs-params">src_str, digit_map</span>):<br>    <span class="hljs-comment"># åˆ†è§£å‡ºæ¯ä¸€ä½å­—ç¬¦ æ³¨æ„ joinå‚æ•°å¿…é¡»ä¸ºå­—ç¬¦ä¸²</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(digit_map[english_map[ch]]) <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> src_str))<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–ä»æºç ä¸­çš„æ•°å­—åˆ°è§åˆ°çš„æ•°å­—çš„æ˜ å°„</span><br><span class="hljs-string">    è¿”å›: å½“å‰é¡µå“åº”, å½“å‰é¡µçš„æ•°å­—æ˜ å°„</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_response_and_digitmap</span>(<span class="hljs-params">page</span>):<br>    url = <span class="hljs-string">f&quot;http://www.glidedsky.com/level/web/crawler-font-puzzle-1?page=<span class="hljs-subst">&#123;page&#125;</span>&quot;</span><br><br>    response = session.get(url, headers=env.headers)<br><br>    base64_str = re.search(<span class="hljs-string">&#x27;base64,(.*?)[)]&#x27;</span>, response.text).group(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># è§£ç (base64å‚æ•°éƒ½æ˜¯unicodeç¼–ç åçš„ä¸², æ‰€ä»¥strå…ˆå¾—encode), è§£ç é’ˆå¯¹çš„æ˜¯base64_strç¼–ç æˆunicodeåçš„bytes</span><br>    data = base64.b64decode(base64_str.encode())<br>    <span class="hljs-comment"># ç°åœ¨çš„dataä¾æ—§æ˜¯unicodeç¼–ç çš„bytesç±»å‹, è½¬åŒ–ä¸ºioæµ, é¿å…å†™æ–‡ä»¶è¿‡ç¨‹</span><br>    fio = io.BytesIO(data)<br>    font = TTFont(fio)<br>    glyph_order = font.getGlyphOrder()<br>    <span class="hljs-comment"># æ•°å­—æ˜ å°„ &#123;&quot;æºç ä¸­çš„æ•°å­—&quot;: &quot;å®é™…çœ‹åˆ°çš„æ•°å­—&quot;, ...&#125;</span><br>    digit_map = &#123;&#125;<br>    <span class="hljs-comment"># è§£æGlyphOrderä¸­çš„&lt;GlyphID id=&quot;&quot; name=&quot;&quot;&gt; å¹¶ç»„æˆ &#123;&quot;zero&quot;: &quot;see_num1&quot;, &quot;one&quot;: &quot;see_num2&quot;, ...&#125;</span><br>    <span class="hljs-keyword">for</span> glyph_name <span class="hljs-keyword">in</span> glyph_order:<br>        digit_map[glyph_name] = <span class="hljs-built_in">str</span>(font.getGlyphID(glyph_name) - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æºç æ•°å­— -&gt; å¯è§æ•°å­—: &#x27;</span>, digit_map)<br>    <span class="hljs-keyword">return</span> digit_map, response<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–å½“å‰é¡µçœŸå®çš„æ•°å­—å’Œ, ä¸€æ¬¡è¯·æ±‚ä¸€é¡µ, ä¸€é¡µå†…çš„æ•°å­— æ˜ å°„ä¸ä¼šå˜çš„</span><br><span class="hljs-string">    page: ç¬¬å‡ é¡µæ•°æ®</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_page_sum</span>(<span class="hljs-params">page</span>):<br>    digit_map, response = get_response_and_digitmap(page)<br>    <span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>    html = etree.HTML(response.text)<br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>    <span class="hljs-comment"># æ¯é¡µå’Œ</span><br>    page_total = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>        <span class="hljs-comment"># ä¸€ä¸ªæ•°å­—ä¸²</span><br>        s = <span class="hljs-built_in">str</span>(div.xpath(<span class="hljs-string">&#x27;normalize-space(./text())&#x27;</span>))<br>        <span class="hljs-comment"># åˆ†åˆ«è§£æ, å¦‚&#x27;231&#x27; -&gt; 231</span><br>        page_total += parse_srcstr_realnum(s, digit_map)<br><br>    <span class="hljs-keyword">return</span> page_total<br><br><br>env = Env()<br>env.login()<br>session = env.session<br><br><span class="hljs-comment"># æ€»å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># å®šä¹‰å’Œ</span><br><span class="hljs-keyword">for</span> page_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):<br>    total += get_page_sum(page_num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰ <span class="hljs-subst">&#123;page_num&#125;</span> é¡µå’Œä¸º <span class="hljs-subst">&#123;total&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="å­—ä½“åçˆ¬-2"><a href="#å­—ä½“åçˆ¬-2" class="headerlink" title="å­—ä½“åçˆ¬-2"></a>å­—ä½“åçˆ¬-2</h1><p>åŸç†åŒ<code>å­—ä½“åçˆ¬1</code>ï¼Œä½†æ˜¯ç°åœ¨ä»æµè§ˆå™¨è·å–çš„å†…å®¹ä¸æ˜¯æ•°å­—äº†ï¼Œè€Œæ˜¯æ±‰å­—ï¼Œå¹¶ä¸”xmlä¸­campçš„nameå€¼ä¹Ÿå¹¶æ²¡æœ‰åƒ â€œzeroâ€ã€â€oneâ€çš„æç¤ºäº†ï¼Œæ‰€ä»¥ä¹‹å‰å­˜åœ¨çš„ english_map ç°åœ¨éœ€è¦ç”±æˆ‘ä»¬è‡ªå·±æ„å»ºäº†ï¼ŒåŸæ¥english_mapæ˜¯ â€œ1â€ -&gt; â€œzeroâ€ çš„æ˜ å°„ï¼ˆè¿™æˆ‘ä»¬æ˜¯ç†ŸçŸ¥çš„ï¼‰ï¼Œä½†ç°åœ¨æˆ‘ä»¬éœ€è¦ â€œæºç ä¸­æ±‰å­—â€ -&gt; â€œnameâ€ çš„æ˜ å°„ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.1.png" alt="å­—ä½“åçˆ¬-6.1"></p><blockquote><p>æµ‹è¯•getè¯·æ±‚è·å–çš„å†…å®¹ï¼Œç¼–ç å‰å’Œç¼–ç åçš„å†…å®¹ï¼Œå¹¶ç”Ÿæˆttfå’Œxml</p><p>ç”¨æµè§ˆå™¨èƒ½å¾—åˆ°base64å’Œæ˜¾ç¤ºæƒ…å†µï¼Œåˆ†æ  â€œæºç æ±‰å­—â€  â€“&gt;  â€œå®é™…æ˜¾ç¤ºâ€ çš„è¿‡ç¨‹ã€‚</p></blockquote><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼ˆtest_ttf.pyï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> fontTools.ttLib <span class="hljs-keyword">import</span> TTFont<br><br><span class="hljs-comment"># æµè§ˆå™¨å¤åˆ¶base64ä¸² ä¿æŒç½‘é¡µä¸åˆ·æ–° åˆ†æåŒä¸€é¡µçš„æ•°æ®</span><br>base64_str = <span class="hljs-string">&quot;æµè§ˆå™¨æºç é‡Œå¤åˆ¶&quot;</span><br>data = base64.b64decode(base64_str.encode())<br><span class="hljs-comment"># ç°åœ¨çš„dataä¾æ—§æ˜¯unicodeç¼–ç çš„bytesç±»å‹</span><br><br><span class="hljs-comment"># å†™å‡ºä¸º .ttf</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;font-puzzle-2.ttf&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(data)<br><br><span class="hljs-comment"># å°†font-puzzle-2.ttfè½¬ä¸ºxmlæ–‡ä»¶</span><br>font = TTFont(<span class="hljs-string">&#x27;font-puzzle-2.ttf&#x27;</span>)<br>font.saveXML(<span class="hljs-string">&#x27;font-puzzle-2.xml&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ç”¨fontstoreæ‰“å¼€ttfæ–‡ä»¶ï¼Œåªåˆ†æ 0 - 9ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.2.png" alt="å­—ä½“åçˆ¬-6.2"></p><p>æµè§ˆå™¨ä¸­å®é™…æ˜¾ç¤ºä¸ºâ€œé›¶â€çš„æƒ…å†µä¸‹ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.3.png" alt="å­—ä½“åçˆ¬-6.3"></p><p>å¯¹åº”æºç æ±‰å­—ä¸ºï¼šâ€œé’¡â€ï¼Œç»è¿‡ç«™é•¿å·¥å…·è®¡ç®—ï¼Œâ€œé’¡â€çš„unicodeç¼–ç ä¸ºï¼šâ€\u94a1â€</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.4.png" alt="å­—ä½“åçˆ¬-6.4"></p><p>æˆ‘ä»¬å†åœ¨xmlæ–‡ä»¶ä¸­æœç´¢â€œé’¡â€çš„unicodeç¼–ç ï¼Œç»“åˆxmlä¸­cmapçš„å†…å®¹ï¼Œæˆ‘ä»¬ç›´æ¥æœç´¢â€uni94a1â€ï¼Œæ€»å…±2ä¸ªç»“æœã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.5.png" alt="å­—ä½“åçˆ¬-6.5"></p><p>åœ¨æµè§ˆå™¨ä¸­å®é™…æ˜¾ç¤ºä¸ºâ€œâ‘ â€çš„æƒ…å†µä¸‹ï¼Œ</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.6.png" alt="å­—ä½“åçˆ¬-6.6"></p><p>è€Œâ€œæˆâ€å­—å¯¹åº”çš„unicodeç¼–ç ä¸ºâ€œ\u6210â€ï¼Œå‚ç…§cmapä¸­nameçš„å€¼ï¼Œæˆ‘ä»¬åœ¨xmlä¸­æœç´¢â€œuni6210â€ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.7.png" alt="å­—ä½“åçˆ¬-6.7"></p><p>æ ¹æ®ä»¥ä¸Š2æ¬¡æµ‹è¯•ï¼Œå¹¶æ ¹æ®<code>å­—ä½“åçˆ¬1</code>çš„ç»“æœï¼Œå¾ˆæ˜æ˜¾èƒ½çœ‹å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">name = &quot;uni&quot; + &quot;æºç æ±‰å­—çš„unicodeç¼–ç  å»é™¤\u&quot;<br>æ ¹æ®è¿™ä¸ªnameå¯¹åº”çš„IDï¼Œå†å‡1ï¼Œç»“æœå°±æ˜¯å®é™…çš„æ•°å­—ã€‚<br></code></pre></td></tr></table></figure><blockquote><p>ä»£ç é€»è¾‘</p></blockquote><p>å…ˆæ ¹æ®GlyphOrderæ„å»º {â€œname1â€: â€œidâ€, â€œname2â€, â€œid2â€â€¦} çš„å­—å…¸ï¼Œä¹‹åå†è·å–åˆ°â€æºç æ±‰å­—â€ï¼Œå°†æ±‰å­—è¿›è¡Œåˆ‡å‰²åï¼Œå–æ¯ä¸€ä½çš„unicodeç ï¼ˆå°±æ˜¯nameï¼‰ï¼Œä»¥unicodeç ä¸ºé”®ï¼Œä»å­—å…¸ä¸­å–idï¼Œidå†å‡1å°±æ˜¯ç”¨æˆ·çœ‹åˆ°çš„æ•°å­—ã€‚</p><blockquote><p>ä»£ç </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> fontTools.ttLib <span class="hljs-keyword">import</span> TTFont<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> io<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">å°†æºç ä¸­çš„æ±‰å­—è½¬åŒ–ä¸ºçœŸå®çš„æ•°å­—</span><br><span class="hljs-string">    src_str: å¦‚&#x27;éšæˆæˆ&#x27; --&gt; 211</span><br><span class="hljs-string">    uni_map: æºç æ±‰å­— --&gt; çœŸå®æ•°å­— çš„æ˜ å°„ &#123;&quot;æˆ&quot;: 1, &quot;éš&quot;: 2, ...&#125;</span><br><span class="hljs-string">    è¿”å›: çœŸå®æ•°å­—</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_srcstr_realnum</span>(<span class="hljs-params">src_str, uni_map</span>):<br>    arr = []<br>    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> src_str:<br>        <span class="hljs-comment"># æ¯ä¸ªchéƒ½æ˜¯ä¸€ä¸ªæ±‰å­—, å°†æ±‰å­—è½¬ä¸ºunicodeç¼–ç , å»é™¤ä¸²é¦–çš„\uå³ä¸ºéœ€è¦çš„ç¼–ç </span><br>        uni = ch.encode(<span class="hljs-string">&#x27;unicode-escape&#x27;</span>).decode()<br>        code = uni.replace(<span class="hljs-string">&#x27;\\u&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        arr.append(uni_map[code])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(arr))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–ä»æºç ä¸­çš„æ±‰å­—åˆ°è§åˆ°çš„æ•°å­—çš„æ˜ å°„</span><br><span class="hljs-string">    è¿”å›: å½“å‰é¡µå“åº”, name(unicodeå»é™¤&#x27;uni&#x27;)-&gt;çœŸå®æ•°å­— çš„æ˜ å°„ å¦‚, (response, &#123;&#x27;7bd9&#x27;: &#x27;0&#x27;, &#x27;9716&#x27;: &#x27;1&#x27;, ...&#125;)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_response_and_unimap</span>(<span class="hljs-params">page</span>):<br>    url = <span class="hljs-string">f&quot;http://www.glidedsky.com/level/web/crawler-font-puzzle-2?page=<span class="hljs-subst">&#123;page&#125;</span>&quot;</span><br><br>    response = session.get(url, headers=env.headers)<br><br>    base64_str = re.search(<span class="hljs-string">&#x27;base64,(.*?)[)]&#x27;</span>, response.text).group(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># è§£ç (base64å‚æ•°éƒ½æ˜¯unicodeç¼–ç åçš„ä¸², æ‰€ä»¥strå…ˆå¾—encode), è§£ç é’ˆå¯¹çš„æ˜¯base64_strç¼–ç æˆunicodeåçš„bytes</span><br>    data = base64.b64decode(base64_str.encode())<br><br>    <span class="hljs-comment"># ç°åœ¨çš„dataä¾æ—§æ˜¯unicodeç¼–ç çš„bytesç±»å‹, è½¬åŒ–ä¸ºioæµ, é¿å…å†™æ–‡ä»¶è¿‡ç¨‹</span><br>    fio = io.BytesIO(data)<br>    font = TTFont(fio)<br>    glyph_order = font.getGlyphOrder()<br>    <span class="hljs-comment"># xmlä¸­ï¼šname-&gt;IDæ˜ å°„ &#123;&quot;unicode&quot;: &quot;id-1&quot;, ...&#125; æ³¨æ„è¿™é‡Œçš„unicodeæœ€å¥½æŠŠå‰ç¼€uniå»æ‰, å¹¶å­—æ¯å°å†™åŒ–</span><br>    name_id_map = &#123;&#125;<br>    <span class="hljs-comment"># è§£æGlyphOrderä¸­çš„&lt;GlyphID id=&quot;&quot; name=&quot;&quot;&gt; å¹¶ç»„æˆ &#123;&quot;unicode1&quot;: &quot;see_num1&quot;, &quot;unicode2&quot;: &quot;see_num2&quot;, ...&#125;</span><br>    <span class="hljs-keyword">for</span> glyph_name <span class="hljs-keyword">in</span> glyph_order:<br>        name_id_map[<span class="hljs-built_in">str</span>(glyph_name).replace(<span class="hljs-string">&#x27;uni&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).lower()] = <span class="hljs-built_in">str</span>(font.getGlyphID(glyph_name) - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æºç æ±‰å­—unicodeç  -&gt; å¯è§æ•°å­—: &#x27;</span>, name_id_map)<br>    <span class="hljs-keyword">return</span> name_id_map, response<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–å½“å‰é¡µçœŸå®çš„æ•°å­—å’Œ, ä¸€æ¬¡è¯·æ±‚ä¸€é¡µ, ä¸€é¡µå†…çš„æ•°å­— æ˜ å°„ä¸ä¼šå˜çš„</span><br><span class="hljs-string">    page: ç¬¬å‡ é¡µæ•°æ®</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_page_sum</span>(<span class="hljs-params">page</span>):<br>    uni_map, response = get_response_and_unimap(page)<br>    <span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>    html = etree.HTML(response.text)<br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>    <span class="hljs-comment"># æ¯é¡µå’Œ</span><br>    page_total = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>        <span class="hljs-comment"># ä¸€ä¸ªæ•°å­—ä¸²</span><br>        s = <span class="hljs-built_in">str</span>(div.xpath(<span class="hljs-string">&#x27;normalize-space(./text())&#x27;</span>))<br>        <span class="hljs-comment"># åˆ†åˆ«è§£æ, å¦‚&#x27;231&#x27; -&gt; 231</span><br>        page_total += parse_srcstr_realnum(s, uni_map)<br><br>    <span class="hljs-keyword">return</span> page_total<br><br><br>env = Env()<br>env.login()<br>session = env.session<br><br><span class="hljs-comment"># æ€»å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># å®šä¹‰å’Œ</span><br><span class="hljs-keyword">for</span> page_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):<br>    total += get_page_sum(page_num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰ <span class="hljs-subst">&#123;page_num&#125;</span> é¡µå’Œä¸º <span class="hljs-subst">&#123;total&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ€è·¯åŠä»£ç å…¶å®æœ‰è¯¯ï¼Œä¼šåœ¨ä» uni_map ä¸­å–å€¼çš„æ—¶å€™ä¼šæŠ¥é”™(KeyError)ã€‚</p><p>ä¿®æ”¹ä»£ç ä¸ºå¦‚ä¸‹ï¼Œè¿›è¡Œè°ƒè¯•ï¼š</p><p>â‘ ï¼šå‡ºé”™ä½ç½®æ·»åŠ tryâ€¦except</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_srcstr_realnum</span>(<span class="hljs-params">src_str, uni_map</span>):<br>    arr = []<br>    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> src_str:<br>        <span class="hljs-comment"># æ¯ä¸ªchéƒ½æ˜¯ä¸€ä¸ªæ±‰å­—, å°†æ±‰å­—è½¬ä¸ºunicodeç¼–ç , å»é™¤ä¸²é¦–çš„\uå³ä¸ºéœ€è¦çš„ç¼–ç </span><br>        uni = ch.encode(<span class="hljs-string">&#x27;unicode-escape&#x27;</span>).decode()<br>        code = uni.replace(<span class="hljs-string">&#x27;\\u&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">try</span>:<br>            arr.append(uni_map[code])<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(arr))<br></code></pre></td></tr></table></figure><p>â‘¡ï¼šè·å–responseä¹‹åï¼Œæˆ‘ä»¬æ·»åŠ å°†base64å†™å…¥ttfå’Œxmlçš„è¿‡ç¨‹ã€‚ï¼ˆç›®çš„æ˜¯ä¿è¯å‡ºé”™æ—¶æˆ‘ä»¬èƒ½æŸ¥çœ‹xmlï¼Œåˆ†æä¸ºä»€ä¹ˆæ²¡æœ‰å¯¹åº”çš„unicodeç¼–ç çš„nameå€¼ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è§£ç (base64å‚æ•°éƒ½æ˜¯unicodeç¼–ç åçš„ä¸², æ‰€ä»¥strå…ˆå¾—encode), è§£ç é’ˆå¯¹çš„æ˜¯base64_strç¼–ç æˆunicodeåçš„bytes</span><br>    data = base64.b64decode(base64_str.encode())<br>    <span class="hljs-comment"># å†™å‡ºä¸º .ttf</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./font-puzzle-test2/font-puzzle-2.ttf&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(data)<br>    <span class="hljs-comment"># å°†font-puzzle-2.ttfè½¬ä¸ºxmlæ–‡ä»¶</span><br>    font = TTFont(<span class="hljs-string">&#x27;./font-puzzle-test2/font-puzzle-2.ttf&#x27;</span>)<br>    font.saveXML(<span class="hljs-string">&#x27;./font-puzzle-test2/font-puzzle-2.xml&#x27;</span>)<br><br>    <span class="hljs-comment"># ç°åœ¨çš„dataä¾æ—§æ˜¯unicodeç¼–ç çš„bytesç±»å‹, è½¬åŒ–ä¸ºioæµ, é¿å…å†™æ–‡ä»¶è¿‡ç¨‹</span><br>    fio = io.BytesIO(data)<br>    font = TTFont(fio)<br>    glyph_order = font.getGlyphOrder()<br></code></pre></td></tr></table></figure><p>å¼€å§‹è°ƒè¯•ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.8.png" alt="å­—ä½“åçˆ¬-6.8"></p><p>è¿™æ—¶æ•°æ®å·²ç»åˆ·æ–°åˆ°ttfã€xmlæ–‡ä»¶ä¸­äº†ï¼Œæˆ‘ä»¬è¿›xmlæ–‡ä»¶è¿›è¡ŒæŸ¥çœ‹ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.9.png" alt="å­—ä½“åçˆ¬-6.9"></p><p>æœ€åéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/font-non-6.10.png" alt="å­—ä½“åçˆ¬-6.10"></p><blockquote><p>ä¿®æ”¹åçš„ä»£ç </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> fontTools.ttLib <span class="hljs-keyword">import</span> TTFont<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> io<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">å°†æºç ä¸­çš„æ±‰å­—è½¬åŒ–ä¸ºçœŸå®çš„æ•°å­—</span><br><span class="hljs-string">    src_str: å¦‚&#x27;éšæˆæˆ&#x27; --&gt; 211</span><br><span class="hljs-string">    uni_map: æºç æ±‰å­— --&gt; çœŸå®æ•°å­— çš„æ˜ å°„ &#123;&quot;æˆ&quot;: 1, &quot;éš&quot;: 2, ...&#125;</span><br><span class="hljs-string">    è¿”å›: çœŸå®æ•°å­—</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_srcstr_realnum</span>(<span class="hljs-params">src_str, uni_map</span>):<br>    arr = []<br>    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> src_str:<br>        <span class="hljs-comment"># æ¯ä¸ªchéƒ½æ˜¯ä¸€ä¸ªæ±‰å­—, å°†æ±‰å­—è½¬ä¸ºunicodeç¼–ç , å»é™¤ä¸²é¦–çš„\uå³ä¸ºéœ€è¦çš„ç¼–ç </span><br>        uni = ch.encode(<span class="hljs-string">&#x27;unicode-escape&#x27;</span>).decode()<br>        code = uni.replace(<span class="hljs-string">&#x27;\\u&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        arr.append(uni_map[code])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(arr))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–ä»æºç ä¸­çš„æ±‰å­—åˆ°è§åˆ°çš„æ•°å­—çš„æ˜ å°„</span><br><span class="hljs-string">    è¿”å›: å½“å‰é¡µå“åº”, name(unicodeå»é™¤&#x27;uni&#x27;)-&gt;çœŸå®æ•°å­— çš„æ˜ å°„ å¦‚, (response, &#123;&#x27;7bd9&#x27;: &#x27;0&#x27;, &#x27;9716&#x27;: &#x27;1&#x27;, ...&#125;)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_response_and_unimap</span>(<span class="hljs-params">page</span>):<br>    url = <span class="hljs-string">f&quot;http://www.glidedsky.com/level/web/crawler-font-puzzle-2?page=<span class="hljs-subst">&#123;page&#125;</span>&quot;</span><br><br>    response = session.get(url, headers=env.headers)<br><br>    base64_str = re.search(<span class="hljs-string">&#x27;base64,(.*?)[)]&#x27;</span>, response.text).group(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># è§£ç (base64å‚æ•°éƒ½æ˜¯unicodeç¼–ç åçš„ä¸², æ‰€ä»¥strå…ˆå¾—encode), è§£ç é’ˆå¯¹çš„æ˜¯base64_strç¼–ç æˆunicodeåçš„bytes</span><br>    data = base64.b64decode(base64_str.encode())<br><br>    <span class="hljs-comment"># ç°åœ¨çš„dataä¾æ—§æ˜¯unicodeç¼–ç çš„bytesç±»å‹, è½¬åŒ–ä¸ºioæµ, é¿å…å†™æ–‡ä»¶è¿‡ç¨‹</span><br>    fio = io.BytesIO(data)<br>    font = TTFont(fio)<br>    glyph_order = font.getGlyphOrder()<br>    <span class="hljs-comment"># cmapçš„ç»“æ„ &#123; code: name, ... &#125;  æ³¨æ„: cmapä¸­çš„codeæ˜¯10è¿›åˆ¶</span><br>    cmap = font.getBestCmap()<br>    name_id_map = &#123;&#125;<br>    <span class="hljs-comment"># è§£æGlyphOrderä¸­çš„&lt;GlyphID id=&quot;&quot; name=&quot;&quot;&gt; å¹¶ç»„æˆ &#123; &quot;name&quot;: &quot;id-1&quot;... &#125;</span><br>    <span class="hljs-keyword">for</span> glyph_name <span class="hljs-keyword">in</span> glyph_order:<br>        <span class="hljs-comment"># ç°åœ¨è¿˜åªæ˜¯ name: id æ˜ å°„</span><br>        name_id_map[glyph_name] = <span class="hljs-built_in">str</span>(font.getGlyphID(glyph_name) - <span class="hljs-number">1</span>)<br>    <span class="hljs-comment"># å®šä¹‰ code_id_map &#123;code: id, ...&#125;</span><br>    code_id_map = &#123;&#125;<br>    <span class="hljs-comment"># éå†cmap, å¾—åˆ° code_ip_map &#123;code: id&#125;</span><br>    <span class="hljs-keyword">for</span> code <span class="hljs-keyword">in</span> cmap:<br>        <span class="hljs-comment"># å°†codeè½¬åŒ–ä¸º16è¿›åˆ¶</span><br>        code_id_map[<span class="hljs-built_in">hex</span>(code).replace(<span class="hljs-string">&#x27;0x&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)] = name_id_map[cmap[code]]<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æºç æ±‰å­—unicodeç  -&gt; å¯è§æ•°å­—: &#x27;</span>, code_id_map)<br>    <span class="hljs-keyword">return</span> code_id_map, response<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–å½“å‰é¡µçœŸå®çš„æ•°å­—å’Œ, ä¸€æ¬¡è¯·æ±‚ä¸€é¡µ, ä¸€é¡µå†…çš„æ•°å­— æ˜ å°„ä¸ä¼šå˜çš„</span><br><span class="hljs-string">    page: ç¬¬å‡ é¡µæ•°æ®</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_page_sum</span>(<span class="hljs-params">page</span>):<br>    uni_map, response = get_response_and_unimap(page)<br>    <span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>    html = etree.HTML(response.text)<br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>    <span class="hljs-comment"># æ¯é¡µå’Œ</span><br>    page_total = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>        <span class="hljs-comment"># ä¸€ä¸ªæ•°å­—ä¸²</span><br>        s = <span class="hljs-built_in">str</span>(div.xpath(<span class="hljs-string">&#x27;normalize-space(./text())&#x27;</span>))<br>        <span class="hljs-comment"># åˆ†åˆ«è§£æ, å¦‚&#x27;231&#x27; -&gt; 231</span><br>        page_total += parse_srcstr_realnum(s, uni_map)<br><br>    <span class="hljs-keyword">return</span> page_total<br><br><br>env = Env()<br>env.login()<br>session = env.session<br><br><span class="hljs-comment"># æ€»å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># å®šä¹‰å’Œ</span><br><span class="hljs-keyword">for</span> page_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):<br>    total += get_page_sum(page_num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰ <span class="hljs-subst">&#123;page_num&#125;</span> é¡µå’Œä¸º <span class="hljs-subst">&#123;total&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="CSSåçˆ¬-1"><a href="#CSSåçˆ¬-1" class="headerlink" title="CSSåçˆ¬-1"></a>CSSåçˆ¬-1</h1><p>æ¯æ¬¡åˆ·æ–°classéƒ½ä¼šé‡ç½®ï¼ŒæŒ‘å…¶ä¸­ä¸€æ¬¡åˆ†æï¼Œæ¯æ¬¡åˆ†æçš„æ—¶å€™çš„csséƒ½è¦åŒ¹é…æœ¬æ¬¡æ˜¾ç¤ºçš„é¡µé¢ã€‚</p><blockquote><p>ä»¥ä¸‹åˆ†ææœ‰é”™ï¼â‘ å¯ä»¥é€‰æ‹©ä¸çœ‹ï¼Œç›´æ¥çœ‹é”™è¯¯åˆ†æ + é‡æ–°è®¨è®ºã€‚â‘¡é€‰æ‹©çœ‹é”™è¯¯çš„åˆ†ç±»è®¨è®ºï¼Œçœ‹ä¸‹å¦‚ä½•çŠ¯é”™çš„ã€‚</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># åˆ†ç±»è®¨è®º(å–äº†å°‘æ•°å‡ ä¸ªä¾‹å­):</span><br><br>  ## div.col-md-1 å†…åªæœ‰ä¸€ä¸ªdiv(::before) ç›´æ¥è·å–contentå³ä¸ºå…·ä½“å†…å®¹<br><span class="hljs-code">    .Lg20BXy &#123; float:left &#125; .Lg20BXy:before &#123; content:&quot;256&quot; &#125; .Lg20BXy &#123; letter-spacing:0.4em &#125;</span><br><span class="hljs-code"></span><br>  ## div.col-md-1 å†…æœ‰4ä¸ªdiv æœ‰1ä¸ªdivçš„classä¸ºé€æ˜ å¦‚æºç ä¸­ä¸º 9 6 7 2  å®é™…æ˜¾ç¤ºä¸º 276<br><span class="hljs-code">    9: .mk0GYspY &#123; float:left &#125; .mk0GYspY &#123; width:1em &#125; .mk0GYspY &#123; margin-right:-1em &#125;   .mk0GYspY &#123; opacity:0 &#125;</span><br><span class="hljs-code">    6: .kXr1Xjjpn &#123; position:relative &#125; .kXr1Xjjpn &#123; float:left &#125; .kXr1Xjjpn &#123; width:1em &#125; .kXr1Xjjpn &#123; left:2em &#125;</span><br><span class="hljs-code">    7: .Miuk2yGt &#123; float:left &#125;  .Miuk2yGt &#123; width:1em &#125;</span><br><span class="hljs-code">    2: .sX3iaG &#123; position:relative &#125; .sX3iaG &#123; float:left &#125; .sX3iaG &#123; width:1em &#125; .sX3iaG &#123; left:-2em &#125;</span><br><span class="hljs-code">  è§„å¾‹ï¼šé¡ºåºéå†, left:2em &gt; 0 å°±åœ¨&#x27;&#x27;æœ«å°¾æ’å…¥, left:-2em &lt; 0 å°±åœ¨ &#x27;&#x27;å¼€å¤´æ’å…¥, ä¸å­˜åœ¨&#x27;left:&#x27;å’Œ&#x27;opacity:0&#x27;, å°±ç›´æ¥ä¿æŒ&#x27;&#x27;æœ«å°¾æ’å…¥</span><br><span class="hljs-code"></span><br>  ## div.col-md-1 å†…æœ‰3ä¸ªdiv(æ­£å¸¸æƒ…å†µ) å¦‚æºç ä¸­ä¸º 2 9 4  å®é™…æ˜¾ç¤ºä¸º294, è¿™ç§ç›´æ¥æå–å³å¯<br><span class="hljs-code">    2: .pRwyq22qBP &#123; float:left &#125; .pRwyq22qBP &#123; width:1em &#125;</span><br><span class="hljs-code">    9: .fyM23XHiCE &#123; float:left &#125; .fyM23XHiCE &#123; width:1em &#125;</span><br><span class="hljs-code">    4: .BTYOy24xKA &#123; float:left &#125; .BTYOy24xKA &#123; width:1em &#125;</span><br><span class="hljs-code">  è§„å¾‹: æŒ‰ç…§ç¬¬äºŒç§æƒ…å†µå³å¯ï¼ˆç›¸å½“äºç¬¬äºŒç§æƒ…å†µä¸­: æ‰€æœ‰æ•°å­—éƒ½æ˜¯ 7 ï¼‰</span><br><span class="hljs-code"></span><br>  ## div.col-md-1 å†…æœ‰2ä¸ªdiv æœ‰ä¸€ä¸ªdiv<span class="hljs-strong">**åŒ…å«æ•°å­—**</span>ä½†ä¼šè®¾ç½®å®Œå…¨é€æ˜ï¼Œå¦ä¸€ä¸ªdivä½¿ç”¨::beforeæ·»åŠ content, è¿™ä¸ªdivçš„æƒ…å†µå°±å’Œç¬¬1ç§æƒ…å†µç›¸åŒäº†<br></code></pre></td></tr></table></figure><p>ç»¼ä¸Šï¼Œâ‘ å’Œâ‘£å¯ä»¥åˆå¹¶ä¸ºï¼Œdiv.col-md-1å†…éƒ¨åªè¦æœ‰div.xpath(â€˜.&#x2F;div&#x2F;text()â€™)ä¸ºç©ºå€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªdivå†…éƒ¨å°±å¿…å®šæ˜¯ä½¿ç”¨äº†ä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥è·å–contentã€‚</p><p>â‘¡å’Œâ‘¢ä¹Ÿå¯ä»¥åˆå¹¶ï¼šâ‘¡ä¸ç®¡é€æ˜çš„é‚£ä¸ªå…ƒç´ åï¼Œå°±å˜ä¸ºäº†â‘¢è¿™ç§æƒ…å†µäº†ã€‚</p><p>è‡³äºç”Ÿæˆçš„styleç›´æ¥ä»æºç çš„&lt;style&gt;ä¸­è·å–å³å¯ï¼Œç”¨æ­£åˆ™éªŒè¯å…·ä½“çš„å€¼å­˜ä¸å­˜åœ¨ã€‚</p><blockquote><p> ä¹‹å‰è€ƒè™‘æœ‰é”™ğŸ˜­ï¼Œä¾‹å­å¤ªç‰‡é¢ï¼Œä¸‹æ„è¯†è®¤ä¸ºæ˜¯â€œå­ç»çˆ¶ç›¸â€ï¼Œä»¥å€æ•°è·å–è‡ªç”Ÿä½ç½®ï¼Œå®é™…é”™è¯¯å¾ˆå¤§ï¼ï¼ï¼ï¼ï¼ï¼ã€‚</p></blockquote><p>çœ‹ä»¥ä¸‹ä¾‹å­ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/css-non-7.1.png" alt="CSSåçˆ¬-7.1"></p><p>ç°åœ¨æ‰è®¤è¯†åˆ°ç›¸å¯¹å®šä½çš„é—®é¢˜ã€‚</p><p>ç°åœ¨å¼€å§‹é‡æ–°åˆ†æï¼š</p><ol><li>é¦–å…ˆå¾—è®¤è¯†åˆ°ï¼ŒdivåŒ…å«å››ä¸ªå­divå’ŒåŒ…å«ä¸‰ä¸ªå­divæ˜¯ç›¸åŒçš„ï¼ŒåŒºåˆ«ä»…æ˜¯å®ƒå­˜åœ¨<code>margin-right</code>å’Œ<code>opacity</code>çš„åŒºåˆ«ï¼ˆä¸ªäººè§‰å¾—ç­‰åŒäºï¼šdisplay: none;ï¼‰ï¼Œåªä¸è¿‡å¾—<mark class="hl-label green">æ³¨æ„</mark> è¿™ä¸ªé€æ˜å…ƒç´ çš„ä½ç½®ï¼Œæœ¬é¢˜ä¸­ä¸€ç›´éƒ½æ˜¯å¤„äºdivçš„ç¬¬ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸ä¼šå½±å“åˆ°<mark class="hl-label green">ä¹‹åä¸‰ä¸ªdivä¸ªé¡ºåºæ’åˆ—</mark> ã€‚</li></ol><p><img src="https://img.lsycai.top/glidedsky/css-non-7.2.png" alt="CSSåçˆ¬-7.2"></p><ol start="2"><li>è¿˜å‘ç°æœ‰çš„divï¼Œæœ‰position: relativeï¼Œæœ‰çš„divæ²¡æœ‰ã€‚</li></ol><p>è¿™æ˜¯éƒ½æœ‰çš„ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/css-non-7.3.png" alt="CSSåçˆ¬-7.3"></p><p>è¿™æ˜¯å­˜åœ¨æ²¡æœ‰çš„ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/css-non-7.4.png" alt="CSSåçˆ¬-7.4"></p><p>ç°åœ¨å¯ä»¥çœ‹å‡ºï¼šdiv.col-md-1çš„å­©å­divçš„é¡ºåºå°±æ˜¯åŸå§‹é¡ºåºï¼Œè¿™ä¸ªé¡ºåºåŠ ä¸Šposition: relative; left: xem ä¹‹åï¼Œå°±å˜ä¸ºäº†æ–°é¡ºåºï¼Œå½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸å­˜åœ¨position: relative æ ·å¼çš„å°±ä¿ç•™åŸä½ç½®ã€‚</p><ol start="3"><li>å­©å­ä¸º4ä¸ªdivçš„åŒç†ï¼Œç¬¬ä¸€ä¸ªdivå› ä¸ºæ˜¯éšå½¢çš„ï¼Œå½“ä½œæ²¡çœ‹è§å³å¯ï¼ŒåŒæ ·ä¹Ÿå½“3ä¸ªdivå¤„ç†ï¼Œ<mark class="hl-label blue">ä½†æ˜¯</mark> ï¼Œåœ¨éšå½¢å…ƒç´ ä¹‹åä½ç½®çš„å…ƒç´ å¾—ä½ç½®å¾—æå‰ä¸€ä¸ªã€‚ï¼ˆå¦‚æœå®ƒä¹‹å‰æœ‰2ä¸ªéšå½¢å…ƒç´ ï¼Œé‚£ä¹ˆå®ƒçš„indexä¹Ÿå¾—æå‰2ï¼Œè¿™æ‰æ˜¯æœ€åˆæ’é™¤éšå½¢å…ƒç´ ä¹‹åï¼Œè¯¥å…ƒç´ åº”è¯¥åœ¨çš„ä½ç½®ï¼‰ã€‚</li><li>ä¼ªå…ƒç´ é€‰æ‹©å™¨æƒ…å†µï¼š</li></ol><p><img src="https://img.lsycai.top/glidedsky/css-non-7.5.png" alt="CSSåçˆ¬-7.5"></p><mark class="hl-label green">è¡¥å……</mark> : è¿‡ç¨‹ä¸­æŠ¥é”™ï¼Œä¹‹åè¿˜å‘ç°äº†å€¼div.col-md-1çš„å­©å­å­˜åœ¨2ä¸ªçš„æƒ…å†µï¼Œéƒ½æ˜¯æœ‰æ•ˆæ•°å­—ï¼Œè¯·æ³¨æ„ã€‚<p><img src="https://img.lsycai.top/glidedsky/css-non-7.6.png" alt="CSSåçˆ¬-7.6"></p><blockquote><p>ä¿®æ­£ä»£ç </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">cssåçˆ¬-1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><br>env = Env()<br>env.login()<br>session = env.session<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦ä¸ºé€æ˜å…ƒç´ </span><br><span class="hljs-string">    clazz: è¯¥divçš„class</span><br><span class="hljs-string">    style: é¡µé¢æ€»styleå±‚å æ ·å¼è¡¨</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_opacity</span>(<span class="hljs-params">clazz, style</span>):<br>    opacity = re.search(clazz + <span class="hljs-string">&#x27; \\&#123; opacity:0 \\&#125;&#x27;</span>, style)<br>    <span class="hljs-keyword">return</span> opacity <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è§£æ div.col-md-1 è¿™ä¸ªdiv, è¿”å›çœŸå®æ•°æ®(çš„å­—ç¬¦ä¸²å½¢å¼)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_div</span>(<span class="hljs-params">div, style, test_text</span>):<br>    children = div.xpath(<span class="hljs-string">&#x27;./div&#x27;</span>)<br>    <span class="hljs-comment"># ä¼ªå…ƒç´ é€‰æ‹©å™¨æƒ…å†µ: å› ä¸ºé¡µé¢æ¯ä¸ªdivä¸­éƒ½æ˜¯è¦ä¹ˆåŒ…å«ä¸€ä¸ªæ•°å­—ã€è¦ä¹ˆä¸ºç©ºå€¼, æ‰€ä»¥xpath(&#x27;text()&#x27;)å¾—åˆ°çš„ç»“æœçš„åˆ—è¡¨é•¿åº¦æ— éå°±æ˜¯ 0æˆ–1, 0è¡¨ç¤ºæ²¡æœ‰å†…å®¹</span><br>    <span class="hljs-keyword">for</span> index, child <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(children):<br>        <span class="hljs-comment"># é•¿åº¦ä¸º0 è¯´æ˜è¿™ä¸ªdivå°±æ˜¯ &lt;div&gt;::before&lt;/div&gt;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(child.xpath(<span class="hljs-string">&#x27;./text()&#x27;</span>)) == <span class="hljs-number">0</span>:<br>            <span class="hljs-comment"># ä»styleæ ·å¼è¡¨ä¸­å°† child è¿™ä¸ªdivçš„classå€¼å¯¹åº”çš„ content ç»™å–å‡ºæ¥  å¦‚: UFihK6LyIh:before &#123; content:&quot;240&quot; &#125; å°†240æ‰¾å‡º</span><br>            <span class="hljs-keyword">return</span> re.search(child.attrib[<span class="hljs-string">&#x27;class&#x27;</span>] + <span class="hljs-string">&#x27;:before \\&#123; content:&quot;(\\d+)&quot; \\&#125;&#x27;</span>, style).group(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># æ¥ä¸‹æ¥æ˜¯å­©å­æœ‰3/4ä¸ªçš„å¤„ç† æ³¨æ„: åœ¨éšå½¢å…ƒç´ ä¹‹åå‡ºç°çš„divå…ƒç´ å®ƒçš„indexéƒ½å¾—å‡å»å®ƒä¹‹å‰éšå½¢å…ƒç´ å‡ºç°çš„ä¸ªæ•°, æ‰æ˜¯è¯¥divçš„åˆå§‹ä½ç½®</span><br>    opacity_count = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># resè£…æœ€ç»ˆç»“æœ æœ€å¤šä¹‹æ”¯æŒ4ä½æ•°å­—</span><br>    res = [-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>]<br>    <span class="hljs-comment"># indexèƒ½è®°å½•å½“å‰divåœ¨æºç ä¸­çš„ç´¢å¼•</span><br>    <span class="hljs-keyword">for</span> index, child <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(children):<br>        <span class="hljs-comment"># ç±»å</span><br>        clazz = child.attrib[<span class="hljs-string">&#x27;class&#x27;</span>]<br><br>        <span class="hljs-comment"># åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦ä¸ºé€æ˜å…ƒç´ </span><br>        <span class="hljs-keyword">if</span> is_opacity(clazz, style):<br>            opacity_count += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-comment"># éé€æ˜å…ƒç´ , å…ˆçœ‹æ˜¯å¦æœ‰position: relative</span><br>        relative = re.search(clazz + <span class="hljs-string">&#x27; \\&#123; position:relative \\&#125;&#x27;</span>, style)<br><br>        <span class="hljs-comment"># å½“å‰divçš„å€¼</span><br>        val = child.xpath(<span class="hljs-string">&#x27;./text()&#x27;</span>)[<span class="hljs-number">0</span>]<br>        <span class="hljs-comment"># ä¸å­˜åœ¨çš„è¯å®šä½, å°±æ˜¯åŸä½ç½®, ä½†æ˜¯å¾—åˆ¨å»éšè—å…ƒç´ ç«™çš„ä½ç½®</span><br>        <span class="hljs-keyword">if</span> relative <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            res[index - opacity_count] = val<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># å­˜åœ¨å®šä½å°±ä½¿ç”¨å½“å‰indexåŠ ä¸Šleft:xem çš„å€¼, å…ˆè·å–left:xem  æ³¨æ„search (:?)</span><br>            offset = re.search(clazz + <span class="hljs-string">&#x27; \\&#123; left:(-?\\d)em \\&#125;&#x27;</span>, style).group(<span class="hljs-number">1</span>)<br>            res[index + <span class="hljs-built_in">int</span>(offset) - opacity_count] = val<br><br>    <span class="hljs-comment"># try:</span><br>    r = <span class="hljs-string">&#x27;&#x27;</span>.join([i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res <span class="hljs-keyword">if</span> i != -<span class="hljs-number">1</span>])<br>    <span class="hljs-comment"># except Exception as e:</span><br>    <span class="hljs-comment">#     print(e)</span><br>    <span class="hljs-keyword">return</span> r<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–æ¯ä¸€é¡µæ•°å­—å’Œ</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_page_sum</span>(<span class="hljs-params">page_num</span>):<br>    url = <span class="hljs-string">f&quot;http://www.glidedsky.com/level/web/crawler-css-puzzle-1?page=<span class="hljs-subst">&#123;page_num&#125;</span>&quot;</span><br>    response = session.get(url, headers=env.headers)<br>    html = etree.HTML(response.text)<br><br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br>    <span class="hljs-comment"># æµè§ˆå™¨ä¸­ç”Ÿæˆçš„æ ·å¼</span><br>    style = html.xpath(<span class="hljs-string">&#x27;normalize-space(//style/text())&#x27;</span>)<br>    <span class="hljs-comment"># æ¯é¡µå’Œ</span><br>    page_total = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>        <span class="hljs-comment"># è§£ædiv</span><br>        page_total += <span class="hljs-built_in">int</span>(parse_div(div, style, response.text))<br>    <span class="hljs-keyword">return</span> page_total<br><br><br><span class="hljs-comment"># æ€»å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># å®šä¹‰å’Œ</span><br><span class="hljs-keyword">for</span> page_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):<br>    total += get_page_sum(page_num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰ <span class="hljs-subst">&#123;page_num&#125;</span> é¡µå’Œä¸º <span class="hljs-subst">&#123;total&#125;</span>&#x27;</span>)<br><br></code></pre></td></tr></table></figure><h1 id="é›ªç¢§å›¾åçˆ¬-1"><a href="#é›ªç¢§å›¾åçˆ¬-1" class="headerlink" title="é›ªç¢§å›¾åçˆ¬-1"></a>é›ªç¢§å›¾åçˆ¬-1</h1><p>é¡µé¢ç»“æ„å…¨æ˜¯ <code>div.col-md-1</code> ä¸­åŒ…å«2&#x2F;3ä¸ªdivï¼Œclasséƒ½æ˜¯éšæœºä¸² + â€˜ spriteâ€™ï¼Œ è€Œâ€™spriteâ€™è¿™ä¸ªæ ·å¼çš„<code>background-image: url()</code>åŒ…å«base64ä¸²ã€‚</p><p>å¤šåˆ·æ–°å‡ æ¬¡ç½‘é¡µå¯ä»¥å‘ç°æ¯æ¬¡é›ªç¢§å›¾ä¸­æ¯ä¸ªæ•°å­—å¤§å°æœ‰å·®å¼‚ï¼Œé‚£ä¹ˆå®ƒ<mark class="hl-label orange">background-position-x</mark> çš„å€¼å°±æœ‰ä¸€å®šå·®å¼‚ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°åŒä¸€ä¸ªæ•°å­—åç§»çš„â€™xâ€™å€¼ç›¸åŒï¼Œå¹¶ä¸”å› ä¸ºåŸå›¾ç‰‡ä¸­æ•°å­—éƒ½æ˜¯ä»å·¦åˆ°å³ä»å°åˆ°å¤§æ’åˆ—çš„ï¼Œæˆ‘ä»¬å¯ä»¥è·å–å½“å‰é¡µæ‰€æœ‰æºå¸¦â€™spriteâ€™æ ·å¼çš„divï¼Œæ¯ä¸€ä¸ªdivéƒ½æœ‰ä¸€ä¸ªéšæœºçš„classï¼Œå¦‚ â€˜qazâ€™ å®ƒçš„position-xä¸º-12ï¼Œâ€™wsxâ€™å®ƒçš„position-xä¸º-23ï¼Œâ€™edcâ€™çš„postion-xä¸º0ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;qaz&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-12</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;wsx&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-23</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;edc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br><span class="hljs-punctuation">&#125;</span><br>â†“<br><span class="hljs-punctuation">[</span> (<span class="hljs-string">&quot;qaz&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">-12</span>)<span class="hljs-punctuation">,</span> (<span class="hljs-string">&quot;wsx&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">-23</span>)<span class="hljs-punctuation">,</span> (<span class="hljs-string">&quot;edc&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span>) <span class="hljs-punctuation">]</span><br><br>d_order = sorted(å­—å…¸.items()<span class="hljs-punctuation">,</span>key=lambda x<span class="hljs-punctuation">:</span>x<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>reverse=True)<br>æˆ–è€…<br>åˆ—è¡¨.sort(key=lambda x<span class="hljs-punctuation">:</span>x<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> reverse=True)  # è¿™ä¸ªåˆ—è¡¨æ˜¯ä¸Šé¢ â†“ çš„é‚£ä¸ª<br></code></pre></td></tr></table></figure><p>å°†å€¼è¿›è¡Œé¡ºåºæ’åˆ—ï¼Œå¾—åˆ°</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">[</span> <span class="hljs-string">&quot;edc&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;qaz&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;wsx&quot;</span> <span class="hljs-punctuation">]</span><br>æˆ–è€…<br><span class="hljs-punctuation">[</span> (<span class="hljs-string">&quot;edc&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span>)<span class="hljs-punctuation">,</span> (<span class="hljs-string">&quot;qaz&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">-12</span>)<span class="hljs-punctuation">,</span> (<span class="hljs-string">&quot;wsx&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">-23</span>) <span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæ¥ä¸‹æ¥å†é¡ºåºè§£ææ¯ä¸ªdivæ—¶ï¼Œå°±èƒ½æ ¹æ®å®ƒçš„<strong>class</strong>æ‹¿åˆ°å¯¹åº”çš„<strong>æ•°å­—</strong>äº†ã€‚</p><blockquote><p>é¡ºåºæ’åˆ—å–ç´¢å¼•ä¸ºæ•°å­—çš„æ€ç»´å‡ºäº†ç‚¹é—®é¢˜ï¼Œå› ä¸ºä¹‹å‰åªæ³¨æ„åˆ°äº†ç›¸åŒæ•°å­—çš„ postion-x æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯æ²¡æ³¨æ„åˆ°å°½ç®¡ position-x æƒ³é€šäº†ï¼Œä½†æ˜¯å®ƒä»¬çš„ class ä¾æ—§ä¸æ˜¯åŒä¸€ä¸ªï¼ï¼ï¼</p></blockquote><p><img src="https://img.lsycai.top/glidedsky/sprite-non-8.1.png" alt="é›ªç¢§å›¾åçˆ¬-8.1"></p><p>é‡æ–°è€ƒè™‘å¦‚ä¸‹ç»“æ„ï¼ˆ<mark class="hl-label orange">qaz</mark> å’Œ<mark class="hl-label orange">rfv</mark> è‚¯å®šéƒ½ä»£è¡¨ä¸€ä¸ªæ•°å­—ï¼Œåªæ˜¯classä¸åŒï¼‰ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;qaz&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-12</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;wsx&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-23</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;edc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;rfv&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">-12</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ç›´æ¥æ„å»ºä¸Šè¿°å­—<mark class="hl-label green">æ³¨æ„</mark> å…¸å³å¯ã€‚</p><p>è¿™ç§æœç´¢position-xé€†åºæ’åˆ—ï¼Œæœ‰ä¸ªå·¨å¤§æ¼ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-8.2.png" alt="é›ªç¢§å›¾åçˆ¬-8.2"></p><blockquote><p>é”™è¯¯ä»£ç </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">çˆ¬è™«-é›ªç¢§å›¾-1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># è°ƒç”¨å°è£…çš„ç™»é™†ç¯å¢ƒ</span><br>env = Env()<br>session = env.login()<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">æºç ä¸­é€šè¿‡è§£æstyle, è¿”å›</span><br><span class="hljs-string">è¿”å›å€¼1: &#123; &quot;qaz&quot;: &quot;-12&quot;, &quot;wsx&quot;: &quot;0&quot;, &quot;rfv&quot;: &quot;-12&quot;, ...&#125;</span><br><span class="hljs-string">è¿”å›å€¼2: [ &quot;0&quot;, &quot;-12&quot; ]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_clazzs_num_dict</span>(<span class="hljs-params">style</span>):<br>    <span class="hljs-comment"># resç»“æ„å¦‚ä¸‹: [(&#x27;fDn6AFGqT&#x27;, &#x27;-23&#x27;), (&#x27;brq23DUc&#x27;, &#x27;-36&#x27;), ...]</span><br>    class_num_dict = re.findall(<span class="hljs-string">&#x27;.([0-9a-zA-Z]+) &#123; background-position-x:(-?\\d+)px &#125;&#x27;</span>, style)<br>    class_num_dict = <span class="hljs-built_in">dict</span>(class_num_dict)<br><br>    <span class="hljs-comment"># å¯¹numé€†åºæ’åº</span><br>    <span class="hljs-comment"># å…ˆå»é‡</span><br>    offset_list = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(class_num_dict.values()))<br>    <span class="hljs-comment"># å†æ ¹æ®offsetæ•°å€¼è¿›è¡Œæ’åº</span><br>    offset_list.sort(key=<span class="hljs-keyword">lambda</span> item: <span class="hljs-built_in">int</span>(item), reverse=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-built_in">print</span>(class_num_dict)<br>    <span class="hljs-built_in">print</span>(offset_list)<br><br>    <span class="hljs-keyword">return</span> class_num_dict, offset_list<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–æ¯ä¸€é¡µæ•°å­—å’Œ</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_page_sum</span>(<span class="hljs-params">page_num</span>):<br>    url = <span class="hljs-string">f&quot;http://www.glidedsky.com/level/web/crawler-sprite-image-1?page=<span class="hljs-subst">&#123;page_num&#125;</span>&quot;</span><br>    response = session.get(url, headers=env.headers)<br>    <span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>    html = etree.HTML(response.text)<br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span>*<span class="hljs-number">100</span>)<br>    <span class="hljs-built_in">print</span>(response.text)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span>*<span class="hljs-number">100</span>)<br><br>    <span class="hljs-comment"># cssæ ·å¼è¡¨å­—ç¬¦ä¸²</span><br>    style = html.xpath(<span class="hljs-string">&#x27;normalize-space(//style/text())&#x27;</span>)<br>    <span class="hljs-comment"># å¾—åˆ° class -&gt; num çš„å­—å…¸</span><br>    clazz_num_dict, offset_list = get_clazzs_num_dict(style)<br>    <span class="hljs-comment"># æ¯é¡µå’Œ</span><br>    page_total = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> div_col <span class="hljs-keyword">in</span> div_list:<br>        <span class="hljs-comment"># ä¸€ä¸ªdiv.col-md-1å†…æœ‰lengthä¸ªå­div(å³æ•°å­—æ˜¯lengthä½æ•°)</span><br>        length = <span class="hljs-built_in">len</span>(div_col)<br>        one = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, length):<br>            <span class="hljs-comment"># å¦‚class=&quot;Fp0PceYg sprite&quot; åº”è¯¥åªè¦Fp0PceYg</span><br>            clazz = div_col[i].attrib[<span class="hljs-string">&#x27;class&#x27;</span>]<br>            clazz = clazz[:clazz.index(<span class="hljs-string">&#x27; &#x27;</span>)]<br>            <span class="hljs-comment"># clazz_num_dict ä¸­, é”®ä¸ºclass, å€¼ä¸ºoffset</span><br>            offset = clazz_num_dict[clazz]<br>            <span class="hljs-comment"># ç™¾ä½ä¹˜100 åä½ä¹˜10 ä¸ªä½ä¹˜1</span><br>            one += offset_list.index(offset) * <span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, length-i-<span class="hljs-number">1</span>)<br><br>        <span class="hljs-comment"># åŠ è¿™ä¸€ä¸ªæ•°</span><br>        <span class="hljs-built_in">print</span>(one)<br>        page_total += one<br><br>    <span class="hljs-keyword">return</span> page_total<br><br><br><span class="hljs-comment"># æ€»å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># å®šä¹‰å’Œ</span><br><span class="hljs-comment"># for page_num in range(1, 1001):</span><br><span class="hljs-keyword">for</span> page_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>):<br>    total += get_page_sum(page_num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰ <span class="hljs-subst">&#123;page_num&#125;</span> é¡µå’Œä¸º <span class="hljs-subst">&#123;total&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><blockquote><p>æ‰€ä»¥è¯´æ˜ï¼šä¹‹å‰çš„æ€è·¯å…¨éƒ¨æœ‰é—®é¢˜ï¼Œå‚è€ƒç½‘ä¸Šè§£æ³•åï¼Œå‘ç°è¿˜æ˜¯å¾—å‡åŒ€åˆ‡å‰²å›¾ç‰‡åˆ’åˆ†æ¨ªå‘10ä¸ªåæ ‡èŒƒå›´ï¼Œåˆ†åˆ«è¡¨ç¤º[0 ,9]ï¼Œ</p><p>è¿™é‡Œèƒ½å–å·§å°±æ˜¯å°† <code>|position-x| * 10 / æ•´ä¸ªå›¾ç‰‡æ¨ªå‘å®½åº¦</code> å–æ•´å³ä¸ºæ•°å­—,æ³¨æ„å–æœ€æ¥è¿‘çš„æ•´æ•°(å¦‚3.2å–3, 3.8å–4)</p></blockquote><p>è¿™ä¸ªç®—å¼ä¾æ—§å­˜åœ¨é—®é¢˜,å› ä¸ºä¸åŒçš„å•ä½æ•°å­—è¿˜å­˜åœ¨ä¸€ä¸ªä¸åŒçš„å®½åº¦ï¼ï¼ï¼ï¼</p><p>ä»¥ä¸Šè¿™ä¸ªæ–¹æ³•æ˜¯é»˜è®¤å›¾ç‰‡ä¸­ä¸€ä¸²æ•°å­—åˆ’åˆ†æ¯”è¾ƒæ•´é½é‡‡ç”¨çš„ä¼°ç®—å½¢å¼ï¼Œå®é™…å¹¶ä¸å‡†ç¡®ã€‚</p><blockquote><p>ä¸‹é¢å‚è€ƒå¤§ä½¬ï¼ˆgithubæœç´¢&lt;!â€“swigï¿¼41â€“&gt;ï¼‰çš„åƒç´ æ³•ï¼Œç«–çº¿æ‰«æåˆ¤æ–­é»‘ç™½ï¼Œä»¥æ­¤åˆ’åˆ†å‡ºæ¯ä¸ªæ•°å­—åæ ‡èŒƒå›´ã€‚</p></blockquote><p>ä¸ªäººåˆ†æï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-8.3.png" alt="é›ªç¢§å›¾åçˆ¬-8.3"></p><p>å°†æ–­ç‚¹å½¢æˆåˆ—è¡¨ï¼ˆé•¿åº¦ä¸º11ï¼ŒåŒ…æ‹¬å¼€å§‹ã€ç»“å°¾ï¼‰ï¼Œé‚£ä¹ˆæ¯é¡ºåº2ä¸ªåˆ—è¡¨å…ƒç´ å°±èƒ½å½¢æˆ10ä¸ªåŒºé—´ï¼Œé‚£ä¹ˆçœŸå®çš„æ•°å­—å°±å’Œè¿™ä¸ªåˆ—è¡¨çš„ç´¢å¼•äº§ç”Ÿè”ç³»äº†ã€‚</p><p>é‡ç‚¹åœ¨äºå¦‚ä½•æ‰«æåˆ†å‰²ï¼šéå†æ¨ªåæ ‡ï¼Œå¾ªç¯å†…éå†çºµåæ ‡ï¼Œéå†çºµåæ ‡è¿‡ç¨‹å‡ºç°é»‘ç‚¹å³è¡¨ç¤ºå½“å‰çš„æ¨ªåæ ‡å°±æ˜¯<code>æ•°å­—çš„å¼€å§‹</code>ï¼ˆé™¤0ä»¥å¤–ï¼Œå› ä¸º 0 æ€»æ˜¯ä» position-x: 0px å¼€å§‹çš„ï¼‰ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-8.4.png" alt="é›ªç¢§å›¾åçˆ¬-8.4"></p><p>å¦‚æ­¤èƒ½å¾—åˆ°10ä¸ªposition-xçš„å€¼ï¼Œåˆ—è¡¨è¿½åŠ ä¸€ä¸ªå›¾ç‰‡å®½åº¦å³ä¸ºç»“æœï¼Œå°±åˆæˆä¸ºæ€»çš„åŒ…å«10ä¸ªåŒºé—´çš„åˆ¤å®šåˆ—è¡¨ã€‚</p><p>ä¹‹å‰çš„åˆ’åˆ†æ–¹å¼æœ‰é”™ï¼Œåº”è¯¥åœ¨0ç»“æŸçš„æ—¶å€™å°±å¼€å§‹åˆ†éš”ï¼Œå› ä¸ºæ­¤æ—¶0å·²ç»ä¸ä¼šå†å‡ºç°äº†ã€‚</p><p>ç»“åˆé¡µé¢åˆ†æï¼š0åç§»ä¸º <mark class="hl-label orange">-7</mark>  æ—¶ï¼Œ</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-8.5.png" alt="é›ªç¢§å›¾åçˆ¬-8.5"></p><p>0åç§»ä¸º <mark class="hl-label orange">-8</mark>  æ—¶ï¼Œå°±å·²ç»æ¶ˆå¤±ï¼Œ0éƒ½å·²ç»æ¶ˆå¤±äº†ï¼Œä¹Ÿå°±ä¸å¯èƒ½ç®—åœ¨0çš„èŒƒå›´å†…äº†ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-8.6.png" alt="é›ªç¢§å›¾åçˆ¬-8.6"></p><p>æ‰€ä»¥åº”å½“æŒ‰ä¸‹é¢è¿™ç§æ–¹æ³•åˆ’åˆ†ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-8.7.png" alt="é›ªç¢§å›¾åçˆ¬-8.7"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">çˆ¬è™«-é›ªç¢§å›¾-1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> io<br><br><span class="hljs-comment"># è°ƒç”¨å°è£…çš„ç™»é™†ç¯å¢ƒ</span><br>env = Env()<br>session = env.login()<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">ç”Ÿæˆåˆ†éš”åˆ—è¡¨</span><br><span class="hljs-string">    å¦‚: [-1, 8, 19, 31, 43, 54, 66, 79, 93, 104, 117]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_split_list</span>(<span class="hljs-params">style</span>):<br>    split = []<br>    <span class="hljs-comment"># è·å–å›¾ç‰‡çš„å°ºå¯¸</span><br>    base64_bytes = base64.b64decode(re.search(<span class="hljs-string">&#x27;base64,(.*?)\&quot;&#x27;</span>, style).group(<span class="hljs-number">1</span>))<br>    fio = io.BytesIO(base64_bytes)<br>    img = Image.<span class="hljs-built_in">open</span>(fio)<br>    <span class="hljs-comment"># è·å–åƒç´ é›†</span><br>    pixels = img.load()<br>    <span class="hljs-comment"># å‰ä¸€åˆ—ä¸Š å…¨ç™½</span><br>    last_x_all_white = <span class="hljs-literal">True</span><br>    <span class="hljs-comment"># x è¡¨ç¤ºä»å·¦åˆ°å³</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img.width):<br>        <span class="hljs-comment"># å½“å‰åˆ—å…¨ä¸ºç™½è‰²</span><br>        current_x_all_white = <span class="hljs-literal">True</span><br>        <span class="hljs-comment"># y è¡¨ç¤ºä»ä¸Šåˆ°ä¸‹</span><br>        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img.height):<br>            <span class="hljs-comment"># print(f&#x27;&#123;x,y&#125;: &#x27;, pixels[x, y])</span><br>            <span class="hljs-comment"># rgbå’Œç­‰äº255*3, åˆ™ä¸ºç™½è‰², ä¸ç­‰åˆ™ä¸ä¸ºç™½è‰²</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span>(pixels[x, y][:<span class="hljs-number">3</span>]) != <span class="hljs-number">255</span> * <span class="hljs-number">3</span>:<br>                <span class="hljs-comment"># å½“å‰åˆ—å­˜åœ¨ éç™½è‰²</span><br>                current_x_all_white = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br><br>        <span class="hljs-comment"># ä¸€åˆ—ç»“æŸ è‹¥current_x_all_whiteè¿˜ä¸ºTrue é‚£ä¹ˆè¯´æ˜å½“å‰åˆ—å…¨ä¸ºç™½è‰²</span><br>        <span class="hljs-keyword">if</span> current_x_all_white:<br>            <span class="hljs-comment"># å½“å‰åˆ—å…¨ç™½è‰², å¹¶ä¸”ä¸Šä¸€åˆ—å­˜åœ¨é»‘</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> last_x_all_white:<br>                split.append(x)<br><br>        <span class="hljs-comment"># è¿›è¡Œä¸‹ä¸€åˆ—ä¹‹å‰ last_x_all_whiteå°±å¾—æ ¹æ®å½“å‰åˆ—é‡æ–°èµ‹å€¼</span><br>        last_x_all_white = current_x_all_white<br><br>    <span class="hljs-comment"># å¼€å¤´æ’å…¥-1 å› ä¸ºåªè®°å½•äº†0çš„ç»“æŸ æ²¡æœ‰è®°å½•å¼€å§‹</span><br>    split.insert(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>)<br>    <span class="hljs-comment"># èµ‹å€¼æœ€åä¸€ä¸ªä¸ºå›¾ç‰‡å®½åº¦</span><br>    split[<span class="hljs-built_in">len</span>(split) - <span class="hljs-number">1</span>] = img.width<br><br>    <span class="hljs-keyword">return</span> split<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">æºç ä¸­é€šè¿‡è§£æstyle, æ„å»º class -&gt; offset </span><br><span class="hljs-string">è¿”å›å€¼ç»“æ„: &#123; &quot;qaz&quot;: &#x27;-12&#x27;, &quot;wsx&quot;: &#x27;0&#x27;, &quot;rfv&quot;: &#x27;-12&#x27;, ...&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_clazzs_num_dict</span>(<span class="hljs-params">style</span>):<br>    <span class="hljs-comment"># findallç»“æ„å¦‚ä¸‹: [(&#x27;qaz&#x27;, &#x27;-12&#x27;), (&#x27;wsx&#x27;, &#x27;0&#x27;), (&#x27;rfv&#x27;: &#x27;-12&#x27;) ...]</span><br>    <span class="hljs-comment"># ä½¿ç”¨dictæ„å»ºå¦‚ä¸‹å­—å…¸ &#123; &quot;qaz&quot;: &quot;-12&quot;, &quot;wsx&quot;: &quot;0&quot;, &quot;rfv&quot;: &quot;-12&quot;, ...&#125;</span><br>    class_num_dict = <span class="hljs-built_in">dict</span>(re.findall(<span class="hljs-string">&#x27;.([0-9a-zA-Z]+) &#123; background-position-x:(-?\\d+)px &#125;&#x27;</span>, style))<br>    <span class="hljs-comment"># å°†å€¼è½¬ä¸ºint å¹¶å–ç»å¯¹å€¼</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> class_num_dict:<br>        class_num_dict[_] = <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(class_num_dict[_]))<br>    <span class="hljs-keyword">return</span> class_num_dict<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">è·å–æ¯ä¸€é¡µæ•°å­—å’Œ</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_page_sum</span>(<span class="hljs-params">page_num</span>):<br>    url = <span class="hljs-string">f&quot;http://www.glidedsky.com/level/web/crawler-sprite-image-1?page=<span class="hljs-subst">&#123;page_num&#125;</span>&quot;</span><br>    response = session.get(url, headers=env.headers)<br>    <span class="hljs-comment"># è·å–æ¯ä¸€ä¸ªæ•°å­—æ¡†</span><br>    html = etree.HTML(response.text)<br>    div_list = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>    <span class="hljs-comment"># cssæ ·å¼è¡¨å­—ç¬¦ä¸²</span><br>    style = html.xpath(<span class="hljs-string">&#x27;normalize-space(//style/text())&#x27;</span>)<br>    <span class="hljs-comment"># å¾—åˆ° class -&gt; offset çš„å­—å…¸</span><br>    class_num_dict = get_clazzs_num_dict(style)<br>    <span class="hljs-comment"># å¾—åˆ°åˆ†éš”åˆ—è¡¨</span><br>    split_list = get_split_list(style)<br>    <span class="hljs-comment"># æ¯é¡µå’Œ</span><br>    page_total = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> div_col <span class="hljs-keyword">in</span> div_list:<br>        <span class="hljs-comment"># ä¸€ä¸ªæ•°åŒ…å«å¤šå°‘ä½</span><br>        length = <span class="hljs-built_in">len</span>(div_col)<br>        num = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, length):<br>            <span class="hljs-comment"># å¦‚class=&quot;Fp0PceYg sprite&quot; åº”è¯¥åªè¦Fp0PceYg</span><br>            clazz = div_col[_].attrib[<span class="hljs-string">&#x27;class&#x27;</span>]<br>            clazz = clazz[:clazz.index(<span class="hljs-string">&#x27; &#x27;</span>)]<br>            <span class="hljs-comment"># clazz_num_dict ä¸­, é”®ä¸ºclass, å€¼ä¸ºåç§»</span><br>            offset = class_num_dict[clazz]<br>            <span class="hljs-comment"># è·å¾—çœŸå®æ•°å­—n</span><br>            <span class="hljs-keyword">for</span> index, split <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(split_list):<br>                <span class="hljs-comment"># å½“offsetä¸º0 splitä¸º-1 è¿™æ‰èƒ½åˆ¤æ–­æˆåŠŸ</span><br>                <span class="hljs-keyword">if</span> offset &lt; split:<br>                    n = index - <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">break</span><br>            num += n * <span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, length - _ - <span class="hljs-number">1</span>)<br><br>        <span class="hljs-comment"># åŠ è¿™ä¸€ä¸ªæ•°, æ¯é¡µæœ‰12ä¸ªæ•°å˜›</span><br>        page_total += num<br><br>    <span class="hljs-keyword">return</span> page_total<br><br><br><span class="hljs-comment"># æ€»å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># å®šä¹‰å’Œ</span><br><span class="hljs-keyword">for</span> page_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):<br>    total += get_page_sum(page_num)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰ <span class="hljs-subst">&#123;page_num&#125;</span> é¡µå’Œä¸º: <span class="hljs-subst">&#123;total&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="çˆ¬è™«-éªŒè¯ç -1"><a href="#çˆ¬è™«-éªŒè¯ç -1" class="headerlink" title="çˆ¬è™«-éªŒè¯ç -1"></a>çˆ¬è™«-éªŒè¯ç -1</h1><p>åˆ†æï¼š</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.1.png" alt="éªŒè¯ç -9.1"></p><p><img src="https://img.lsycai.top/glidedsky/veri-9.2.png" alt="éªŒè¯ç -9.2"></p><p>æ»‘åŠ¨æŒ‰é’®åº”è¯¥å³ç§»çš„è·ç¦»å¾—åˆ°äº†ï¼Œç›´æ¥æ“ä½œæ»‘åŠ¨æŒ‰é’®å³ç§»ï¼Œå³å¯å®Œæˆè¯¥æ»‘åŠ¨éªŒè¯ã€‚</p><p>éœ€è¦æ³¨æ„ï¼ŒéªŒè¯æ¡†æ˜¯<code>iframe</code>æ ‡ç­¾ï¼Œéœ€è¦ <mark class="hl-label orange">driver.switch_to.frame(frame_element)</mark>  æ“ä½œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.switch_to.frame(iframe_element) <span class="hljs-comment"># è½¬å‘åˆ°è¯¥frameä¸­</span><br><br><span class="hljs-string">&quot;&quot;&quot;æ“ä½œframeå¤–è¾¹çš„å…ƒç´ éœ€è¦åˆ‡æ¢å‡ºå»&quot;&quot;&quot;</span><br>windows = driver.window_handles<br>driver.switch_to.window(windows[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><p>æ³¨æ„å›¾ç‰‡è¿˜åšäº†å¹²æ‰°å¤„ç†ï¼šå®¹æ˜“çœ‹å‡ºçš„æœ‰å››è§’ã€ä¸Šæ–¹</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.3.png" alt="éªŒè¯ç -9.3"></p><p><img src="https://img.lsycai.top/glidedsky/veri-9.4.png" alt="éªŒè¯ç -9.4"></p><p>ç„¶åå°±å¾—ç»™ä¸ªé˜ˆå€¼ï¼Œçœ‹ä¸€åˆ—æœ‰å¤šå°‘ä¸ªä¸åŒçš„åƒç´ ç‚¹ä»¥ä¸Šï¼Œæ‰ç®—åˆ°äº†å‡¹é™·å—ã€‚</p><p>ç»è¿‡æµ‹è¯•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ç¬¬ 0 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 39<br>ç¬¬ 1 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 40<br>ç¬¬ 2 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 39<br>ç¬¬ 3 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 40<br>ç¬¬ 4 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 39<br>ç¬¬ 5 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 39<br>ç¬¬ 6 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 36<br>ç¬¬ 7 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 26<br>ç¬¬ 8 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 25<br>ç¬¬ 9 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 37<br>.<br>.<br>.<br>ç¬¬ 204 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 23<br>ç¬¬ 205 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 22<br>ç¬¬ 206 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 23<br>ç¬¬ 207 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 51<br>ç¬¬ 208 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 49<br>ç¬¬ 209 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 39<br>ç¬¬ 210 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 41<br>ç¬¬ 211 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 40<br>ç¬¬ 212 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 40<br>ç¬¬ 213 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 38<br>ç¬¬ 214 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 39<br><br>.<br>.<br>.<br>ç¬¬ 399 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 81<br>ç¬¬ 400 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 61<br>ç¬¬ 401 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 16<br>ç¬¬ 402 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 17<br>ç¬¬ 403 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 16<br>ç¬¬ 404 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 17<br>ç¬¬ 405 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 16<br>ç¬¬ 406 åˆ—åƒç´ ç‚¹å·®å¼‚ä¸º 17<br><br></code></pre></td></tr></table></figure><p>è¯´æ˜æ•´ä¸ªå›¾ç‰‡éƒ½æ˜¯åšäº†æ··æ·†å¤„ç†çš„ï¼ï¼ï¼</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.5.png" alt="éªŒè¯ç -9.5"></p><p>åˆ¤æ–­ç¼ºå£çš„ç­–ç•¥ï¼š</p><p>æœ€å¼€å§‹æ˜¯æ‰“ç®—åˆ°äº†æŸä¸€åˆ—ï¼Œåƒç´ å·®å¼‚ä¸ªæ•°å‰§å¢ï¼Œå¹¶ä¸”åœ¨æ¥ä¸‹æ¥10åˆ—ä¸­ä¿æŒåƒç´ å·®å¼‚ç‚¹è¶…è¿‡100ï¼Œé‚£ä¹ˆåˆ¤æ–­è¿™ä¸ªå‰§å¢åˆ—å°±æ˜¯å‡¹é™·å›¾çš„å¼€å§‹ã€‚</p><blockquote><p>ä½†æ˜¯åæ¥å‘ç°ï¼Œä¸å¤§è¡Œï¼ï¼å›¾ç‰‡çš„æ··æ·†åšçš„å¤ªå¥½äº†â€¦â€¦</p></blockquote><p>åæ¥é‡‡ç”¨åœ¨rgbä¸‰ä¸ªæ•°ç¦»ï¼ˆ255ï¼Œ255ï¼Œ255ï¼‰ç›¸å·®éƒ½ä»…å°äº10ï¼Œå¹¶ä¸”ä¸€åˆ—ä¸­æœ‰40ï¼ˆå› ä¸ºæœ‰æ—¶å‡¹é™·å›¾å·¦ä¸­éƒ¨æœ‰ç¼ºå£ï¼Œæ²¡ç¼ºå£çš„è¯è¾¾åˆ°50ä¸ªåº”è¯¥æ²¡é—®é¢˜ï¼‰ä¸ªè¿™æ ·çš„åƒç´ ç‚¹ä»¥ä¸Šï¼Œåˆ¤æ–­è¿™åˆ—ä¸ºå‡¹é™·å›¾çš„å¼€å§‹ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.6.png" alt="éªŒè¯ç -9.6"></p><blockquote><p>åæ¥ç­–ç•¥åˆæ¢æˆäº†</p><p>åæ¥é‡‡ç”¨åœ¨rgbä¸‰ä¸ªæ•°ç¦»ï¼ˆ255ï¼Œ255ï¼Œ255ï¼‰ç›¸å·®éƒ½å¤§äº50æ—¶ï¼Œè®¤å®šè¿™å°±æ˜¯å‡¹é™·å—å¼€å§‹å¾—ä½ç½®ï¼ï¼ï¼</p></blockquote><p>ç¡®å®šseleniumè·å–çš„webelementå¯¹è±¡çš„åæ ‡å±æ€§æ—¶ï¼Œå‘ç°æ€ä¹ˆéƒ½å¯¹ä¸ä¸Šå·ï¼Œæ‰€ä»¥æ‰æœ‰æ¥ä¸‹æ¥çš„æµ‹è¯•seleniumçš„locationï¼ˆxå’Œyå€¼ï¼‰ï¼š</p><p>è°ƒè¯•ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.7.png" alt="éªŒè¯ç -9.7"></p><p>formåæ ‡ä¸ºï¼ˆ298ï¼Œ212ï¼‰ï¼Œä½†æ˜¯åœ¨æ²¡è°ƒæ•´ä¸‹é¢è¿™ä¸ªè®¾ç½®ä¹‹å‰æ€»æ˜¯å¯¹ä¸ä¸Šå·ï¼ï¼ï¼</p><p>æ³¨æ„çœ¼è§‚æµè§ˆå™¨å¤šå®½çš„æ—¶å€™ï¼Œä¸€å®šè¦æŠŠwin10æ˜¾ç¤ºè®¾ç½®ä¸º100%</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.8.png" alt="éªŒè¯ç -9.8"></p><p>è°ƒæ•´ä¹‹åï¼Œèƒ½å¯¹ä¸Šå·äº†ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.9.png" alt="éªŒè¯ç -9.9"></p><p>æ¥ä¸‹æ¥ç¡®ä¿ä»£ç ä¸­æµ‹é‡çš„è·ç¦»éƒ½æ˜¯å¯¹çš„ï¼Œåœ¨ä»¥ä¸Šæ˜¾ç¤ºè®¾ç½®è®¾ç½®ä¸º100%ï¼ï¼ï¼ä¹‹åè¿›è¡Œæµ‹é‡ã€‚</p><p>æ»‘å—ä½ç½®ï¼šxåç§»æ˜¯36</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.10.png" alt="éªŒè¯ç -9.10"></p><p>ä¸‹é¢æ˜¯iframeçš„èŒƒå›´ï¼šï¼ˆå›¾ä¸­ç™½è‰²æ¡†æ˜¯æˆ‘ç”¨snipasteæˆªå‡ºçš„ <code>36*89</code> çš„çŸ©å½¢ï¼‰</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.11.png" alt="éªŒè¯ç -9.11"></p><p>ä¸‹é¢æ˜¯å›¾ç‰‡çš„èŒƒå›´ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.12.png" alt="éªŒè¯ç -9.12"></p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—å‡ºï¼Œåœ¨è¿™é‡Œå¾—å‡ºçš„locationï¼Œæ˜¯ç›¸å¯¹äºiframeæœ¬èº«çš„ï¼ï¼ï¼</p><p>è¿˜è®°å¾—ä¹‹å‰åˆ†æçš„è¿™ä¸ªå›¾ï¼Ÿ</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.13.png" alt="éªŒè¯ç -9.13"></p><p>ä½†ç”±äºå›¾ç‰‡è¿˜æœ‰ä¸ªé€æ˜å››å‘¨ï¼Œè¿™ä¸ªæ¨ç†è¦å‘ç”Ÿå˜åŒ–ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.14.png" alt="éªŒè¯ç -9.14"></p><p>æ»‘å—ç›¸å¯¹å›¾ç‰‡çš„åç§»åº”è¯¥æ˜¯ï¼šx + x2 - x3</p><p>xï¼šå›¾ç‰‡ç›¸å¯¹iframeçš„x</p><p>x2ï¼šæ»‘å—å›¾ç‰‡çš„é€æ˜å››å‘¨å®½åº¦ï¼ˆå¤§æ¦‚æœ‰11.5ï¼‰</p><p>è¿™é‡Œx2å®ƒåŸå›¾æ˜¯136çš„ï¼Œç°åœ¨æµè§ˆå™¨ä¸­æ˜¯68çš„ï¼ŒåŸå›¾å››å‘¨å®½åº¦ä¸º23ï¼ŒæŒ‰æ¯”ä¾‹è®¡ç®—ï¼Œæµè§ˆå™¨ä¸­å››å‘¨å®½åº¦ä¸ºï¼š68*23-136&#x3D;11.5</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.15.png" alt="éªŒè¯ç -9.15"></p><p>x3ï¼šå¤§çš„éªŒè¯å›¾ç‰‡ç›¸å¯¹iframeæœ‰ä¸ªpaddingï¼ˆå¤§æ¦‚æœ‰9.6ï¼‰</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.16.png" alt="éªŒè¯ç -9.16"></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ‹¿åˆ°æ»‘å—çš„location[â€˜xâ€™]åç›´æ¥å‡2å³å¯ã€‚</p><p>ç»¿çº¿çš„è·ç¦»ï¼ˆå°±æ˜¯ç¼ºå£ç›¸å¯¹äºå¤§å›¾ç‰‡çš„xä½ç½®ï¼‰ï¼šå› ä¸ºè·å–çš„é“¾æ¥çš„å›¾ç‰‡ï¼Œåˆ†è¾¨ç‡æ˜¯å®é™…æ˜¾ç¤ºçš„2å€ï¼Œæ‰€ä»¥å¾—åˆ°ç»¿çº¿ä¹‹é—´çš„è·ç¦»è¿˜å¾—é™¤ä»¥2ã€‚</p><p>seleniumå­˜åœ¨ç‚¹é—®é¢˜ï¼Œä¸ªäººä¿®æ­£ï¼Œä¸ç„¶æ»‘åŠ¨å—ç§»åŠ¨å¾—å¾ˆæ…¢ï¼ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">C:\Users\L\AppData\Local\Programs\Python\Python37\Lib\site-packages\selenium\webdriver\common\actions<br></code></pre></td></tr></table></figure><p><img src="https://img.lsycai.top/glidedsky/veri-9.17.png" alt="éªŒè¯ç -9.17"></p><p>æˆåŠŸçš„æ ‡å¿—ï¼šå­˜åœ¨ <code>show-success</code> çš„classçš„divå‡ºç°ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.18.png" alt="éªŒè¯ç -9.18"></p><blockquote><p>ä»£ç </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">çˆ¬è™«-éªŒè¯ç -1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> ActionChains<br><span class="hljs-keyword">from</span> selenium.webdriver.support.wait <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> EC<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> random<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SeleniumEnv</span>(<span class="hljs-title class_ inherited__">object</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.driver_path = <span class="hljs-string">&#x27;D:\\driver\\89.0\\chromedriver.exe&#x27;</span><br>        self.url = <span class="hljs-string">&#x27;http://www.glidedsky.com/level/web/crawler-captcha-1?page=&#x27;</span><br><br>        self.driver = webdriver.Chrome(self.driver_path)<br>        <span class="hljs-comment"># å‚æ•°10è¡¨ç¤ºæœ€é•¿ç­‰å¾…10ç§’, å‚æ•°0.5è¡¨ç¤º0.5ç§’æ£€æŸ¥ä¸€æ¬¡è§„å®šçš„æ ‡ç­¾æ˜¯å¦å­˜åœ¨</span><br>        self.wait = WebDriverWait(self.driver, <span class="hljs-number">2</span>, <span class="hljs-number">0.5</span>)<br><br>    <span class="hljs-comment"># ç™»é™†</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># ç™»é™†</span><br>        self.driver.get(<span class="hljs-string">&quot;http://www.glidedsky.com/login&quot;</span>)<br>        <span class="hljs-comment"># æœ€å¤§åŒ–çª—å£</span><br>        self.driver.maximize_window()<br>        self.driver.find_element_by_id(<span class="hljs-string">&#x27;email&#x27;</span>).send_keys(<span class="hljs-string">&#x27;ls1229344939@163.com&#x27;</span>)<br>        self.driver.find_element_by_id(<span class="hljs-string">&#x27;password&#x27;</span>).send_keys(<span class="hljs-string">&#x27;lovenowhyly0&#x27;</span>)<br>        self.driver.find_element_by_class_name(<span class="hljs-string">&#x27;btn-primary&#x27;</span>).click()<br>        time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># è·å–æ»‘åŠ¨æŒ‰é’®å¯¹è±¡</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_slide_button</span>(<span class="hljs-params">self</span>):<br>        time.sleep(<span class="hljs-number">1</span>)<br>        btn = self.driver.find_element_by_id(<span class="hljs-string">&#x27;slideBlock&#x27;</span>)<br>        <span class="hljs-keyword">return</span> btn<br><br>    <span class="hljs-comment"># è·å¾—åŸå›¾å’Œå‡¹é™·å›¾çš„urlå…ƒç»„</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_origin_cover_image</span>(<span class="hljs-params">self</span>):<br>        time.sleep(<span class="hljs-number">1</span>)<br>        slide_bg = self.driver.find_element_by_id(<span class="hljs-string">&#x27;slideBg&#x27;</span>)<br>        <span class="hljs-comment"># æµ‹è¯•(é“¾æ¥æ€»æ˜¯ä¸ºç©º...)</span><br>        <span class="hljs-comment"># print(&#x27;slide_bg: &#x27;, slide_bg)</span><br>        cover_url = slide_bg.get_attribute(<span class="hljs-string">&#x27;src&#x27;</span>)<br>        <span class="hljs-comment"># print(&#x27;property:&#x27;, cover_url)</span><br>        origin_url = cover_url.replace(<span class="hljs-string">&#x27;img_index=1&#x27;</span>, <span class="hljs-string">&#x27;img_index=0&#x27;</span>)<br>        <span class="hljs-comment"># print(&#x27;åŸæ¥: &#x27;, origin_url)</span><br>        <span class="hljs-comment"># print(&#x27;è¦†ç›–: &#x27;, cover_url)</span><br>        <span class="hljs-keyword">return</span> origin_url, cover_url<br><br>    <span class="hljs-comment"># åˆ¤æ–­2ä¸ªåƒç´ ç‚¹ ä¸åŒè¿”å›True</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">point_diff</span>(<span class="hljs-params">self, origin_pixel, cover_pixel, threshold</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">abs</span>(origin_pixel[<span class="hljs-number">0</span>] - cover_pixel[<span class="hljs-number">0</span>]) &gt; threshold \<br>               <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(origin_pixel[<span class="hljs-number">1</span>] - cover_pixel[<span class="hljs-number">1</span>]) &gt; threshold \<br>               <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(origin_pixel[<span class="hljs-number">2</span>] - cover_pixel[<span class="hljs-number">2</span>]) &gt; threshold<br><br>    <span class="hljs-comment"># å¯¹æ¯”åŸå›¾å’Œå‡¹é™·å›¾, è·å–å‡¹é™·å›¾ç›¸å¯¹ç›¸å¯¹æ•´ä¸ªå›¾ç‰‡çš„xåç§»é‡</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_offset_cover</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># åˆ†åˆ«æ˜¯åŸå›¾å’Œå‡¹é™·å›¾çš„url</span><br>        origin_url, cover_url = self.get_origin_cover_image()<br>        <span class="hljs-comment"># è¯·æ±‚</span><br>        origin_img = Image.<span class="hljs-built_in">open</span>(io.BytesIO(requests.get(origin_url).content))<br>        origin_pixels = origin_img.load()<br>        <span class="hljs-comment"># cover_pixels = Image.open(io.BytesIO(requests.get(cover_url).content)).load()</span><br>        cover_img = Image.<span class="hljs-built_in">open</span>(io.BytesIO(requests.get(cover_url).content))<br>        cover_pixels = cover_img.load()<br><br>        width = cover_img.width<br>        height = cover_img.height<br>        <span class="hljs-comment"># åŸå›¾æ˜¯680*390 æµè§ˆå™¨å®é™…æ˜¾ç¤ºæœ‰340*195å·¦å³ æœ€ååç§»è¦é™¤ä»¥2 (680/340)</span><br>        <span class="hljs-comment"># é˜ˆå€¼</span><br>        threshold = <span class="hljs-number">50</span><br>        <span class="hljs-comment"># å–å·§ å› ä¸ºè§‚å¯Ÿåˆ°çš„ç»“æœä¸­ å‡¹é™·å›¾åœ¨çš„åƒç´ éƒ½å¤§äºäº†400åƒç´ </span><br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">350</span>, width):<br>            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, height):<br>                <span class="hljs-comment"># é˜ˆå€¼è®¾ç½®ä¸º50å§...  r,g,bå€¼éƒ½ç›¸å·®50ä»¥ä¸Š</span><br>                <span class="hljs-keyword">if</span> self.point_diff(origin_pixels[x, y], cover_pixels[x, y], threshold):<br>                    <span class="hljs-comment"># print(f&#x27;åŸå›¾åƒç´ ç‚¹: &#123;origin_pixels[x, y]&#125;, å‡¹é™·å›¾åƒç´ ç‚¹: &#123;cover_pixels[x, y]&#125;&#x27;)</span><br>                    <span class="hljs-keyword">return</span> x / <span class="hljs-number">2</span><br><br>    <span class="hljs-comment"># è·å–æ»‘å—ç›¸å¯¹æ•´ä¸ªå›¾ç‰‡çš„xåç§»é‡</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_offset_slider</span>(<span class="hljs-params">self</span>):<br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># self.wait.until(EC.presence_of_element_located((By.ID, &#x27;slideBlock&#x27;)))</span><br>        slide_block = self.driver.find_element_by_id(<span class="hljs-string">&#x27;slideBlock&#x27;</span>)<br>        <span class="hljs-comment"># å‡2 ç›¸å…³è¯´æ˜çœ‹ç¬”è®°</span><br>        slider_x = <span class="hljs-built_in">int</span>(slide_block.location[<span class="hljs-string">&#x27;x&#x27;</span>]) - <span class="hljs-number">2</span><br>        <span class="hljs-comment"># print(slider_x)</span><br>        <span class="hljs-keyword">return</span> slider_x<br><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        éªŒè¯ç éªŒè¯è¿‡ç¨‹</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkout</span>(<span class="hljs-params">self, page_num</span>):<br>        <span class="hljs-keyword">try</span>:<br>            time.sleep(<span class="hljs-number">1</span>)<br>            self.driver.get(self.url + <span class="hljs-built_in">str</span>(page_num))<br>            <span class="hljs-comment"># æ³¨æ„ï¼ï¼ï¼ éªŒè¯æ¨¡å—åœ¨iframeæ ‡ç­¾ä¸­</span><br>            <span class="hljs-comment"># å“ªä¸ªæ‰¾ä¸åˆ° å°±åœ¨å“ªä¸ªå‰é¢åŠ sleep ï¼ï¹ï¼œ</span><br>            time.sleep(<span class="hljs-number">1</span>)<br>            <span class="hljs-comment"># self.wait.until(EC.presence_of_element_located((By.ID, &#x27;tcaptcha_iframe&#x27;)))</span><br>            iframe = self.driver.find_element_by_id(<span class="hljs-string">&#x27;tcaptcha_iframe&#x27;</span>)<br>            self.driver.switch_to.frame(iframe)<br>            <span class="hljs-comment"># è·å¾—æ»‘åŠ¨æŒ‰é’®</span><br>            slide_btn = self.get_slide_button()<br>            <span class="hljs-comment"># è·å–æ»‘å—ç›¸å¯¹æ•´ä¸ªå›¾ç‰‡çš„xåç§»é‡</span><br>            slider_x = self.get_offset_slider()<br>            <span class="hljs-comment"># è·å–å‡¹é™·å›¾ç›¸å¯¹ç›¸å¯¹æ•´ä¸ªå›¾ç‰‡çš„xåç§»é‡</span><br>            cover_x = self.get_offset_cover()<br>            <span class="hljs-comment"># è®¡ç®—å¾—åˆ°æŒ‰é’®å‘å³æŒ‰åŠ¨çš„è·ç¦»</span><br>            <span class="hljs-comment"># print(f&#x27;cover_x: &#123;cover_x&#125;, slider_x: &#123;slider_x&#125;&#x27;)</span><br>            move_x = cover_x - slider_x<br>            <span class="hljs-comment"># print(&#x27;move_x:&#x27;, move_x)</span><br>            self.move_to_gap(slide_btn, self.get_track(move_x))<br><br>            <span class="hljs-comment"># ç”¨untilç­‰å¤ªä¹…äº†</span><br>            success = self.wait.until(EC.presence_of_element_located((By.CLASS_NAME, <span class="hljs-string">&#x27;show-success&#x27;</span>)))<br><br>            <span class="hljs-comment"># è¿”å›æ˜¯å¦æˆåŠŸæ ¡éªŒ</span><br>            <span class="hljs-keyword">return</span> success <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># è®¡ç®—å½“å‰é¡µæ•°å­—å’Œ</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_total</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># åˆ‡å‡ºiframe</span><br>        windows = self.driver.window_handles<br>        self.driver.switch_to.window(windows[<span class="hljs-number">0</span>])<br>        div_list = self.driver.find_elements_by_xpath(<span class="hljs-string">&#x27;//div[@class=&quot;card-body&quot;]//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br><br>        page_total = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> div <span class="hljs-keyword">in</span> div_list:<br>            page_total += <span class="hljs-built_in">int</span>(div.text)<br><br>        <span class="hljs-keyword">return</span> page_total<br><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">       æ ¹æ®åç§»é‡è·å–ç§»åŠ¨è½¨è¿¹</span><br><span class="hljs-string">       :param distance: åç§»é‡</span><br><span class="hljs-string">       :return: ç§»åŠ¨è½¨è¿¹</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_track</span>(<span class="hljs-params">self, distance</span>):<br>        <span class="hljs-comment"># ç§»åŠ¨è½¨è¿¹</span><br>        track = []<br>        <span class="hljs-comment"># å½“å‰ä½ç§»</span><br>        current = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># å‡é€Ÿé˜ˆå€¼</span><br>        mid = distance * <span class="hljs-number">4</span> / <span class="hljs-number">5</span><br>        <span class="hljs-comment"># è®¡ç®—é—´éš”</span><br>        t = <span class="hljs-number">0.3</span><br>        <span class="hljs-comment"># åˆé€Ÿåº¦</span><br>        v = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> current &lt; distance:<br>            <span class="hljs-keyword">if</span> current &lt; mid:<br>                <span class="hljs-comment"># åŠ é€Ÿåº¦ä¸ºæ­£5</span><br>                a = <span class="hljs-number">5</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># åŠ é€Ÿåº¦ä¸ºè´Ÿ3</span><br>                a = -<span class="hljs-number">3</span><br>            <span class="hljs-comment"># å½“å‰é€Ÿåº¦v1 = v0 + at</span><br>            v = v + a * t<br>            <span class="hljs-comment"># ç§»åŠ¨è·ç¦»x = v0t + 1/2 * a * t^2</span><br>            move = v * t + <span class="hljs-number">1</span> / <span class="hljs-number">2</span> * a * t * t<br>            <span class="hljs-comment"># å½“å‰ä½ç§»</span><br>            current += move<br>            <span class="hljs-keyword">if</span> current &gt; distance:<br>                track.append(distance - current + move)<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-comment"># åŠ å…¥è½¨è¿¹</span><br>            track.append(<span class="hljs-built_in">round</span>(move))<br>            <span class="hljs-comment"># tæ—¶é—´å, ç°åœ¨çš„é€Ÿåº¦</span><br>            v = v + a * t<br><br>        <span class="hljs-comment"># print(f&#x27;track: &#123;track&#125;&#x27;)</span><br>        <span class="hljs-keyword">return</span> track<br><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        æ‹–åŠ¨æ»‘å—åˆ°ç¼ºå£å¤„</span><br><span class="hljs-string">        :param slider: æ»‘å—</span><br><span class="hljs-string">        :param track: è½¨è¿¹</span><br><span class="hljs-string">        :return:</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">move_to_gap</span>(<span class="hljs-params">self, slider, track</span>):<br>        ActionChains(self.driver).click_and_hold(slider).perform()<br><br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> track:<br>            ActionChains(self.driver).move_by_offset(xoffset=x, yoffset=<span class="hljs-number">0</span>).perform()<br><br>        time.sleep(random.random())<br>        ActionChains(self.driver).release().perform()<br><br><br>env = SeleniumEnv()<br>env.login()<br><br>total = <span class="hljs-number">0</span><br><span class="hljs-comment"># è®¿é—®çš„é¡µæ•°</span><br>page = <span class="hljs-number">967</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    sign = env.checkout(page)<br><br>    <span class="hljs-comment"># å¦‚æœéªŒè¯å¤±è´¥</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sign:<br>        fail_count = <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ç¬¬ <span class="hljs-subst">&#123;page&#125;</span> é¡µå¤±è´¥(1)!!!&#x27;</span>)<br>        <span class="hljs-comment"># é‡å¤æ“ä½œ ç›´åˆ°è¿‡éªŒè¯</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            sign = env.checkout(page)<br>            <span class="hljs-keyword">if</span> sign:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ç¬¬ <span class="hljs-subst">&#123;page&#125;</span> é¡µæˆåŠŸ(n)!!!&#x27;</span>)<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ç¬¬ <span class="hljs-subst">&#123;page&#125;</span> é¡µå¤±è´¥(n) åˆå¤±è´¥<span class="hljs-subst">&#123;fail_count&#125;</span>æ¬¡!!!&#x27;</span>)<br>                fail_count += <span class="hljs-number">1</span><br>                <span class="hljs-keyword">if</span> fail_count &gt; <span class="hljs-number">3</span>:<br>                    <span class="hljs-comment"># é‡å¯æµè§ˆå™¨</span><br>                    env.driver.quit()<br>                    env = SeleniumEnv()<br>                    env.login()<br>                    fail_count = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ç¬¬ <span class="hljs-subst">&#123;page&#125;</span> é¡µæˆåŠŸ(1)!!!&#x27;</span>)<br>    <span class="hljs-comment"># è·å–å½“å‰é¡µå’Œ</span><br>    <span class="hljs-comment"># ç­‰æ•°å­—åŠ è½½å®Œæ¯•</span><br>    time.sleep(<span class="hljs-number">1</span>)<br>    total += env.get_total()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰<span class="hljs-subst">&#123;page&#125;</span>é¡µå’Œä¸º <span class="hljs-subst">&#123;total&#125;</span> &#x27;</span>)<br>    page += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> page == <span class="hljs-number">1001</span>:<br>        env.driver.quit()<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">ä¸­é—´æ€»æœ‰ç½‘ç»œåŸå› ...æœ‰æ—¶è¿é¡µé¢éƒ½æ‰“ä¸å¼€ å®åœ¨åŠ è½½ä¸å‡ºæ¥, åˆ†äº†å¤šæ¬¡æµ‹, å¤§æ¦‚æµ‹äº†10å¤šæ¬¡å§...</span><br><span class="hljs-string">æˆ‘æ‰‹åŠ¨æ“ä½œéƒ½è¿˜èƒ½ä¸€ç›´å‡ºç° &quot;ç½‘ç»œææƒšäº†ä¸€ä¸‹&quot;/&quot;æ‹¼å›¾å—åŠè·¯ä¸¢å¤±&quot;  ???</span><br><span class="hljs-string"></span><br><span class="hljs-string">[1, 272] =&gt; 948786 </span><br><span class="hljs-string">æ€ä¹ˆæœåŠ¡å™¨è¿˜èƒ½ internal server error(nginx) å•Š...</span><br><span class="hljs-string">[273, 378) =&gt; 368900</span><br><span class="hljs-string"></span><br><span class="hljs-string">T^T</span><br><span class="hljs-string">[378, 1000] =&gt; 2177686</span><br><span class="hljs-string"></span><br><span class="hljs-string">3495372</span><br><span class="hljs-string"></span><br><span class="hljs-string">æ€€ç–‘æ˜¯è…¾è®¯é˜²æ°´å¢™æœ‰ä¸€å®šçš„è®¿é—®é™åˆ¶, å»ºè®®æ¯è¿‡100é¡µç­‰ä¸ª10åˆ†é’Ÿå†çˆ¬</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>æˆ‘é ï¼Œé¡µé¢åˆ·æ–°ä¸å‡ºæ¥æˆ‘èƒ½å’‹åŠå•Šï¼Ÿ</p><p>chromeï¼š</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.19.png" alt="éªŒè¯ç -9.19"></p><p>åˆ·æ–°å‡ºæ¥äº†ç­‰è‡ªå·±æ‰‹åŠ¨æ“ä½œä¹Ÿå‡ºç°è¿™ç§ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/veri-9.20.png" alt="éªŒè¯ç -9.20"></p><p><img src="https://img.lsycai.top/glidedsky/veri-9.21.png" alt="éªŒè¯ç -9.21"></p><h1 id="çˆ¬è™«-JSåŠ å¯†1"><a href="#çˆ¬è™«-JSåŠ å¯†1" class="headerlink" title="çˆ¬è™«-JSåŠ å¯†1"></a>çˆ¬è™«-JSåŠ å¯†1</h1><blockquote><p>åˆ†æ</p></blockquote><p>æºç ä¸­çš„å“åº”çš†ä¸ºç©ºä¸²ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/encry-js-10.1.png" alt="jsåŠ å¯†-10.1"></p><p>ç»“åˆé¡µé¢å“åº”åˆ†æï¼š</p><p><img src="https://img.lsycai.top/glidedsky/encry-js-10.2.png" alt="jsåŠ å¯†-10.2"></p><p>æ•°æ®åº”è¯¥å°±æ˜¯å¼‚æ­¥åŠ è½½çš„äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ¨¡æ‹Ÿå¼‚æ­¥GETè¯·æ±‚äº†ã€‚</p><p>urlï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">http://www.glidedsky.com/api/level/web/crawler-javascript-obfuscation-1/items?page=1&amp;t=1617340189&amp;sign=e7c6b4b333bd07e4753288ca683062e925703341<br></code></pre></td></tr></table></figure><p>å‚æ•°åˆ†æï¼š</p><p>pageæ˜¯é¡µæ•°</p><p>tæ˜æ˜¾æ˜¯ç§’çº§æ—¶é—´æˆ³</p><p><img src="https://img.lsycai.top/glidedsky/encry-js-10.3.png" alt="jsåŠ å¯†-10.3"></p><p>signå°±æ˜¯åŠ å¯†èº«ä»½éªŒè¯ä¸²äº†ï¼Œåœ¨æºç åŠå“åº”ä¿¡æ¯ä¸­searchä¸åˆ°ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½ä¼šå˜åŒ–ï¼Œé‚£ä¹ˆæ¨æµ‹æ˜¯<code>æœ¬åœ°jsç”Ÿæˆ</code>ã€‚</p><p>è°ƒè¯•<code>sha1.js</code>æ–‡ä»¶ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/encry-js-10.4.png" alt="jsåŠ å¯†-10.4"></p><p>ä¸‹ä¸€æ­¥è¿‡åï¼Œä¼šå‘ç°signçš„å€¼å°±æ˜¯è¿™ä¸ªreturnè¯­å¥è¿”å›çš„ç»“æœã€‚</p><p>å¯ä»¥æ¯”è¾ƒwatchçª—å£ä¸­çš„å€¼ï¼Œè¿™é‡Œåªåˆ—ä¸¾äº†å‰å‡ ä¸ªå€¼ï¼Œå¯ä»¥çœ‹åˆ°éƒ½æ˜¯å’Œsignç›¸ç­‰çš„ï¼Œå¯ä»¥è¯´æ˜è¿™ä¸ªå‡½æ•°å°±æ˜¯ç”Ÿæˆsignçš„å‡½æ•°ï¼Œè¿”å›å€¼æ­£å¥½æœ‰40é¡¹ï¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript">t.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hex</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">finalize</span>();<br>        <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>.<span class="hljs-property">h0</span><br>          , h = <span class="hljs-variable language_">this</span>.<span class="hljs-property">h1</span><br>          , s = <span class="hljs-variable language_">this</span>.<span class="hljs-property">h2</span><br>          , i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">h3</span><br>          , e = <span class="hljs-variable language_">this</span>.<span class="hljs-property">h4</span>;<br>        <span class="hljs-keyword">return</span> r[t &gt;&gt; <span class="hljs-number">28</span> &amp; <span class="hljs-number">15</span>] + r[t &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">15</span>] + r[t &gt;&gt; <span class="hljs-number">20</span> &amp; <span class="hljs-number">15</span>] + r[t &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">15</span>] + r[t &gt;&gt; <span class="hljs-number">12</span> &amp; <span class="hljs-number">15</span>] + r[t &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">15</span>] + r[t &gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>] + r[<span class="hljs-number">15</span> &amp; t] + r[h &gt;&gt; <span class="hljs-number">28</span> &amp; <span class="hljs-number">15</span>] + r[h &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">15</span>] + r[h &gt;&gt; <span class="hljs-number">20</span> &amp; <span class="hljs-number">15</span>] + r[h &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">15</span>] + r[h &gt;&gt; <span class="hljs-number">12</span> &amp; <span class="hljs-number">15</span>] + r[h &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">15</span>] + r[h &gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>] + r[<span class="hljs-number">15</span> &amp; h] + r[s &gt;&gt; <span class="hljs-number">28</span> &amp; <span class="hljs-number">15</span>] + r[s &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">15</span>] + r[s &gt;&gt; <span class="hljs-number">20</span> &amp; <span class="hljs-number">15</span>] + r[s &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">15</span>] + r[s &gt;&gt; <span class="hljs-number">12</span> &amp; <span class="hljs-number">15</span>] + r[s &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">15</span>] + r[s &gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>] + r[<span class="hljs-number">15</span> &amp; s] + r[i &gt;&gt; <span class="hljs-number">28</span> &amp; <span class="hljs-number">15</span>] + r[i &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">15</span>] + r[i &gt;&gt; <span class="hljs-number">20</span> &amp; <span class="hljs-number">15</span>] + r[i &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">15</span>] + r[i &gt;&gt; <span class="hljs-number">12</span> &amp; <span class="hljs-number">15</span>] + r[i &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">15</span>] + r[i &gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>] + r[<span class="hljs-number">15</span> &amp; i] + r[e &gt;&gt; <span class="hljs-number">28</span> &amp; <span class="hljs-number">15</span>] + r[e &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">15</span>] + r[e &gt;&gt; <span class="hljs-number">20</span> &amp; <span class="hljs-number">15</span>] + r[e &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">15</span>] + r[e &gt;&gt; <span class="hljs-number">12</span> &amp; <span class="hljs-number">15</span>] + r[e &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">15</span>] + r[e &gt;&gt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">15</span>] + r[<span class="hljs-number">15</span> &amp; e]<br>    &#125;<br></code></pre></td></tr></table></figure><p>åˆ·æ–°ï¼Œé‡æ–°è°ƒè¯•ï¼Œçœ‹ä¸‹ä¸€æ­¥æ‰§è¡Œä»€ä¹ˆï¼š</p><p><img src="https://img.lsycai.top/glidedsky/encry-js-10.5.png" alt="jsåŠ å¯†-10.5"></p><p><img src="https://img.lsycai.top/glidedsky/encry-js-10.6.png" alt="jsåŠ å¯†-10.6"></p><p><img src="https://img.lsycai.top/glidedsky/encry-js-10.7.png" alt="jsåŠ å¯†-10.7"></p><p>æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•çš„åˆ°å‚æ•°<code>t</code>å’Œå‚æ•°<code>sign</code>äº†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> p = $(<span class="hljs-string">&#x27;main .container&#x27;</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;p&#x27;</span>);<br><span class="hljs-keyword">let</span> t = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(($(<span class="hljs-string">&#x27;main .container&#x27;</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;t&#x27;</span>) - <span class="hljs-number">99</span>) / <span class="hljs-number">99</span>);<br><span class="hljs-keyword">let</span> sign = <span class="hljs-title function_">sha1</span>(<span class="hljs-string">&#x27;Xr0Z-javascript-obfuscation-1&#x27;</span> + t);<br>$.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/level/web/crawler-javascript-obfuscation-1/items?page=&#x27;</span> + p + <span class="hljs-string">&#x27;&amp;t=&#x27;</span> + t + <span class="hljs-string">&#x27;&amp;sign=&#x27;</span> + sign, <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-keyword">const</span> list = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data).<span class="hljs-property">items</span>;<br>    $(<span class="hljs-string">&#x27;.col-md-1&#x27;</span>).<span class="hljs-title function_">each</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-keyword">if</span> (list &amp;&amp; index &lt; list.<span class="hljs-property">length</span>) &#123;<br>            $(<span class="hljs-string">&#x27;.col-md-1&#x27;</span>).<span class="hljs-title function_">eq</span>(index).<span class="hljs-title function_">text</span>(list[index])<br>        &#125;<br>    &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><p>tå°±æ˜¯å½“å‰çš„ç§’çº§æ—¶é—´æˆ³</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">time.time()<br></code></pre></td></tr></table></figure><p>signå¾—è°ƒç”¨sha1çš„å‡½æ•°ï¼šå‚æ•°æ˜¯<mark class="hl-label +">Xr0Z-javascript-obfuscation-1</mark> ï¼Œè°ƒç”¨æ–¹æ³•æ˜¯ï¼šå°†sha1.jsä¸‹è½½ä¸‹æ¥ï¼Œé‡‡ç”¨js2pyï¼Œç”¨pythonåŠ¨æ€æ‰§è¡Œjsä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    jsåŠ å¯†-1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">import</span> js2py<br><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> json<br><br>env = Env()<br>session = env.login()<br><br><span class="hljs-comment"># ç”Ÿæˆjsæ‰§è¡Œç¯å¢ƒ</span><br>context = js2py.EvalJs()<br><span class="hljs-comment"># pythonè¯»å–js</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;js-obfuscation-1-test/js/sha1.js&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    context.execute(f.read())<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è·å¾—å‚æ•°tå’Œsign</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_t_and_sign</span>():<br>    <span class="hljs-comment"># éœ€è¦æå‰å®šä¹‰çš„å‚æ•°</span><br>    context.t = math.floor(time.time())<br>    <span class="hljs-comment"># éœ€æ‰§è¡Œjsä»£ç </span><br>    js = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        var sign = sha1(&#x27;Xr0Z-javascript-obfuscation-1&#x27; + t);</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    <span class="hljs-comment"># æ‰§è¡Œjsä»£ç </span><br>    context.execute(js)<br>    <span class="hljs-keyword">return</span> context.t, context.sign<br><br><br><span class="hljs-comment"># å®šä¹‰ å’Œ</span><br>total = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> page_num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):<br><br>    t, sign = get_t_and_sign()<br><br>    url = <span class="hljs-string">f&#x27;http://www.glidedsky.com/api/level/web/crawler-javascript-obfuscation-1/items?page=<span class="hljs-subst">&#123;page_num&#125;</span>&amp;t=<span class="hljs-subst">&#123;t&#125;</span>&amp;sign=<span class="hljs-subst">&#123;sign&#125;</span>&#x27;</span><br><br>    response = session.get(url, headers=env.headers)<br><br>    <span class="hljs-comment"># print(json.loads(response.text))</span><br>    nums = json.loads(response.text)[<span class="hljs-string">&#x27;items&#x27;</span>]<br>    total += <span class="hljs-built_in">sum</span>(nums)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å‰ <span class="hljs-subst">&#123;page_num&#125;</span> é¡µæ•°å­—å’Œä¸º: <span class="hljs-subst">&#123;total&#125;</span>&quot;</span>)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç»“æœæ˜¯: <span class="hljs-subst">&#123;total&#125;</span>&quot;</span>)<br><span class="hljs-comment"># è¿™ä¸ªè¿è¡Œç€å°±å¾ˆçˆ½äº†å– (â€¢Ï‰â€¢`)  èˆ’æœ</span><br></code></pre></td></tr></table></figure><h1 id="çˆ¬è™«-éªŒè¯ç -2"><a href="#çˆ¬è™«-éªŒè¯ç -2" class="headerlink" title="çˆ¬è™«-éªŒè¯ç -2"></a>çˆ¬è™«-éªŒè¯ç -2</h1><p>é¡µé¢è®¿é—®å¥½åƒæ²¡æœ‰å†…å®¹äº†ï¼š<a href="http://www.glidedsky.com/level/web/crawler-captcha-2">http://www.glidedsky.com/level/web/crawler-captcha-2</a></p><p><img src="https://img.lsycai.top/glidedsky/veri-11.1.png" alt="éªŒè¯ç -11.1"></p><p>åªä¸è¿‡å°±ç®—åšï¼Œä¼°è®¡æˆ‘ä¹Ÿæ²¡æ³•ï¼ŒçŒœæµ‹éƒ½æ˜¯å›¾å½¢åˆ¤æ–­æˆ–è€…æ±‰å­—ç‚¹å‡»äº†ã€‚</p><h1 id="é›ªç¢§å›¾åçˆ¬-2"><a href="#é›ªç¢§å›¾åçˆ¬-2" class="headerlink" title="é›ªç¢§å›¾åçˆ¬-2"></a>é›ªç¢§å›¾åçˆ¬-2</h1><p>è¯•äº†ä¸‹ç™¾åº¦è¯†å›¾ï¼ˆæ¯å¤©èƒ½å…è´¹ç”¨å¾ˆå¤šæ¬¡ï¼‰ï¼Œå‘ç°ä¾ç„¶ä¼šæœ‰è¯†åˆ«å‡ºé”™çš„æƒ…å†µï¼ï¼ï¼ï¼</p><p>æ‰¾äº†ä¸ªç±»ä¼¼çš„ä»£ç ï¼Œè‡ªå·±ä¿®æ”¹äº†éƒ¨åˆ†ï¼Œèƒ½å®ç°è®­ç»ƒå¹¶è¯†åˆ«mnistæ‰‹å†™æ•°å­—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    tensorflow2.0å®ç°æ‰‹å†™æ±‰å­—å®ç°: http://blog.itpub.net/69978904/viewspace-2733646/</span><br><span class="hljs-string">    ä¿å­˜æ¨¡å‹: https://www.cnblogs.com/piaodoo/p/14124831.html</span><br><span class="hljs-string">    æµ‹è¯•tensorflow2å®ç°mnistæ‰‹å†™æ±‰å­—è¯†åˆ«</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># ä¸€å®šè¦æ”¾åœ¨ import tensorflow ä¹‹å‰æ‰æœ‰æ•ˆ = =</span><br>os.environ[<span class="hljs-string">&#x27;TF_CPP_MIN_LOG_LEVEL&#x27;</span>] = <span class="hljs-string">&#x27;2&#x27;</span><br><br><span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras<br><span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten, Dense<br><span class="hljs-keyword">from</span> tensorflow.keras.datasets <span class="hljs-keyword">import</span> mnist<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># åŠ è½½æ•°æ®é›†</span><br>(train_images, train_labels), (test_images, test_labels) = mnist.load_data()<br><br><span class="hljs-comment"># å›¾ç‰‡æ¯ä¸ªåƒç´ çš„æ•°å€¼éƒ½æ˜¯åœ¨[0, 255]ä¹‹é—´ï¼Œæ‰€ä»¥å½’ä¸€åŒ–è¦é™¤ä»¥255ï¼Œæ•°æ®è¦æ˜¯æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥è¦æ·»åŠ ä¸€ä¸ªå°æ•°ç‚¹</span><br>train_images, test_images = train_images / <span class="hljs-number">255.0</span>, test_images / <span class="hljs-number">255.0</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    é‡æ–°åˆ›å»ºä¸€ä¸ªmodel</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">new_model</span>():<br>    <span class="hljs-comment"># å®šä¹‰æ¨¡å‹</span><br>    <span class="hljs-comment"># æ­å»ºä¸€ä¸ªé¡ºåºæ¨¡å‹ï¼Œç¬¬ä¸€å±‚å…ˆå°†æ•°æ®å±•å¹³ï¼ŒåŸå§‹å›¾ç‰‡æ˜¯28x28çš„ç°åº¦å›¾ï¼Œæ‰€ä»¥è¾“å…¥å°ºå¯¸æ˜¯ï¼ˆ28ï¼Œ28ï¼‰ï¼Œç¬¬äºŒå±‚èŠ‚ç‚¹æ•°å¯ä»¥è‡ªå·±é€‰æ‹©ä¸€ä¸ªåˆé€‚å€¼ï¼Œè¿™é‡Œç”¨128ä¸ªèŠ‚ç‚¹ï¼Œæ¿€æ´»å‡½æ•°ç”¨relu</span><br>    <span class="hljs-comment">#   ç¬¬ä¸‰å±‚æœ‰å¤šå°‘ä¸ªç§ç±»å°±å†™å¤šå°‘ï¼Œ[0, 9]ä¸€å…±æœ‰10ä¸ªæ•°å­—,æ‰€ä»¥å¿…é¡»å†™10ï¼Œæ¿€æ´»å‡½æ•°ç”¨softmax</span><br>    model = keras.Sequential([<br>        Flatten(input_shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>)),<br>        Dense(<span class="hljs-number">128</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>),<br>        Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">&#x27;softmax&#x27;</span>)<br>    ])<br><br>    <span class="hljs-comment"># æŒ‡å®šä¼˜åŒ–å™¨ã€æŸå¤±å‡½æ•°ã€è¯„ä»·æŒ‡æ ‡</span><br>    model.<span class="hljs-built_in">compile</span>(optimizer=<span class="hljs-string">&#x27;adam&#x27;</span>,<br>                  loss=<span class="hljs-string">&#x27;sparse_categorical_crossentropy&#x27;</span>,<br>                  metrics=[<span class="hljs-string">&#x27;acc&#x27;</span>])<br><br>    <span class="hljs-keyword">return</span> model<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å·²å­˜åœ¨çš„model, åŠ è½½æƒé‡å’Œåç½®(æ–¹æ³•ä¸€: ä¿å­˜æ¨¡å‹çš„æƒé‡å’Œåç½®)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_weights_bias</span>(<span class="hljs-params">model</span>):<br>    <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">&#x27;./tensorflow2_mnist_model/weights_bias_model/checkpoint&#x27;</span>):<br>        model.load_weights(<span class="hljs-string">&#x27;./tensorflow2_mnist_model/weights_bias_model/my_model&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬ä¸€æ¬¡ä¿å­˜æƒé‡å’Œåç½®å§? å½“å‰æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨å‘! &#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä¿å­˜modelçš„æƒé‡å’Œåç½®</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_weight_bias</span>(<span class="hljs-params">model</span>):<br>    model.save_weights(<span class="hljs-string">&#x27;./tensorflow2_mnist_model/weights_bias_model/my_model&#x27;</span>)<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è®­ç»ƒæ¨¡å‹</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">train_model</span>(<span class="hljs-params">model</span>):<br>    <span class="hljs-comment"># è®­ç»ƒæ¨¡å‹</span><br>    model.fit(train_images, train_labels, epochs=<span class="hljs-number">1</span>)<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä¿å­˜æ•´ä¸ªæ¨¡å‹(æ–¹æ³•äºŒ: ç›´æ¥ä¿å­˜æ•´ä¸ªæ¨¡å‹)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_all_model</span>(<span class="hljs-params">model</span>):<br>    model.save(<span class="hljs-string">&#x27;./tensorflow2_mnist_model/all_model/mnist_weights.h5&#x27;</span>)<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    åŠ è½½æ•´ä¸ªæ¨¡å‹</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_all_model</span>():<br>    <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">&#x27;./tensorflow2_mnist_model/all_model/mnist_weights.h5&#x27;</span>):<br>        <span class="hljs-keyword">return</span> keras.models.load_model(<span class="hljs-string">&#x27;./tensorflow2_mnist_model/all_model/mnist_weights.h5&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬ä¸€æ¬¡ä¿å­˜æ•´ä¸ªæ¨¡å‹å§? å½“å‰æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨å‘! &#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br>model = new_model()<br><span class="hljs-comment"># æ–¹æ³•ä¸€: å¼€å§‹</span><br><span class="hljs-comment"># load_weights_bias(model)</span><br><span class="hljs-comment"># train_model(model)</span><br><span class="hljs-comment"># save_weight_bias(model)</span><br><span class="hljs-comment"># æ–¹æ³•ä¸€: ç»“æŸ</span><br><br><span class="hljs-comment"># æ–¹æ³•äºŒ: å¼€å§‹</span><br>reload_model = load_all_model()<br><span class="hljs-keyword">if</span> reload_model <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>    model = reload_model<br><br>train_model(model)<br>save_all_model(model)<br><span class="hljs-comment"># æ–¹æ³•äºŒ: ç»“æŸ</span><br><br><br><span class="hljs-comment"># ç”¨æµ‹è¯•é›†éªŒè¯æ¨¡å‹æ•ˆæœ</span><br>test_loss, test_acc = model.evaluate(test_images, test_labels, verbose=<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Test acc:&#x27;</span>, test_acc)<br><br><span class="hljs-comment"># å°†å›¾ç‰‡è¾“å…¥æ¨¡å‹ï¼Œè¿”å›é¢„æµ‹ç»“æœ (å°†æµ‹è¯•é›†ä¸­çš„ç¬¬ä¸€å¼ å›¾ç‰‡è¾“å…¥æ¨¡å‹)</span><br>predictions = model.predict(test_images)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;predictions: &#x27;</span>, predictions)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;é¢„æµ‹å€¼:&#x27;</span>, np.argmax(predictions[<span class="hljs-number">0</span>]))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;çœŸå®å€¼:&#x27;</span>, test_labels[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><blockquote><p>å…ˆä»¿ç…§mnistæ•°æ®é›†ï¼Œå°†glidedskyä¸Šçš„é›ªç¢§å›¾åˆ†å‰²æˆæ¯ä¸ªå°çš„æ•°å­—ï¼Œä½œä¸ºè®­ç»ƒé›†å›¾ç‰‡ï¼Œä¹‹åå†è¯»å–å›¾ç‰‡ï¼Œæ„æˆmnistæ•°æ®é›†çš„æ•°æ®ç»“æ„ï¼Œå¦‚æ­¤è¾¾åˆ°æœ€ç»ˆèƒ½è¯†åˆ«çš„ç›®çš„ã€‚</p></blockquote><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>è®­ç»ƒæ•°æ®ï¼š</p><p>åœ¨çº¿è·å–äºŒç»´é›ªç¢§å›¾ï¼Œç”¨psåˆ‡å‰²å¤§çš„äºŒç»´é›ªç¢§å›¾æˆå°æ•°å­—å›¾(<a href="https://jingyan.baidu.com/article/9989c746fe0ffef649ecfe5d.html)%EF%BC%8C%E5%B9%B6%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E4%B8%BA18*18%EF%BC%88**%E7%99%BE%E5%BA%A6**%EF%BC%9Ahttps://jingyan.baidu.com/article/9f7e7ec0ecf9676f2815540a.html%EF%BC%8C%E5%B9%B6%E4%B8%94%E8%A6%81%E6%B1%82%E4%B8%BA%E6%96%87%E4%BB%B6%E5%90%8D**%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AD%97%E6%AF%8D%E6%98%AF%E6%95%B0%E5%AD%97**%E5%8D%B3%E5%8F%AF%EF%BC%8C%E5%A6%82&#39;1.12312z.jpg&#39;%E3%80%81&#39;3.(1)jpg&#39;">https://jingyan.baidu.com/article/9989c746fe0ffef649ecfe5d.html)ï¼Œå¹¶æ‰¹é‡ä¿®æ”¹ä¸º18*18ï¼ˆ**ç™¾åº¦**ï¼šhttps://jingyan.baidu.com/article/9f7e7ec0ecf9676f2815540a.htmlï¼Œå¹¶ä¸”è¦æ±‚ä¸ºæ–‡ä»¶å**ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯æ•°å­—**å³å¯ï¼Œå¦‚&#39;1.12312z.jpg&#39;ã€&#39;3.(1)jpg&#39;</a></p><p>åªä¸è¿‡æ¨ªå‘å‡åŒ€åˆ‡å‰²è¿˜å¥½ï¼Œä½†æ˜¯çºµå‘ä¸è¡Œï¼Œä¼šæ‰“ä¹±æ•°æ®çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ€å¥½ç”¨ä»£ç ä»¥åƒç´ ä¸ºåŸºå‡†åˆ¤æ–­åˆ‡å‰²å¥½ï¼Œå†ç”¨psç»Ÿä¸€å¤„ç†ä¸º18*18çš„è®­ç»ƒé›†ï¼ˆè¿™ä¸€æ­¥ä¹Ÿèƒ½ç”¨ä»£ç å®Œæˆï¼Œæ‰€ä»¥å»ºè®®ç›´æ¥ç”¨ä»£ç ä¸‹è½½å›¾ç‰‡æ•°æ®é›†ï¼Œæ‰‹åŠ¨æ›´æ”¹æ–‡ä»¶åä½œä¸ºlabelsï¼‰ã€‚</p><p>ç°åœ¨åªéœ€ï¼Œå°†æ‰€æœ‰18*18å›¾ç‰‡æ•°æ®è½¬åŒ–ä¸ºç±»ä¼¼mnistçš„æ•°æ®ç»“æ„è¿›è¡Œè¿”å›ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.1.png" alt="é›ªç¢§å›¾åçˆ¬-12.1"></p><p>imageså’Œlabelsæ•°æ®åˆ†åˆ«æ˜¯ä¸‰ç»´å’Œä¸€ç»´Tensorã€‚</p><p>ç„¶åå°±èƒ½ç”¨æœ€ä¸Šæ–¹çš„è®­ç»ƒä»£ç è¿›è¡Œè®­ç»ƒäº†ã€‚</p><p>åç»­å†å¤šå¼„ç‚¹æ•°æ®é›†ã€‚</p><h2 id="ä»£ç å®ç°åˆ‡å‰²å‡ºå°å›¾"><a href="#ä»£ç å®ç°åˆ‡å‰²å‡ºå°å›¾" class="headerlink" title="ä»£ç å®ç°åˆ‡å‰²å‡ºå°å›¾"></a>ä»£ç å®ç°åˆ‡å‰²å‡ºå°å›¾</h2><p>æ¨ªå‘åˆ‡å‰²ï¼Œç»“æœæ˜¯æ¯ä¸€è¡Œï¼Œæ²¡ä¸€è¡Œå†…å†æŒ‰ç…§æ•°å­—æœ€å°å®½åº¦åˆ‡å‰²ï¼Œåˆ‡å‡ºæ¥çš„å›¾ç‰‡å°†åˆ†è¾¨ç‡è°ƒä¸º18*18å°±å¾—åˆ°äº†è®­ç»ƒå›¾ã€‚</p><p>æ‰¹é‡é‡å‘½åï¼šå·¦é”®åŠ ä¸Š ctrl ï¼Œå¤šé€‰ï¼Œé€‰å¥½äº†å†å³é”®é‡å‘½åï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.2.png" alt="é›ªç¢§å›¾åçˆ¬-12.2"></p><p>å³é”®é‡å‘½åï¼Œè¾“å…¥â€œ1â€ï¼Œä¸‹å›¾å³ä¸ºç»“æœï¼ˆå¾ˆæ–¹ä¾¿å•Šï¼‰ï¼š</p><p>ç”¨ä»¥ä¸‹ä»£ç å¤šç”Ÿæˆå†™è®­ç»ƒé›†ï¼Œå¹¶æ‰¹é‡é‡å‘½åï¼Œæœ‰è€å¿ƒä¸€äº›ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä¸‹è½½äºŒç»´é›ªç¢§å›¾å¹¶å®ç°åˆ†å‰²</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> io<br><br><span class="hljs-comment"># è°ƒç”¨å°è£…çš„ç™»é™†ç¯å¢ƒ</span><br>env = Env()<br>session = env.login()<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è·å–äºŒç»´é›ªç¢§å›¾</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sprite</span>(<span class="hljs-params">url</span>):<br>    <span class="hljs-comment"># è¯·æ±‚æºç </span><br>    response = session.get(url, headers=env.headers)<br><br>    <span class="hljs-comment"># æ­£åˆ™è§£æbase64</span><br>    base64_bytes = base64.b64decode(re.search(<span class="hljs-string">&#x27;base64,(.*?)\&quot;&#x27;</span>, response.text).group(<span class="hljs-number">1</span>))<br><br>    <span class="hljs-comment"># å¯ä»¥ä¸ç”¨å†™æ–‡ä»¶, ç›´æ¥è½¬ä¸ºImage</span><br>    <span class="hljs-comment"># with open(&#x27;./sprite_img/sprite.png&#x27;, &#x27;wb&#x27;) as f:</span><br>    <span class="hljs-comment">#     f.write(base64_bytes)</span><br><br>    <span class="hljs-keyword">return</span> Image.<span class="hljs-built_in">open</span>(io.BytesIO(base64_bytes))<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    é’ˆå¯¹æ¯ä¸€è¡Œçš„å›¾ç‰‡è¿›è¡ŒæŒ‰åˆ—åˆ‡å‰², è¿”å›æ•°å­—çš„æœ€å°å®½é™é›†åˆ å¦‚ [(1, 3), (5, 8), ...], é‚£ä¹ˆæ¨ªå‘x å±äº [1, 3] å°±æ˜¯æ•°å­—0çš„èŒƒå›´, ä¸€èµ·ç±»æ¨</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_gray_interval</span>(<span class="hljs-params">row_image</span>):<br>    interval_list = []<br><br>    <span class="hljs-comment"># å‰ä¸€åˆ—çº¯ç™½ ä¸ºçœŸ</span><br>    last_col_all_white = <span class="hljs-literal">True</span><br>    <span class="hljs-comment"># æ•°å­—å¼€å§‹x å’Œ æ•°å­—ç»“æŸx (2ä¸ªå˜é‡ä¸èƒ½è¢«é‡å¤èµ‹å€¼0, æ‰€ä»¥æ”¾åˆ°å¾ªç¯å¤–éƒ¨)</span><br>    num_start_x = <span class="hljs-number">0</span><br>    num_end_x = <span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># éå†æ¯ä¸€åˆ—, æ¯ä¸€è¡Œ</span><br>    pixels = row_image.load()<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(row_image.width):<br>        <span class="hljs-comment"># å½“å‰åˆ—çº¯ç™½ä¸ºçœŸ</span><br>        cur_col_all_white = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(row_image.height):<br>            <span class="hljs-comment"># å› ä¸ºæ˜¯ç°åº¦å›¾ç‰‡ åªä»¥ r å€¼ä»£è¡¨é¢œè‰²å³å¯</span><br>            <span class="hljs-keyword">if</span> pixels[x, y][<span class="hljs-number">0</span>] != <span class="hljs-number">255</span>:<br>                cur_col_all_white = <span class="hljs-literal">False</span><br><br>        <span class="hljs-comment"># ä¸€åˆ—è¿­ä»£ç»“æŸå</span><br>        <span class="hljs-comment"># å¦‚æœ å‰ä¸€åˆ—ä¸ºå…¨ç™½ and å½“å‰åˆ—å­˜åœ¨ç°</span><br>        <span class="hljs-keyword">if</span> last_col_all_white <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> cur_col_all_white:<br>            num_start_x = x<br>        <span class="hljs-comment"># å¦‚æœ å‰ä¸€åˆ—å­˜åœ¨ç° and å½“å‰åˆ—å…¨ç™½</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> last_col_all_white <span class="hljs-keyword">and</span> cur_col_all_white:<br>            num_end_x = x<br>            <span class="hljs-comment"># æ·»åŠ åˆ†æ®µä¿¡æ¯</span><br>            interval_list.append((num_start_x, num_end_x))<br><br>        <span class="hljs-comment"># ä¸‹ä¸€åˆ—å¼€å§‹å‰, é‡ç½® last_col_all_white</span><br>        last_col_all_white = cur_col_all_white<br><br>    <span class="hljs-keyword">return</span> interval_list<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    åˆ‡å‰²ä¸ºåˆç†å¤§å°, ä¿å­˜åˆ°train_imgæ–‡ä»¶å¤¹ä¸‹, ä½œä¸ºè®­ç»ƒé›†</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">slice_image</span>(<span class="hljs-params">image</span>):<br>    <span class="hljs-comment"># æ¯ä¸€å—çš„é«˜</span><br>    piece_height = image.height / <span class="hljs-number">10</span><br>    <span class="hljs-comment"># æ¨ªå‘èƒ½å¹³å‡åˆ‡å‰², çºµå‘ä¸èƒ½, ç”¨psæ¨ªçºµå¹³å‡éƒ½æ˜¯10ä»½è¯•ä¸€ä¸‹å°±çŸ¥é“äº†</span><br>    <span class="hljs-comment"># å…ˆçºµå‘å¹³å‡åˆ‡å‰²10ä»½ 0~9</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        y = i * piece_height<br>        row_image = image.crop((<span class="hljs-number">0</span>, y, image.width, y + piece_height))<br>        <span class="hljs-comment"># å†å¯¹æ¯ä¸€è¡Œçš„å›¾ç‰‡è¿›è¡ŒæŒ‰åˆ—åˆ‡å‰²</span><br>        interval_list = get_gray_interval(row_image)<br>        <span class="hljs-comment"># éå†åˆ†éš” æ‰¹é‡åˆ†å‰² ä¿å­˜æ•°å­—å›¾ç‰‡</span><br>        <span class="hljs-keyword">for</span> interval <span class="hljs-keyword">in</span> interval_list:<br>            num_image = row_image.crop((interval[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>, interval[<span class="hljs-number">1</span>], row_image.height))<br>            <span class="hljs-comment"># é‡ç½®åƒç´ ä¸º 18*18 NEAREST: ä½è´¨é‡  BILINEAR: åŒçº¿æ€§: BICUBIC: ä¸‰æ¬¡æ ·æ¡æ’å€¼  ANTIALIAS: é«˜è´¨é‡  æ„Ÿè§‰ä¸­é—´ä¸¤ä¸ªæ•ˆæœå¥½ä¸€äº›</span><br>            num_image = num_image.resize((<span class="hljs-number">18</span>, <span class="hljs-number">18</span>), Image.ANTIALIAS)<br>            <span class="hljs-comment"># æš‚æ—¶éšæœºå–å ä¹‹åå†æ‰‹åŠ¨è°ƒæ•´ä¸ºçœŸå®æ•°å­—å‘½åæ–‡ä»¶</span><br>            num_image.save(<span class="hljs-string">f&#x27;./train_img/<span class="hljs-subst">&#123;random.randint(<span class="hljs-number">11</span>, <span class="hljs-number">1000</span>)&#125;</span>.png&#x27;</span>)<br><br><br>url = <span class="hljs-string">&#x27;http://www.glidedsky.com/level/web/crawler-sprite-image-2?page=1&#x27;</span><br>image = get_sprite(url)<br>slice_image(image)<br></code></pre></td></tr></table></figure><p>æš‚æ—¶å¼„è¿™ä¹ˆå¤šè®­ç»ƒé›†ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.3.png" alt="é›ªç¢§å›¾åçˆ¬-12.3"></p><p>å†å¼„è¿™ä¹ˆå¤šæµ‹è¯•é›†ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.4.png" alt="é›ªç¢§å›¾åçˆ¬-12.4"></p><h2 id="å¼€å§‹è®­ç»ƒ"><a href="#å¼€å§‹è®­ç»ƒ" class="headerlink" title="å¼€å§‹è®­ç»ƒ"></a>å¼€å§‹è®­ç»ƒ</h2><p>è¯»å–è¿›å»çš„æ–‡ä»¶ååˆ—è¡¨ï¼Œä¸€å®šè®°å¾—shuffleä¸€ä¸‹ã€‚</p><p>å¤šè®­ç»ƒäº›æ•°æ®é›†ï¼Œå¦‚æœå¯¹æµ‹è¯•ç»“æœä¸æ»¡æ„å†é‡æ–°<code>æ·»åŠ äº›è®­ç»ƒé›†</code>å³å¯ã€‚</p><p>&#x3D; &#x3D;ï¼Œæœ‰äº›æ•°å­—å½¢çŠ¶ä¹Ÿå¤ªç¦»è°±äº†å§</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.5.png" alt="é›ªç¢§å›¾åçˆ¬-12.5"></p><h2 id="ç¼–ç "><a href="#ç¼–ç " class="headerlink" title="ç¼–ç "></a>ç¼–ç </h2><p>æŠŠbase64ä¸²å’Œé¢„æµ‹ç»“æœè®°å½•ï¼Œæ¯”è¾ƒï¼Œå°†<code>ä¸åŒçš„æ•°å­—</code>ä¿å­˜ä¸ºè®­ç»ƒé›†ï¼Œå†æ¬¡è®­ç»ƒã€‚</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.6.png" alt="é›ªç¢§å›¾åçˆ¬-12.6"></p><p>æŠŠæ„Ÿè§‰åˆ¤æ–­ä¸å¥½çš„æ•°å­—ä¹Ÿä¸€å¹¶åŠ å…¥è®­ç»ƒé›†ã€‚</p><p>1ã€2ã€7ã€4ã€6ã€3æ˜¯é«˜é¢‘é”™ç‚¹ï¼Œéƒ½å…¨éƒ¨åŠ å…¥è®­ç»ƒé›†ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.7.png" alt="é›ªç¢§å›¾åçˆ¬-12.7"></p><p>åå¤é‡å¤ä»¥ä¸Šå¯¹æ¯”æ“ä½œã€æ·»åŠ æ•°æ®é›†é‡æ–°è®­ç»ƒæ“ä½œã€‚</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.8.png" alt="é›ªç¢§å›¾åçˆ¬-12.8"></p><p>è¿™ã€‚ã€‚ï¼Œè®­ç»ƒé›†å¤ªå°‘äº†å§ï¼Ÿ &#x3D; &#x3D;</p><p>å†åŠ ç‚¹ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.9.png" alt="é›ªç¢§å›¾åçˆ¬-12.9"></p><p>æŒ‰è¿™æ ·æ¯è¡Œ10ä¸ªåŒºåˆ†èµ·æ¥ä¼šå¿«é€Ÿäº›ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯ä¸æ–­è®­ç»ƒçš„è¿‡ç¨‹äº†ã€‚</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.10.png" alt="é›ªç¢§å›¾åçˆ¬-12.10"></p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.11.png" alt="é›ªç¢§å›¾åçˆ¬-12.11"></p><p>è¿™ä¸ª <code>6</code> å°±ç¦»è°±</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.12.png" alt="é›ªç¢§å›¾åçˆ¬-12.12"></p><blockquote><p>ä¹‹åæ‰æ„è¯†åˆ°ï¼Œç›´æ¥è·å–ç¬¬ä¸€é¡µæ•°æ®ï¼Œå› ä¸ºæ•°å­—å›ºå®šï¼Œèƒ½ç›´æ¥è·å¾—çœŸå®æ•°å­—å’Œ <code>small_image</code> çš„å¯¹åº”å…³ç³»ã€‚</p><p><a href="https://www.cnblogs.com/TurboWay/p/13678074.html">https://www.cnblogs.com/TurboWay/p/13678074.html</a></p></blockquote><p>è®­ç»ƒæ•°æ®ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.13.png" alt="é›ªç¢§å›¾åçˆ¬-12.13"></p><p>æµ‹è¯•æ•°æ®ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.14.png" alt="é›ªç¢§å›¾åçˆ¬-12.14"></p><p>æˆ‘é ï¼Œresizeéœ€è¦é‡æ–°èµ‹å€¼ï¼Œæ²¡é‡æ–°èµ‹å€¼å°±ä¿å­˜äº†ï¼å…¨æ˜¯æ¯resizeä¹‹å‰çš„å›¾ç‰‡ï¼Œéƒ½å¾—é‡æ–°ä¸‹è½½</p><p>æ–°æ•°æ®ï¼š</p><p><img src="https://img.lsycai.top/glidedsky/sprite-non-12.15.png" alt="é›ªç¢§å›¾åçˆ¬-12.15"></p><p>é‡æ–°è®­ç»ƒã€‚</p><p>ç„¶åæ¯é¡µæ•°æ®çš„å’Œï¼Œè¯·æ±‚æ¬¡æ•°åœ¨3æ¬¡åŠå…¶ä»¥ä¸Šï¼Œå¹¶ä¸”æœ‰ä¸ªæ•°é¢‘ç‡å¤§äºç­‰äº3&#x2F;4ï¼Œæ‰ç®—è¯·æ±‚æˆåŠŸï¼Œå¦åˆ™é‡æ–°è¯·æ±‚å½“å‰é¡µæ•°æ®ã€‚</p><blockquote><p>è¯´æ˜ï¼šåç»­æ·»åŠ è®­ç»ƒæ•°æ®åˆ°è¾¾42wï¼Œåº”è¯¥åœ¨10wéƒ½å¤Ÿäº†ï¼Œæˆ‘è¿˜ä»¥ä¸ºè®­ç»ƒå‡ºé”™ï¼Œå¤šå¼„äº†äº›æ•°æ®</p><p>è¿˜æœ‰ï¼Œå³ä½¿accuracyè¾¾åˆ°0.98&#x2F;0.97ï¼ˆæµ‹è¯•é›†æœ‰10wï¼‰ï¼Œå®é™…çˆ¬å–æ—¶å‡ºé”™æ¦‚ç‡ä¾æ—§ç‰¹åˆ«é«˜ï¼Œä¸€å®šè¦ä¸€ä¸ªé¡µé¢å¤šè¯·æ±‚å‡ ç»„ï¼Œå–é«˜é¢‘å‡ºç°çš„é‚£ä¸ªåˆ¤å®šæ•°æ®ï¼ï¼ï¼</p></blockquote><blockquote><p>ä»£ç </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">çˆ¬è™«-é›ªç¢§å›¾-2</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">import</span> os<br>os.environ[<span class="hljs-string">&#x27;TF_CPP_MIN_LOG_LEVEL&#x27;</span>] = <span class="hljs-string">&#x27;2&#x27;</span><br><br><span class="hljs-keyword">from</span> env <span class="hljs-keyword">import</span> Env<br><span class="hljs-keyword">from</span> lxml <span class="hljs-keyword">import</span> etree<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras<br><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<br><br><span class="hljs-comment"># è°ƒç”¨å°è£…çš„ç™»é™†ç¯å¢ƒ</span><br>env = Env()<br>session = env.login()<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è·å–äºŒç»´é›ªç¢§å›¾(åŒ 2.sprite2_base64img_download.py)</span><br><span class="hljs-string">    context: ç½‘é¡µæºç </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sprite</span>(<span class="hljs-params">context</span>):<br>    <span class="hljs-comment"># æ­£åˆ™è§£æbase64</span><br>    base64_bytes = base64.b64decode(re.search(<span class="hljs-string">&#x27;base64,(.*?)\&quot;&#x27;</span>, context).group(<span class="hljs-number">1</span>))<br><br>    <span class="hljs-comment"># å¯ä»¥ä¸ç”¨å†™æ–‡ä»¶, ç›´æ¥è½¬ä¸ºImage</span><br>    <span class="hljs-comment"># with open(&#x27;./sprite_img/sprite.png&#x27;, &#x27;wb&#x27;) as f:</span><br>    <span class="hljs-comment">#     f.write(base64_bytes)</span><br><br>    <span class="hljs-keyword">return</span> Image.<span class="hljs-built_in">open</span>(io.BytesIO(base64_bytes))<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    é’ˆå¯¹æ¯ä¸€è¡Œçš„å›¾ç‰‡è¿›è¡ŒæŒ‰åˆ—åˆ‡å‰², è¿”å›æ•°å­—çš„æœ€å°å®½é™é›†åˆ å¦‚ [(1, 3), (5, 8), ...], é‚£ä¹ˆæ¨ªå‘x å±äº [1, 3] å°±æ˜¯æ•°å­—0çš„èŒƒå›´, ä¸€èµ·ç±»æ¨</span><br><span class="hljs-string">    (åŒ 2.sprite2_base64img_download.py)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_gray_interval</span>(<span class="hljs-params">row_image</span>):<br>    interval_list = []<br><br>    <span class="hljs-comment"># å‰ä¸€åˆ—çº¯ç™½ ä¸ºçœŸ</span><br>    last_col_all_white = <span class="hljs-literal">True</span><br>    <span class="hljs-comment"># æ•°å­—å¼€å§‹x å’Œ æ•°å­—ç»“æŸx (2ä¸ªå˜é‡ä¸èƒ½è¢«é‡å¤èµ‹å€¼0, æ‰€ä»¥æ”¾åˆ°å¾ªç¯å¤–éƒ¨)</span><br>    num_start_x = <span class="hljs-number">0</span><br>    num_end_x = <span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># éå†æ¯ä¸€åˆ—, æ¯ä¸€è¡Œ</span><br>    pixels = row_image.load()<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(row_image.width):<br>        <span class="hljs-comment"># å½“å‰åˆ—çº¯ç™½ä¸ºçœŸ</span><br>        cur_col_all_white = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(row_image.height):<br>            <span class="hljs-comment"># å› ä¸ºæ˜¯ç°åº¦å›¾ç‰‡ åªä»¥ r å€¼ä»£è¡¨é¢œè‰²å³å¯</span><br>            <span class="hljs-keyword">if</span> pixels[x, y][<span class="hljs-number">0</span>] != <span class="hljs-number">255</span>:<br>                cur_col_all_white = <span class="hljs-literal">False</span><br><br>        <span class="hljs-comment"># ä¸€åˆ—è¿­ä»£ç»“æŸå</span><br>        <span class="hljs-comment"># å¦‚æœ å‰ä¸€åˆ—ä¸ºå…¨ç™½ and å½“å‰åˆ—å­˜åœ¨ç°</span><br>        <span class="hljs-keyword">if</span> last_col_all_white <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> cur_col_all_white:<br>            num_start_x = x<br>        <span class="hljs-comment"># å¦‚æœ å‰ä¸€åˆ—å­˜åœ¨ç° and å½“å‰åˆ—å…¨ç™½</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> last_col_all_white <span class="hljs-keyword">and</span> cur_col_all_white:<br>            num_end_x = x<br>            <span class="hljs-comment"># æ·»åŠ åˆ†æ®µä¿¡æ¯</span><br>            interval_list.append((num_start_x, num_end_x))<br><br>        <span class="hljs-comment"># ä¸‹ä¸€åˆ—å¼€å§‹å‰, é‡ç½® last_col_all_white</span><br>        last_col_all_white = cur_col_all_white<br><br>    <span class="hljs-keyword">return</span> interval_list<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å°†å›¾ç‰‡åˆ—è¡¨è½¬ä¸ºç±»ä¼¼mnistæ•°æ®ç»“æ„çš„æ•°æ®, æ–¹ä¾¿æ¨¡å‹è¿›è¡Œé¢„æµ‹</span><br><span class="hljs-string">    return: [100*18*18] ä¸‰ç»´çŸ©é˜µTensor</span><br><span class="hljs-string">        åŸºæœ¬åŒ 3.sprite2_train_test.py ä¸­çš„ def get_train_data_like_mnist(train_img_path)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_images_like_mnist_data</span>(<span class="hljs-params">small_images</span>):<br>    <span class="hljs-comment"># å‡†å¤‡ä¸‰ç»´çŸ©é˜µ</span><br>    images = np.zeros([<span class="hljs-built_in">len</span>(small_images), <span class="hljs-number">18</span>, <span class="hljs-number">18</span>])<br><br>    <span class="hljs-comment"># éå†æ¯ä¸ªåƒç´ ç‚¹</span><br>    <span class="hljs-keyword">for</span> index, small_image <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(small_images):<br>        <span class="hljs-comment"># éå†æ¯ä¸ªå›¾ç‰‡çš„æ‰€æœ‰åƒç´ ç‚¹</span><br>        width = <span class="hljs-number">18</span><br>        height = <span class="hljs-number">18</span><br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, width):<br>            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, height):<br>                <span class="hljs-comment"># å•é€šé“å– rå€¼ å³å¯  æ„å»º[b, 18, 20]  ä¿è¯ç°åº¦å€¼åœ¨ 0~1</span><br>                images[index][x][y] = small_image.getpixel((x, y))[<span class="hljs-number">0</span>] / <span class="hljs-number">255.0</span><br><br>    <span class="hljs-comment"># è¿”å›è®­ç»ƒæ•°æ®æ—¶, éœ€è¦å°†æ•°æ®å°è£…ä¸ºTensor</span><br>    <span class="hljs-keyword">return</span> tf.convert_to_tensor(images, dtype=tf.float32)<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    é¢„æµ‹æ•°å­—</span><br><span class="hljs-string">    return: è¿”å›æ•°å­—åˆ—è¡¨(strå½¢å¼, åæœŸæ–¹ä¾¿æ‹¼æ¥)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">small_images, model</span>):<br>    <span class="hljs-comment"># numè¡¨ç¤ºæ¯ä¸€é¡µæ•°æ® å°±æ˜¯12ä¸ª</span><br>    num_list = []<br><br>    images_data = parse_images_like_mnist_data(small_images)<br>    <span class="hljs-comment"># è¿›è¡Œé¢„æµ‹ predictions æ˜¯é¢„æµ‹çš„æ¦‚ç‡å€¼</span><br>    predictions = model.predict(images_data)<br><br>    <span class="hljs-comment"># é¢„æµ‹å€¼å¡«å……è¿› num_list</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(small_images)):<br>        <span class="hljs-comment"># å°†int64è½¬ä¸ºint</span><br>        num_list.append(np.argmax(predictions[i]))<br><br>    <span class="hljs-keyword">return</span> num_list<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ ¹æ®æ¯ä¸ªå•æ•°å­—divçš„åç§»å’Œå®½é«˜ä»é›ªç¢§å›¾ä¸­åˆ‡å‰²å‡ºå°å›¾, åˆ©ç”¨æ¨¡å‹è¯†åˆ«æ•°å­—</span><br><span class="hljs-string">    image: äºŒä½é›ªç¢§å›¾</span><br><span class="hljs-string">    context: ç½‘é¡µæºç </span><br><span class="hljs-string">    return: (åˆ‡å‰²å¥½çš„ single_bit_imageé›†åˆ, ä¸€é¡µå…±12ä¸ªæ•°æ¯ä¸ªæ•°æœ‰å‡ ä½æ•°å­—)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">slice_image</span>(<span class="hljs-params">image, context</span>):<br>    <span class="hljs-comment"># æ¯ä¸€ä½æ•°å­—çš„é›†åˆ</span><br>    single_bit_images = []<br>    <span class="hljs-comment"># è®°å½•æ€»å…±12ä¸ªæ•°å­— æ¯ä¸ªæ•°å­—å„æœ‰å¤šå°‘ä½</span><br>    count_bit = []<br><br>    <span class="hljs-comment"># è·å–è£…æœ‰æ•°å­—çš„div</span><br>    html = etree.HTML(context)<br>    num_divs = html.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;col-md-1&quot;]&#x27;</span>)<br>    <span class="hljs-comment"># è·å–css</span><br>    style = html.xpath(<span class="hljs-string">&#x27;//style/text()&#x27;</span>)[<span class="hljs-number">0</span>]<br><br>    <span class="hljs-comment"># éå†div(ä¸€æ•´ä¸ªæ•°å­—)</span><br>    <span class="hljs-keyword">for</span> num_div <span class="hljs-keyword">in</span> num_divs:<br>        <span class="hljs-comment"># è®°å½•è¿™ä¸ªæ•°å­—æœ‰å¤šå°‘ä½</span><br>        count = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># éå†æ¯ä¸€ä½æ•°å­—çš„æ¯ä¸€ä½</span><br>        <span class="hljs-keyword">for</span> single_bit_div <span class="hljs-keyword">in</span> num_div:<br>            <span class="hljs-comment"># è·å–æ ·å¼</span><br><br>            clazz = single_bit_div.attrib[<span class="hljs-string">&#x27;class&#x27;</span>]<br>            clazz = clazz[:clazz.index(<span class="hljs-string">&#x27; &#x27;</span>)]<br>            <span class="hljs-comment"># ä»styleæŸ¥è¯¢ offset-x offset-y width height</span><br>            offset_x = <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(re.search(clazz + <span class="hljs-string">&#x27; \\&#123; background-position-x:(-?\\d+)px&#x27;</span>, style).group(<span class="hljs-number">1</span>)))<br>            offset_y = <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(re.search(clazz + <span class="hljs-string">&#x27; \\&#123; background-position-y:(-?\\d+)px&#x27;</span>, style).group(<span class="hljs-number">1</span>)))<br>            width = <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(re.search(clazz + <span class="hljs-string">&#x27; \\&#123; width:(\\d+)px&#x27;</span>, style).group(<span class="hljs-number">1</span>)))<br>            height = <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">int</span>(re.search(clazz + <span class="hljs-string">&#x27; \\&#123; height:(\\d+)px&#x27;</span>, style).group(<span class="hljs-number">1</span>)))<br><br>            <span class="hljs-comment"># åˆ‡å‰² é›ªç¢§å›¾ä¸­è¿™ä¸ªåç§»å’Œå®½é«˜å¯¹åº”çš„å›¾ç‰‡ å°±æ˜¯å½“å‰æ•°å­—çš„å›¾</span><br>            single_bit_image = image.crop((offset_x, offset_y, offset_x + width, offset_y + height))<br><br>            <span class="hljs-comment"># resize</span><br>            single_bit_image = single_bit_image.resize((<span class="hljs-number">18</span>, <span class="hljs-number">18</span>), Image.ANTIALIAS)<br><br>            <span class="hljs-comment"># åŠ å…¥å•ä½æ•°å­—</span><br>            single_bit_images.append(single_bit_image)<br>            count += <span class="hljs-number">1</span><br><br>        <span class="hljs-comment"># è®°å½•ä¸‹è¿™ä¸ªæ•°å­—çš„ä½æ•°</span><br>        count_bit.append(count)<br><br>    <span class="hljs-keyword">return</span> single_bit_images, count_bit<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ ¹æ®æ¯ä¸€ä¸ªå°æ•°å­— å’Œ æ¯ä¸ªå¤§æ•°å­—å çš„ä½æ•° çš„åˆ°å¤§æ•°å­—é›†åˆ</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_num</span>(<span class="hljs-params">single_num_list, count_bit</span>):<br>    index = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># ç»“æœ</span><br>    num_list = []<br><br>    <span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> count_bit:<br>        num = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># æŒ‰ç…§ä½æ•° é¡ºåºæ‹¼æ¥æ¯ä¸€ä½ å¾ªç¯æ¬¡æ•°æ˜¯bitæ¬¡</span><br>        <span class="hljs-keyword">while</span> bit:<br>            num += single_num_list[index] * (<span class="hljs-number">10</span> ** (bit - <span class="hljs-number">1</span>))<br>            index += <span class="hljs-number">1</span><br>            bit -= <span class="hljs-number">1</span><br><br>        <span class="hljs-comment"># å¡«å…¥</span><br>        num_list.append(num)<br><br>    <span class="hljs-keyword">return</span> num_list<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è¯·æ±‚è¿”å›å½“å‰é¡µæ•°å­—é›†åˆ</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_num_list</span>(<span class="hljs-params">page_num, model</span>):<br>    url = <span class="hljs-string">f&#x27;http://www.glidedsky.com/level/web/crawler-sprite-image-2?page=<span class="hljs-subst">&#123;page_num&#125;</span>&#x27;</span><br><br>    response = session.get(url, headers=env.headers)<br><br>    <span class="hljs-comment"># ä¸€å¼  2ç»´é›ªç¢§å›¾</span><br>    sprite_image = get_sprite(response.text)<br>    <span class="hljs-comment"># åˆ†å‰²æˆçš„ 18*18 å°å›¾</span><br>    single_bit_images, count_bit = slice_image(sprite_image, response.text)<br><br>    <span class="hljs-comment"># æ¨æµ‹é›ªç¢§å›¾ä¸­çš„çœŸå®æ•°å­— å¾—åˆ°æ•°å­—åˆ—è¡¨</span><br>    num_list = predict(single_bit_images, model)<br><br>    <span class="hljs-comment"># æ ¹æ®åˆ—è¡¨å’Œæœ‰å‡ ä½æ•°å­—è·å¾—çœŸå®æ•°å­—é›†åˆ</span><br>    num_list = mix_num(num_list, count_bit)<br>    <span class="hljs-comment"># print(f&#x27;ç¬¬ &#123;page_num&#125; é¡µçš„æ¯ä¸ªæ•°å­—: &#x27;, num_list)</span><br><br>    <span class="hljs-keyword">return</span> num_list<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    åˆ¤æ–­é¢„æµ‹æ˜¯å¦ç²¾ç¡®</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_accurate</span>(<span class="hljs-params">predicts</span>):<br>    <span class="hljs-comment"># = =, æ¨¡å‹åˆ¤æ–­ç‡æŒºé«˜çš„äº†(éƒ½42wè®­ç»ƒé›†äº†), åŒä¸€é¡µè¯·æ±‚çš„å‰ä¸‰æ¬¡éƒ½ç›¸åŒç›´æ¥å°±è¿”å›äº†(å³åˆ¤å®šå‡†ç¡®ç»“æœéƒ½è¿˜æœ‰é”™) éš¾é“å­˜åœ¨è¿ç»­3æ¬¡éƒ½åˆ¤é”™çš„å¯èƒ½?</span><br>    <span class="hljs-comment"># if len(predicts) &lt; 3:</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(predicts) &lt; <span class="hljs-number">6</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    predicts_set = <span class="hljs-built_in">set</span>(predicts)<br>    <span class="hljs-comment"># çœ‹é¢„æµ‹ç»“æœå‡ºç°çš„é¢‘ç‡ è®¤å®šå‡ºç°é¢‘ç‡ &gt;= 2/3 é‚£ä¹ˆè¿™ä¸ªæ•°æ‰æ˜¯å‡†ç¡®çš„(å› ä¸ºæœ¬èº«æ¨¡å‹ç¡®è®¤ç‡è™½ç„¶æ¥è¿‘100% ä½†ä¸æ˜¯100%)</span><br>    <span class="hljs-comment"># ç»Ÿè®¡ &#123; æ•°å­—: å‡ºç°çš„æ¬¡æ•° &#125;</span><br>    statistics = &#123;num: predicts.count(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> predicts_set&#125;<br><br>    <span class="hljs-comment"># å€¼é€†åºæ’åˆ— è¿”å›åˆ—è¡¨ ä¸€å¯¹é”®å€¼æ··åˆä¸ºå…ƒç»„</span><br>    statistics = <span class="hljs-built_in">sorted</span>(statistics.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)<br>    <span class="hljs-comment"># å€¼æœ€å¤§çš„å…ƒç»„ çš„ç¬¬äºŒä¸ªå…ƒç´  æ‰æ˜¯ é¢‘æ•°, å…ƒç»„ç¬¬ä¸€ä¸ªæ˜¯æ•°å­—å’Œ</span><br>    <span class="hljs-comment"># ä¸ç”¨è¿™ä¸ªæ¡ä»¶äº† = =, å¤ªå¤šé¢„æµ‹é”™è¯¯çš„å°±ä¼šä¸€ç›´å¡åœ¨å½“å‰é¡µäº† æ°¸è¿œè¾¾ä¸åˆ°è¿™ä¸ªæ¯”ä¾‹</span><br>    <span class="hljs-comment"># if statistics[0][1] / len(predicts) &gt;= 3 / 4:</span><br><br>    <span class="hljs-comment"># é‡‡ç”¨ åªæœ‰é¢‘ç‡1å‡ºç° or é¢‘ç‡top1 / top2 &gt; n æˆ‘è§‰å¾—4å¤Ÿé«˜äº†å•Š</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(statistics) == <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> statistics[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] / statistics[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] &gt; <span class="hljs-number">4</span>:<br>        <span class="hljs-built_in">print</span>(statistics)<br>        <span class="hljs-keyword">return</span> statistics[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    total = <span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># æ¨¡å‹æ–‡ä»¶è·¯å¾„</span><br>    model_path = <span class="hljs-string">&#x27;./sprite-image-2-test/glided_sky_model/glided_sky_model.h5&#x27;</span><br>    <span class="hljs-comment"># åŠ è½½æ¨¡å‹(æ”¾åˆ°å‡½æ•°é‡ŒåŠ è½½æŠ¥WARNING, è§£å†³ä¸äº†: ARNING:tensorflow:6 out of the last 11 calls to &lt;function</span><br>    <span class="hljs-comment">#       Model.make_predict_function.)</span><br>    restored_model = keras.models.load_model(model_path)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):<br>        <span class="hljs-comment"># å½“å‰é¡µçš„é¢„æµ‹å€¼é›†åˆ</span><br>        predicts = []<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">100</span>)<br>        <span class="hljs-comment"># ç»“æœæ˜¯å¦å‡†ç¡®</span><br>        accurate = is_accurate(predicts)<br>        count = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> accurate:<br>            count += <span class="hljs-number">1</span><br>            <span class="hljs-comment"># ä¸ç²¾ç¡® å°±é‡æ–°è¯·æ±‚</span><br>            num_list = get_num_list(i, restored_model)<br>            predicts.append(<span class="hljs-built_in">sum</span>(num_list))<br>            accurate = is_accurate(predicts)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ç»è¿‡ <span class="hljs-subst">&#123;count&#125;</span> è½®è®¡ç®—, ç»“æœæ‰ç²¾ç¡®!!!&#x27;</span>)<br>        <span class="hljs-comment"># åˆ¤æ–­æ•°å€¼æ˜¯å¦ç²¾ç¡® è¿™é‡Œaccurateæ˜¯int64çš„, æºäºç”¨æ¨¡å‹é¢„æµ‹æ—¶ np.argmax() ç»“æœæ˜¯ int64</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ç¬¬ <span class="hljs-subst">&#123;i&#125;</span> é¡µæ•°æ®ä¸º: <span class="hljs-subst">&#123;num_list&#125;</span>, æ±‚å’Œæ˜¯ <span class="hljs-subst">&#123;accurate&#125;</span>&#x27;</span>)<br><br>        total += accurate<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å‰ <span class="hljs-subst">&#123;i&#125;</span> é¡µ, æ•°å­—å’Œä¸º <span class="hljs-subst">&#123;total&#125;</span>&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">100</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    page1 [337, 379, 263, 144, 131, 285, 381, 364, 291, 171, 110, 94]</span><br><span class="hljs-string">    page1 + page2 + page3 = 2956 + 2907 + 2844 = 8707</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    é”™è¯¯ç­”æ¡ˆ1: 2725233</span><br><span class="hljs-string">    é”™è¯¯ç­”æ¡ˆ2: 2724715</span><br><span class="hljs-string">    è¿˜çœŸæ˜¯å‡ºé”™å‡ºåœ¨è¿ç»­ä¸‰æ¬¡éƒ½åˆ¤å®šä¸ºé”™è¯¯ç­”æ¡ˆ!!! ä¿®æ”¹ä¸º6æ¬¡ä»¥ä¸Šæ‰åˆ¤å®šå°±å¥½äº†(å¤šåˆ¤å®šå‡ ç»„æ•°æ®) (æ­£ç¡®ç­”æ¡ˆ: 27247^_^)</span><br><span class="hljs-string">    ä¹‹å‰è¿˜æ€€ç–‘è®­ç»ƒ42wç»„æ•°æ®éƒ½èƒ½å‡ºé”™ (*ï¿£â–½ï¿£*)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çˆ¬è™« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> çˆ¬è™« </tag>
            
            <tag> glidedsky </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
